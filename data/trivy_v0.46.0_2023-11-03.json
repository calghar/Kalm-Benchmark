{"SchemaVersion": 2, "ArtifactName": "manifests", "ArtifactType": "filesystem", "Metadata": {"ImageConfig": {"architecture": "", "created": "0001-01-01T00:00:00Z", "os": "", "rootfs": {"type": "", "diff_ids": null}, "config": {}}}, "Results": [{"Target": "_default-priority-c8fbe908.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 1, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "priorityclass default-priority in default namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "_kalm-benchmark-c882ce07.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 4, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "limitrange kalm-benchmark in default namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 20, "EndLine": 20, "Code": {"Lines": [{"Number": 20, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "namespace kalm-benchmark in default namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "networkpolicy kalm-benchmark in default namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 42, "EndLine": 42, "Code": {"Lines": [{"Number": 42, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "resourcequota kalm-benchmark in default namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 8, "EndLine": 8, "Code": {"Lines": [{"Number": 8, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}]}, {"Target": "_kalm-benchmark-unrestricted-ns-c849031e.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 2, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "namespace kalm-benchmark-unrestricted-ns in default namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "networkpolicy kalm-benchmark-unrestricted-ns in default namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 8, "EndLine": 8, "Code": {"Lines": [{"Number": 8, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}]}, {"Target": "cm-001-sensitive-key-referenced-in-configmap.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 149, "Failures": 3, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "AVD-KSV-01010", "AVDID": "AVD-KSV-01010", "Title": "ConfigMap with sensitive content", "Description": "Storing sensitive content such as usernames and email addresses in configMaps is unsafe", "Message": "ConfigMap 'cm-001-sensitive-key-referenced-in-configmap' in 'kalm-benchmark' namespace stores sensitive contents in key(s) or value(s) '{\"aws_access_key_id\", \"aws_secret_access_key\", \"azure_batch_key\", \"azure_batchai_storage_key\", \"key\"}'", "Namespace": "builtin.kubernetes.KSV01010", "Query": "data.builtin.kubernetes.KSV01010.deny", "Resolution": "Remove sensitive content from configMap data value", "Severity": "MEDIUM", "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-ksv-01010", "References": ["https://avd.aquasec.com/misconfig/avd-ksv-01010"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}, {"Type": "Kubernetes Security Check", "ID": "AVD-KSV-0109", "AVDID": "AVD-KSV-0109", "Title": "ConfigMap with secrets", "Description": "Storing secrets in configMaps is unsafe", "Message": "ConfigMap 'cm-001-sensitive-key-referenced-in-configmap' in 'kalm-benchmark' namespace stores secrets in key(s) or value(s) '{\"aws_access_key_id\", \"aws_secret_access_key\", \"password\", \"pwd\", \"secret\", \"token\"}'", "Namespace": "builtin.kubernetes.KSV0109", "Query": "data.builtin.kubernetes.KSV0109.deny", "Resolution": "Remove password/secret from configMap data value", "Severity": "HIGH", "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-ksv-0109", "References": ["https://avd.aquasec.com/misconfig/avd-ksv-0109"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "configmap cm-001-sensitive-key-referenced-in-configmap in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "np-001-namespace-without-network-policy.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 5, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "deployment np-001-namespace-without-network-policy in np-001-namespace-without-network-policy namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 67, "EndLine": 67, "Code": {"Lines": [{"Number": 67, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "limitrange np-001-namespace-without-network-policy in np-001-namespace-without-network-policy namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 30, "EndLine": 30, "Code": {"Lines": [{"Number": 30, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "namespace np-001-namespace-without-network-policy in np-001-namespace-without-network-policy namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "resourcequota np-001-namespace-without-network-policy in np-001-namespace-without-network-policy namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 13, "EndLine": 13, "Code": {"Lines": [{"Number": 13, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "serviceaccount np-001-namespace-without-network-policy-filler-dedicated-sa in np-001-namespace-without-network-policy namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 57, "EndLine": 57, "Code": {"Lines": [{"Number": 57, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}]}, {"Target": "np-002-1-only-ingress-is-blocked.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 6, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "deployment np-002-1-only-ingress-is-blocked in np-002-1-only-ingress-is-blocked namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 84, "EndLine": 84, "Code": {"Lines": [{"Number": 84, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "limitrange np-002-1-only-ingress-is-blocked in np-002-1-only-ingress-is-blocked namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 30, "EndLine": 30, "Code": {"Lines": [{"Number": 30, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "namespace np-002-1-only-ingress-is-blocked in np-002-1-only-ingress-is-blocked namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "networkpolicy np-002-1-only-ingress-is-blocked in np-002-1-only-ingress-is-blocked namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 57, "EndLine": 57, "Code": {"Lines": [{"Number": 57, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "resourcequota np-002-1-only-ingress-is-blocked in np-002-1-only-ingress-is-blocked namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 13, "EndLine": 13, "Code": {"Lines": [{"Number": 13, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "serviceaccount np-002-1-only-ingress-is-blocked-filler-dedicated-sa in np-002-1-only-ingress-is-blocked namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 74, "EndLine": 74, "Code": {"Lines": [{"Number": 74, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}]}, {"Target": "np-002-2-only-egress-is-blocked.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 6, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "deployment np-002-2-only-egress-is-blocked in np-002-2-only-egress-is-blocked namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 84, "EndLine": 84, "Code": {"Lines": [{"Number": 84, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "limitrange np-002-2-only-egress-is-blocked in np-002-2-only-egress-is-blocked namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 30, "EndLine": 30, "Code": {"Lines": [{"Number": 30, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "namespace np-002-2-only-egress-is-blocked in np-002-2-only-egress-is-blocked namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "networkpolicy np-002-2-only-egress-is-blocked in np-002-2-only-egress-is-blocked namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 57, "EndLine": 57, "Code": {"Lines": [{"Number": 57, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "resourcequota np-002-2-only-egress-is-blocked in np-002-2-only-egress-is-blocked namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 13, "EndLine": 13, "Code": {"Lines": [{"Number": 13, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "serviceaccount np-002-2-only-egress-is-blocked-filler-dedicated-sa in np-002-2-only-egress-is-blocked namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 74, "EndLine": 74, "Code": {"Lines": [{"Number": 74, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}]}, {"Target": "np-003-network-policy-allows-access-to-cloud-metadata-api.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 7, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "deployment np-003-network-policy-allows-access-to-cloud-metadata-api in np-003-network-policy-allows-access-to-cloud-metadata-api namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 101, "EndLine": 101, "Code": {"Lines": [{"Number": 101, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "limitrange np-003-network-policy-allows-access-to-cloud-metadata-api in np-003-network-policy-allows-access-to-cloud-metadata-api namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 30, "EndLine": 30, "Code": {"Lines": [{"Number": 30, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "namespace np-003-network-policy-allows-access-to-cloud-metadata-api in np-003-network-policy-allows-access-to-cloud-metadata-api namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "networkpolicy np-003-network-policy-allows-access-to-cloud-metadata-api in np-003-network-policy-allows-access-to-cloud-metadata-api namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 57, "EndLine": 57, "Code": {"Lines": [{"Number": 57, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "networkpolicy np-003-network-policy-allows-access-to-cloud-metadata-api in np-003-network-policy-allows-access-to-cloud-metadata-api namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 74, "EndLine": 74, "Code": {"Lines": [{"Number": 74, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "resourcequota np-003-network-policy-allows-access-to-cloud-metadata-api in np-003-network-policy-allows-access-to-cloud-metadata-api namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 13, "EndLine": 13, "Code": {"Lines": [{"Number": 13, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "serviceaccount np-003-network-policy-allows-access-to-cloud-metadata-api-filler-dedicated-sa in np-003-network-policy-allows-access-to-cloud-metadata-api namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 91, "EndLine": 91, "Code": {"Lines": [{"Number": 91, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}]}, {"Target": "np-004-network-policy-allows-access-to-kubelet.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 7, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "deployment np-004-network-policy-allows-access-to-kubelet in np-004-network-policy-allows-access-to-kubelet namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 101, "EndLine": 101, "Code": {"Lines": [{"Number": 101, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "limitrange np-004-network-policy-allows-access-to-kubelet in np-004-network-policy-allows-access-to-kubelet namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 30, "EndLine": 30, "Code": {"Lines": [{"Number": 30, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "namespace np-004-network-policy-allows-access-to-kubelet in np-004-network-policy-allows-access-to-kubelet namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "networkpolicy np-004-network-policy-allows-access-to-kubelet in np-004-network-policy-allows-access-to-kubelet namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 57, "EndLine": 57, "Code": {"Lines": [{"Number": 57, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "networkpolicy np-004-network-policy-allows-access-to-kubelet in np-004-network-policy-allows-access-to-kubelet namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 74, "EndLine": 74, "Code": {"Lines": [{"Number": 74, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "resourcequota np-004-network-policy-allows-access-to-kubelet in np-004-network-policy-allows-access-to-kubelet namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 13, "EndLine": 13, "Code": {"Lines": [{"Number": 13, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "serviceaccount np-004-network-policy-allows-access-to-kubelet-filler-dedicated-sa in np-004-network-policy-allows-access-to-kubelet namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 91, "EndLine": 91, "Code": {"Lines": [{"Number": 91, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}]}, {"Target": "np-005-network-policy-refers-no-valid-workload.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 6, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "deployment np-005-network-policy-refers-no-valid-workload in np-005-network-policy-refers-no-valid-workload namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 84, "EndLine": 84, "Code": {"Lines": [{"Number": 84, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "limitrange np-005-network-policy-refers-no-valid-workload in np-005-network-policy-refers-no-valid-workload namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 30, "EndLine": 30, "Code": {"Lines": [{"Number": 30, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "namespace np-005-network-policy-refers-no-valid-workload in np-005-network-policy-refers-no-valid-workload namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "networkpolicy np-005-network-policy-refers-no-valid-workload in np-005-network-policy-refers-no-valid-workload namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 57, "EndLine": 57, "Code": {"Lines": [{"Number": 57, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "resourcequota np-005-network-policy-refers-no-valid-workload in np-005-network-policy-refers-no-valid-workload namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 13, "EndLine": 13, "Code": {"Lines": [{"Number": 13, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "serviceaccount np-005-network-policy-refers-no-valid-workload-filler-dedicated-sa in np-005-network-policy-refers-no-valid-workload namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 74, "EndLine": 74, "Code": {"Lines": [{"Number": 74, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}]}, {"Target": "ns-001-use-default-namespace.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 2, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "deployment ns-001-use-default-namespace in default namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 10, "EndLine": 10, "Code": {"Lines": [{"Number": 10, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "serviceaccount ns-001-use-default-namespace-dedicated-sa in default namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "ns-002-1-place-pod-in-kube-system.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 2, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "deployment ns-002-1-place-pod-in-kube-system in kube-system namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 10, "EndLine": 10, "Code": {"Lines": [{"Number": 10, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "serviceaccount ns-002-1-place-pod-in-kube-system-dedicated-sa in kube-system namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "ns-002-2-place-pod-in-kube-public.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 2, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "deployment ns-002-2-place-pod-in-kube-public in kube-public namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 10, "EndLine": 10, "Code": {"Lines": [{"Number": 10, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "serviceaccount ns-002-2-place-pod-in-kube-public-dedicated-sa in kube-public namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "pod-002-1-explicit-default-sa.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 1, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "deployment pod-002-1-explicit-default-sa in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "pod-002-2-no-sa-specified.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 1, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "deployment pod-002-2-no-sa-specified in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "pod-003-1-default-pod-and-sa.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 2, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "deployment pod-003-1-default-pod-and-sa in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 9, "EndLine": 9, "Code": {"Lines": [{"Number": 9, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "serviceaccount pod-003-1-default-pod-and-sa-dedicated-sa in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "pod-003-2-default-pod-automount-sa.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 2, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "deployment pod-003-2-default-pod-automount-sa in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 10, "EndLine": 10, "Code": {"Lines": [{"Number": 10, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "serviceaccount pod-003-2-default-pod-automount-sa-dedicated-sa in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "pod-003-3-default-pod-no-automount-sa.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 2, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "deployment pod-003-3-default-pod-no-automount-sa in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 10, "EndLine": 10, "Code": {"Lines": [{"Number": 10, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "serviceaccount pod-003-3-default-pod-no-automount-sa-dedicated-sa in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "pod-003-4-automount-pod-default-sa.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 2, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "deployment pod-003-4-automount-pod-default-sa in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 9, "EndLine": 9, "Code": {"Lines": [{"Number": 9, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "serviceaccount pod-003-4-automount-pod-default-sa-dedicated-sa in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "pod-003-5-automount-pod-and-sa.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 2, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "deployment pod-003-5-automount-pod-and-sa in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 10, "EndLine": 10, "Code": {"Lines": [{"Number": 10, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "serviceaccount pod-003-5-automount-pod-and-sa-dedicated-sa in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "pod-003-6-automount-pod-no-automount-sa.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 2, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "deployment pod-003-6-automount-pod-no-automount-sa in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 10, "EndLine": 10, "Code": {"Lines": [{"Number": 10, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "serviceaccount pod-003-6-automount-pod-no-automount-sa-dedicated-sa in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "pod-003-7-no-automount-pod-default-sa.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 2, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "deployment pod-003-7-no-automount-pod-default-sa in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 9, "EndLine": 9, "Code": {"Lines": [{"Number": 9, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "serviceaccount pod-003-7-no-automount-pod-default-sa-dedicated-sa in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "pod-003-8-no-automount-pod-automount-sa.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 2, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "deployment pod-003-8-no-automount-pod-automount-sa in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 10, "EndLine": 10, "Code": {"Lines": [{"Number": 10, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "serviceaccount pod-003-8-no-automount-pod-automount-sa-dedicated-sa in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "pod-003-9-no-automount-pod-and-sa.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 2, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "deployment pod-003-9-no-automount-pod-and-sa in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 10, "EndLine": 10, "Code": {"Lines": [{"Number": 10, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "serviceaccount pod-003-9-no-automount-pod-and-sa-dedicated-sa in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "pod-008-1-use-no-hostpid.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 2, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "deployment pod-008-1-use-no-hostpid in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 10, "EndLine": 10, "Code": {"Lines": [{"Number": 10, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "serviceaccount pod-008-1-use-no-hostpid-dedicated-sa in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "pod-008-2-pod-has-hostpid-set.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 3, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV010", "AVDID": "AVD-KSV-0010", "Title": "Access to host PID", "Description": "Sharing the host\u2019s PID namespace allows visibility on host processes, potentially leaking information such as environment variables and configuration.", "Message": "Deployment 'pod-008-2-pod-has-hostpid-set' should not set 'spec.template.spec.hostPID' to true", "Namespace": "builtin.kubernetes.KSV010", "Query": "data.builtin.kubernetes.KSV010.deny", "Resolution": "Do not set 'spec.template.spec.hostPID' to true.", "Severity": "HIGH", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv010", "References": ["https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline", "https://avd.aquasec.com/misconfig/ksv010"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 24, "EndLine": 99, "Code": {"Lines": [{"Number": 24, "Content": "  replicas: 1", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 25, "Content": "  selector:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 26, "Content": "    matchLabels:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 27, "Content": "      app.kubernetes.io/part-of: kalm-benchmark", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 28, "Content": "      check: POD-008-2", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 29, "Content": "  template:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 30, "Content": "    metadata:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 31, "Content": "      annotations:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 32, "Content": "        container.apparmor.security.beta.kubernetes.io/app: runtime/default", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 33, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "deployment pod-008-2-pod-has-hostpid-set in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 10, "EndLine": 10, "Code": {"Lines": [{"Number": 10, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "serviceaccount pod-008-2-pod-has-hostpid-set-dedicated-sa in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "pod-009-1-use-no-hostipc.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 2, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "deployment pod-009-1-use-no-hostipc in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 10, "EndLine": 10, "Code": {"Lines": [{"Number": 10, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "serviceaccount pod-009-1-use-no-hostipc-dedicated-sa in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "pod-009-2-has-hostipc-set.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 3, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV008", "AVDID": "AVD-KSV-0008", "Title": "Access to host IPC namespace", "Description": "Sharing the host\u2019s IPC namespace allows container processes to communicate with processes on the host.", "Message": "Deployment 'pod-009-2-has-hostipc-set' should not set 'spec.template.spec.hostIPC' to true", "Namespace": "builtin.kubernetes.KSV008", "Query": "data.builtin.kubernetes.KSV008.deny", "Resolution": "Do not set 'spec.template.spec.hostIPC' to true.", "Severity": "HIGH", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv008", "References": ["https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline", "https://avd.aquasec.com/misconfig/ksv008"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 24, "EndLine": 99, "Code": {"Lines": [{"Number": 24, "Content": "  replicas: 1", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 25, "Content": "  selector:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 26, "Content": "    matchLabels:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 27, "Content": "      app.kubernetes.io/part-of: kalm-benchmark", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 28, "Content": "      check: POD-009-2", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 29, "Content": "  template:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 30, "Content": "    metadata:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 31, "Content": "      annotations:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 32, "Content": "        container.apparmor.security.beta.kubernetes.io/app: runtime/default", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 33, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "deployment pod-009-2-has-hostipc-set in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 10, "EndLine": 10, "Code": {"Lines": [{"Number": 10, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "serviceaccount pod-009-2-has-hostipc-set-dedicated-sa in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "pod-010-1-use-no-hostnetwork.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 2, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "deployment pod-010-1-use-no-hostnetwork in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 10, "EndLine": 10, "Code": {"Lines": [{"Number": 10, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "serviceaccount pod-010-1-use-no-hostnetwork-dedicated-sa in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "pod-010-2-has-hostnetwork-set.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 3, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV009", "AVDID": "AVD-KSV-0009", "Title": "Access to host network", "Description": "Sharing the host\u2019s network namespace permits processes in the pod to communicate with processes bound to the host\u2019s loopback adapter.", "Message": "Deployment 'pod-010-2-has-hostnetwork-set' should not set 'spec.template.spec.hostNetwork' to true", "Namespace": "builtin.kubernetes.KSV009", "Query": "data.builtin.kubernetes.KSV009.deny", "Resolution": "Do not set 'spec.template.spec.hostNetwork' to true.", "Severity": "HIGH", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv009", "References": ["https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline", "https://avd.aquasec.com/misconfig/ksv009"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 24, "EndLine": 99, "Code": {"Lines": [{"Number": 24, "Content": "  replicas: 1", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 25, "Content": "  selector:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 26, "Content": "    matchLabels:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 27, "Content": "      app.kubernetes.io/part-of: kalm-benchmark", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 28, "Content": "      check: POD-010-2", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 29, "Content": "  template:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 30, "Content": "    metadata:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 31, "Content": "      annotations:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 32, "Content": "        container.apparmor.security.beta.kubernetes.io/app: runtime/default", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 33, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "deployment pod-010-2-has-hostnetwork-set in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 10, "EndLine": 10, "Code": {"Lines": [{"Number": 10, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "serviceaccount pod-010-2-has-hostnetwork-set-dedicated-sa in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "pod-011-uses-hostport.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 3, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV024", "AVDID": "AVD-KSV-0024", "Title": "Access to host ports", "Description": "According to pod security standard 'Host Ports', hostPorts should be disallowed, or at minimum restricted to a known list.", "Message": "Container 'app' of Deployment 'pod-011-uses-hostport' should not set host ports, 'ports[*].hostPort'", "Namespace": "builtin.kubernetes.KSV024", "Query": "data.builtin.kubernetes.KSV024.deny", "Resolution": "Do not set spec.containers[*].ports[*].hostPort and spec.initContainers[*].ports[*].hostPort.", "Severity": "HIGH", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv024", "References": ["https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline", "https://avd.aquasec.com/misconfig/ksv024"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 49, "EndLine": 85, "Code": {"Lines": [{"Number": 49, "Content": "        - image: nginx@sha256:aed492c4dc93d2d1f6fe9a49f00bc7e1863d950334a93facd8ca1317292bf6aa", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 50, "Content": "          imagePullPolicy: Always", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 51, "Content": "          livenessProbe:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 52, "Content": "            httpGet:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 53, "Content": "              path: /live", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 54, "Content": "              port: 8080", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 55, "Content": "          name: app", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 56, "Content": "          ports:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 57, "Content": "            - containerPort: 31337", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 58, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "deployment pod-011-uses-hostport in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 10, "EndLine": 10, "Code": {"Lines": [{"Number": 10, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "serviceaccount pod-011-uses-hostport-dedicated-sa in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "pod-012-use-hostaliases-to-modify-pods--etc-hosts.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 2, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "deployment pod-012-use-hostaliases-to-modify-pods--etc-hosts in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 10, "EndLine": 10, "Code": {"Lines": [{"Number": 10, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "serviceaccount pod-012-use-hostaliases-to-modify-pods--etc-hosts-dedicated-sa in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "pod-013-use-serviceaccount-field.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 2, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "deployment pod-013-use-serviceaccount-field in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 10, "EndLine": 10, "Code": {"Lines": [{"Number": 10, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "serviceaccount deprecated-sa in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "pod-014-no-apparmor-profile.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 2, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "deployment pod-014-no-apparmor-profile in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 10, "EndLine": 10, "Code": {"Lines": [{"Number": 10, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "serviceaccount pod-014-no-apparmor-profile-dedicated-sa in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "pod-016-no-podsecuritycontext-defined.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 2, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "deployment pod-016-no-podsecuritycontext-defined in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 10, "EndLine": 10, "Code": {"Lines": [{"Number": 10, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "serviceaccount pod-016-no-podsecuritycontext-defined-dedicated-sa in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "pod-017-1-default-to-root-user.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 4, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV012", "AVDID": "AVD-KSV-0012", "Title": "Runs as root user", "Description": "Force the running image to run as a non-root user to ensure least privileges.", "Message": "Container 'app' of Deployment 'pod-017-1-default-to-root-user' should set 'securityContext.runAsNonRoot' to true", "Namespace": "builtin.kubernetes.KSV012", "Query": "data.builtin.kubernetes.KSV012.deny", "Resolution": "Set 'containers[].securityContext.runAsNonRoot' to true.", "Severity": "MEDIUM", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv012", "References": ["https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted", "https://avd.aquasec.com/misconfig/ksv012"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 49, "EndLine": 82, "Code": {"Lines": [{"Number": 49, "Content": "        - image: nginx@sha256:aed492c4dc93d2d1f6fe9a49f00bc7e1863d950334a93facd8ca1317292bf6aa", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 50, "Content": "          imagePullPolicy: Always", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 51, "Content": "          livenessProbe:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 52, "Content": "            httpGet:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 53, "Content": "              path: /live", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 54, "Content": "              port: 8080", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 55, "Content": "          name: app", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 56, "Content": "          ports:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 57, "Content": "            - containerPort: 8080", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 58, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV020", "AVDID": "AVD-KSV-0020", "Title": "Runs with UID <= 10000", "Description": "Force the container to run with user ID > 10000 to avoid conflicts with the host\u2019s user table.", "Message": "Container 'app' of Deployment 'pod-017-1-default-to-root-user' should set 'securityContext.runAsUser' > 10000", "Namespace": "builtin.kubernetes.KSV020", "Query": "data.builtin.kubernetes.KSV020.deny", "Resolution": "Set 'containers[].securityContext.runAsUser' to an integer > 10000.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv020", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv020"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 49, "EndLine": 82, "Code": {"Lines": [{"Number": 49, "Content": "        - image: nginx@sha256:aed492c4dc93d2d1f6fe9a49f00bc7e1863d950334a93facd8ca1317292bf6aa", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 50, "Content": "          imagePullPolicy: Always", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 51, "Content": "          livenessProbe:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 52, "Content": "            httpGet:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 53, "Content": "              path: /live", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 54, "Content": "              port: 8080", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 55, "Content": "          name: app", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 56, "Content": "          ports:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 57, "Content": "            - containerPort: 8080", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 58, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "deployment pod-017-1-default-to-root-user in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 10, "EndLine": 10, "Code": {"Lines": [{"Number": 10, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "serviceaccount pod-017-1-default-to-root-user-dedicated-sa in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "pod-017-2-use-runasnonroot-flag-on-pod.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 3, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV020", "AVDID": "AVD-KSV-0020", "Title": "Runs with UID <= 10000", "Description": "Force the container to run with user ID > 10000 to avoid conflicts with the host\u2019s user table.", "Message": "Container 'app' of Deployment 'pod-017-2-use-runasnonroot-flag-on-pod' should set 'securityContext.runAsUser' > 10000", "Namespace": "builtin.kubernetes.KSV020", "Query": "data.builtin.kubernetes.KSV020.deny", "Resolution": "Set 'containers[].securityContext.runAsUser' to an integer > 10000.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv020", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv020"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 49, "EndLine": 82, "Code": {"Lines": [{"Number": 49, "Content": "        - image: nginx@sha256:aed492c4dc93d2d1f6fe9a49f00bc7e1863d950334a93facd8ca1317292bf6aa", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 50, "Content": "          imagePullPolicy: Always", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 51, "Content": "          livenessProbe:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 52, "Content": "            httpGet:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 53, "Content": "              path: /live", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 54, "Content": "              port: 8080", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 55, "Content": "          name: app", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 56, "Content": "          ports:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 57, "Content": "            - containerPort: 8080", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 58, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "deployment pod-017-2-use-runasnonroot-flag-on-pod in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 10, "EndLine": 10, "Code": {"Lines": [{"Number": 10, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "serviceaccount pod-017-2-use-runasnonroot-flag-on-pod-dedicated-sa in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "pod-017-3-runasnonroot-is-optional.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 4, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV012", "AVDID": "AVD-KSV-0012", "Title": "Runs as root user", "Description": "Force the running image to run as a non-root user to ensure least privileges.", "Message": "Container 'app' of Deployment 'pod-017-3-runasnonroot-is-optional' should set 'securityContext.runAsNonRoot' to true", "Namespace": "builtin.kubernetes.KSV012", "Query": "data.builtin.kubernetes.KSV012.deny", "Resolution": "Set 'containers[].securityContext.runAsNonRoot' to true.", "Severity": "MEDIUM", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv012", "References": ["https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted", "https://avd.aquasec.com/misconfig/ksv012"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 49, "EndLine": 82, "Code": {"Lines": [{"Number": 49, "Content": "        - image: nginx@sha256:aed492c4dc93d2d1f6fe9a49f00bc7e1863d950334a93facd8ca1317292bf6aa", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 50, "Content": "          imagePullPolicy: Always", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 51, "Content": "          livenessProbe:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 52, "Content": "            httpGet:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 53, "Content": "              path: /live", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 54, "Content": "              port: 8080", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 55, "Content": "          name: app", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 56, "Content": "          ports:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 57, "Content": "            - containerPort: 8080", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 58, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV020", "AVDID": "AVD-KSV-0020", "Title": "Runs with UID <= 10000", "Description": "Force the container to run with user ID > 10000 to avoid conflicts with the host\u2019s user table.", "Message": "Container 'app' of Deployment 'pod-017-3-runasnonroot-is-optional' should set 'securityContext.runAsUser' > 10000", "Namespace": "builtin.kubernetes.KSV020", "Query": "data.builtin.kubernetes.KSV020.deny", "Resolution": "Set 'containers[].securityContext.runAsUser' to an integer > 10000.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv020", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv020"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 49, "EndLine": 82, "Code": {"Lines": [{"Number": 49, "Content": "        - image: nginx@sha256:aed492c4dc93d2d1f6fe9a49f00bc7e1863d950334a93facd8ca1317292bf6aa", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 50, "Content": "          imagePullPolicy: Always", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 51, "Content": "          livenessProbe:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 52, "Content": "            httpGet:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 53, "Content": "              path: /live", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 54, "Content": "              port: 8080", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 55, "Content": "          name: app", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 56, "Content": "          ports:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 57, "Content": "            - containerPort: 8080", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 58, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "deployment pod-017-3-runasnonroot-is-optional in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 10, "EndLine": 10, "Code": {"Lines": [{"Number": 10, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "serviceaccount pod-017-3-runasnonroot-is-optional-dedicated-sa in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "pod-017-4-use-root-user-in-pod.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 4, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV012", "AVDID": "AVD-KSV-0012", "Title": "Runs as root user", "Description": "Force the running image to run as a non-root user to ensure least privileges.", "Message": "Container 'app' of Deployment 'pod-017-4-use-root-user-in-pod' should set 'securityContext.runAsNonRoot' to true", "Namespace": "builtin.kubernetes.KSV012", "Query": "data.builtin.kubernetes.KSV012.deny", "Resolution": "Set 'containers[].securityContext.runAsNonRoot' to true.", "Severity": "MEDIUM", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv012", "References": ["https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted", "https://avd.aquasec.com/misconfig/ksv012"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 49, "EndLine": 82, "Code": {"Lines": [{"Number": 49, "Content": "        - image: nginx@sha256:aed492c4dc93d2d1f6fe9a49f00bc7e1863d950334a93facd8ca1317292bf6aa", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 50, "Content": "          imagePullPolicy: Always", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 51, "Content": "          livenessProbe:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 52, "Content": "            httpGet:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 53, "Content": "              path: /live", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 54, "Content": "              port: 8080", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 55, "Content": "          name: app", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 56, "Content": "          ports:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 57, "Content": "            - containerPort: 8080", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 58, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV020", "AVDID": "AVD-KSV-0020", "Title": "Runs with UID <= 10000", "Description": "Force the container to run with user ID > 10000 to avoid conflicts with the host\u2019s user table.", "Message": "Container 'app' of Deployment 'pod-017-4-use-root-user-in-pod' should set 'securityContext.runAsUser' > 10000", "Namespace": "builtin.kubernetes.KSV020", "Query": "data.builtin.kubernetes.KSV020.deny", "Resolution": "Set 'containers[].securityContext.runAsUser' to an integer > 10000.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv020", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv020"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 49, "EndLine": 82, "Code": {"Lines": [{"Number": 49, "Content": "        - image: nginx@sha256:aed492c4dc93d2d1f6fe9a49f00bc7e1863d950334a93facd8ca1317292bf6aa", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 50, "Content": "          imagePullPolicy: Always", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 51, "Content": "          livenessProbe:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 52, "Content": "            httpGet:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 53, "Content": "              path: /live", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 54, "Content": "              port: 8080", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 55, "Content": "          name: app", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 56, "Content": "          ports:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 57, "Content": "            - containerPort: 8080", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 58, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "deployment pod-017-4-use-root-user-in-pod in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 10, "EndLine": 10, "Code": {"Lines": [{"Number": 10, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "serviceaccount pod-017-4-use-root-user-in-pod-dedicated-sa in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "pod-017-5-use-runasnonroot-flag-on-container.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 3, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV020", "AVDID": "AVD-KSV-0020", "Title": "Runs with UID <= 10000", "Description": "Force the container to run with user ID > 10000 to avoid conflicts with the host\u2019s user table.", "Message": "Container 'app' of Deployment 'pod-017-5-use-runasnonroot-flag-on-container' should set 'securityContext.runAsUser' > 10000", "Namespace": "builtin.kubernetes.KSV020", "Query": "data.builtin.kubernetes.KSV020.deny", "Resolution": "Set 'containers[].securityContext.runAsUser' to an integer > 10000.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv020", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv020"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 49, "EndLine": 83, "Code": {"Lines": [{"Number": 49, "Content": "        - image: nginx@sha256:aed492c4dc93d2d1f6fe9a49f00bc7e1863d950334a93facd8ca1317292bf6aa", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 50, "Content": "          imagePullPolicy: Always", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 51, "Content": "          livenessProbe:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 52, "Content": "            httpGet:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 53, "Content": "              path: /live", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 54, "Content": "              port: 8080", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 55, "Content": "          name: app", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 56, "Content": "          ports:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 57, "Content": "            - containerPort: 8080", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 58, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "deployment pod-017-5-use-runasnonroot-flag-on-container in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 10, "EndLine": 10, "Code": {"Lines": [{"Number": 10, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "serviceaccount pod-017-5-use-runasnonroot-flag-on-container-dedicated-sa in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "pod-017-6-runasnonroot-is-optional-on-container.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 4, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV012", "AVDID": "AVD-KSV-0012", "Title": "Runs as root user", "Description": "Force the running image to run as a non-root user to ensure least privileges.", "Message": "Container 'app' of Deployment 'pod-017-6-runasnonroot-is-optional-on-container' should set 'securityContext.runAsNonRoot' to true", "Namespace": "builtin.kubernetes.KSV012", "Query": "data.builtin.kubernetes.KSV012.deny", "Resolution": "Set 'containers[].securityContext.runAsNonRoot' to true.", "Severity": "MEDIUM", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv012", "References": ["https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted", "https://avd.aquasec.com/misconfig/ksv012"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 49, "EndLine": 83, "Code": {"Lines": [{"Number": 49, "Content": "        - image: nginx@sha256:aed492c4dc93d2d1f6fe9a49f00bc7e1863d950334a93facd8ca1317292bf6aa", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 50, "Content": "          imagePullPolicy: Always", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 51, "Content": "          livenessProbe:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 52, "Content": "            httpGet:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 53, "Content": "              path: /live", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 54, "Content": "              port: 8080", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 55, "Content": "          name: app", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 56, "Content": "          ports:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 57, "Content": "            - containerPort: 8080", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 58, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV020", "AVDID": "AVD-KSV-0020", "Title": "Runs with UID <= 10000", "Description": "Force the container to run with user ID > 10000 to avoid conflicts with the host\u2019s user table.", "Message": "Container 'app' of Deployment 'pod-017-6-runasnonroot-is-optional-on-container' should set 'securityContext.runAsUser' > 10000", "Namespace": "builtin.kubernetes.KSV020", "Query": "data.builtin.kubernetes.KSV020.deny", "Resolution": "Set 'containers[].securityContext.runAsUser' to an integer > 10000.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv020", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv020"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 49, "EndLine": 83, "Code": {"Lines": [{"Number": 49, "Content": "        - image: nginx@sha256:aed492c4dc93d2d1f6fe9a49f00bc7e1863d950334a93facd8ca1317292bf6aa", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 50, "Content": "          imagePullPolicy: Always", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 51, "Content": "          livenessProbe:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 52, "Content": "            httpGet:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 53, "Content": "              path: /live", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 54, "Content": "              port: 8080", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 55, "Content": "          name: app", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 56, "Content": "          ports:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 57, "Content": "            - containerPort: 8080", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 58, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "deployment pod-017-6-runasnonroot-is-optional-on-container in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 10, "EndLine": 10, "Code": {"Lines": [{"Number": 10, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "serviceaccount pod-017-6-runasnonroot-is-optional-on-container-dedicated-sa in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "pod-017-7-use-root-user-on-container.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 4, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV012", "AVDID": "AVD-KSV-0012", "Title": "Runs as root user", "Description": "Force the running image to run as a non-root user to ensure least privileges.", "Message": "Container 'app' of Deployment 'pod-017-7-use-root-user-on-container' should set 'securityContext.runAsNonRoot' to true", "Namespace": "builtin.kubernetes.KSV012", "Query": "data.builtin.kubernetes.KSV012.deny", "Resolution": "Set 'containers[].securityContext.runAsNonRoot' to true.", "Severity": "MEDIUM", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv012", "References": ["https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted", "https://avd.aquasec.com/misconfig/ksv012"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 49, "EndLine": 83, "Code": {"Lines": [{"Number": 49, "Content": "        - image: nginx@sha256:aed492c4dc93d2d1f6fe9a49f00bc7e1863d950334a93facd8ca1317292bf6aa", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 50, "Content": "          imagePullPolicy: Always", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 51, "Content": "          livenessProbe:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 52, "Content": "            httpGet:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 53, "Content": "              path: /live", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 54, "Content": "              port: 8080", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 55, "Content": "          name: app", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 56, "Content": "          ports:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 57, "Content": "            - containerPort: 8080", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 58, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV020", "AVDID": "AVD-KSV-0020", "Title": "Runs with UID <= 10000", "Description": "Force the container to run with user ID > 10000 to avoid conflicts with the host\u2019s user table.", "Message": "Container 'app' of Deployment 'pod-017-7-use-root-user-on-container' should set 'securityContext.runAsUser' > 10000", "Namespace": "builtin.kubernetes.KSV020", "Query": "data.builtin.kubernetes.KSV020.deny", "Resolution": "Set 'containers[].securityContext.runAsUser' to an integer > 10000.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv020", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv020"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 49, "EndLine": 83, "Code": {"Lines": [{"Number": 49, "Content": "        - image: nginx@sha256:aed492c4dc93d2d1f6fe9a49f00bc7e1863d950334a93facd8ca1317292bf6aa", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 50, "Content": "          imagePullPolicy: Always", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 51, "Content": "          livenessProbe:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 52, "Content": "            httpGet:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 53, "Content": "              path: /live", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 54, "Content": "              port: 8080", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 55, "Content": "          name: app", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 56, "Content": "          ports:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 57, "Content": "            - containerPort: 8080", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 58, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "deployment pod-017-7-use-root-user-on-container in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 10, "EndLine": 10, "Code": {"Lines": [{"Number": 10, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "serviceaccount pod-017-7-use-root-user-on-container-dedicated-sa in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "pod-017-8-set-runasnonroot-correctly-on-container.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 3, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV020", "AVDID": "AVD-KSV-0020", "Title": "Runs with UID <= 10000", "Description": "Force the container to run with user ID > 10000 to avoid conflicts with the host\u2019s user table.", "Message": "Container 'app' of Deployment 'pod-017-8-set-runasnonroot-correctly-on-container' should set 'securityContext.runAsUser' > 10000", "Namespace": "builtin.kubernetes.KSV020", "Query": "data.builtin.kubernetes.KSV020.deny", "Resolution": "Set 'containers[].securityContext.runAsUser' to an integer > 10000.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv020", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv020"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 49, "EndLine": 83, "Code": {"Lines": [{"Number": 49, "Content": "        - image: nginx@sha256:aed492c4dc93d2d1f6fe9a49f00bc7e1863d950334a93facd8ca1317292bf6aa", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 50, "Content": "          imagePullPolicy: Always", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 51, "Content": "          livenessProbe:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 52, "Content": "            httpGet:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 53, "Content": "              path: /live", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 54, "Content": "              port: 8080", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 55, "Content": "          name: app", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 56, "Content": "          ports:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 57, "Content": "            - containerPort: 8080", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 58, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "deployment pod-017-8-set-runasnonroot-correctly-on-container in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 10, "EndLine": 10, "Code": {"Lines": [{"Number": 10, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "serviceaccount pod-017-8-set-runasnonroot-correctly-on-container-dedicated-sa in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "pod-017-9-set-runasnonroot-not-correctly-on-container.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 3, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV020", "AVDID": "AVD-KSV-0020", "Title": "Runs with UID <= 10000", "Description": "Force the container to run with user ID > 10000 to avoid conflicts with the host\u2019s user table.", "Message": "Container 'app' of Deployment 'pod-017-9-set-runasnonroot-not-correctly-on-container' should set 'securityContext.runAsUser' > 10000", "Namespace": "builtin.kubernetes.KSV020", "Query": "data.builtin.kubernetes.KSV020.deny", "Resolution": "Set 'containers[].securityContext.runAsUser' to an integer > 10000.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv020", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv020"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 49, "EndLine": 83, "Code": {"Lines": [{"Number": 49, "Content": "        - image: nginx@sha256:aed492c4dc93d2d1f6fe9a49f00bc7e1863d950334a93facd8ca1317292bf6aa", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 50, "Content": "          imagePullPolicy: Always", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 51, "Content": "          livenessProbe:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 52, "Content": "            httpGet:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 53, "Content": "              path: /live", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 54, "Content": "              port: 8080", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 55, "Content": "          name: app", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 56, "Content": "          ports:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 57, "Content": "            - containerPort: 8080", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 58, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "deployment pod-017-9-set-runasnonroot-not-correctly-on-container in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 10, "EndLine": 10, "Code": {"Lines": [{"Number": 10, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "serviceaccount pod-017-9-set-runasnonroot-not-correctly-on-container-dedicated-sa in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "pod-018-1-default-to-root-user.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 3, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV020", "AVDID": "AVD-KSV-0020", "Title": "Runs with UID <= 10000", "Description": "Force the container to run with user ID > 10000 to avoid conflicts with the host\u2019s user table.", "Message": "Container 'app' of Deployment 'pod-018-1-default-to-root-user' should set 'securityContext.runAsUser' > 10000", "Namespace": "builtin.kubernetes.KSV020", "Query": "data.builtin.kubernetes.KSV020.deny", "Resolution": "Set 'containers[].securityContext.runAsUser' to an integer > 10000.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv020", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv020"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 49, "EndLine": 83, "Code": {"Lines": [{"Number": 49, "Content": "        - image: nginx@sha256:aed492c4dc93d2d1f6fe9a49f00bc7e1863d950334a93facd8ca1317292bf6aa", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 50, "Content": "          imagePullPolicy: Always", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 51, "Content": "          livenessProbe:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 52, "Content": "            httpGet:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 53, "Content": "              path: /live", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 54, "Content": "              port: 8080", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 55, "Content": "          name: app", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 56, "Content": "          ports:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 57, "Content": "            - containerPort: 8080", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 58, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "deployment pod-018-1-default-to-root-user in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 10, "EndLine": 10, "Code": {"Lines": [{"Number": 10, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "serviceaccount pod-018-1-default-to-root-user-dedicated-sa in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "pod-018-2-use-uid-between-1k-10k-on-pod.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 3, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV020", "AVDID": "AVD-KSV-0020", "Title": "Runs with UID <= 10000", "Description": "Force the container to run with user ID > 10000 to avoid conflicts with the host\u2019s user table.", "Message": "Container 'app' of Deployment 'pod-018-2-use-uid-between-1k-10k-on-pod' should set 'securityContext.runAsUser' > 10000", "Namespace": "builtin.kubernetes.KSV020", "Query": "data.builtin.kubernetes.KSV020.deny", "Resolution": "Set 'containers[].securityContext.runAsUser' to an integer > 10000.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv020", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv020"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 49, "EndLine": 83, "Code": {"Lines": [{"Number": 49, "Content": "        - image: nginx@sha256:aed492c4dc93d2d1f6fe9a49f00bc7e1863d950334a93facd8ca1317292bf6aa", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 50, "Content": "          imagePullPolicy: Always", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 51, "Content": "          livenessProbe:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 52, "Content": "            httpGet:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 53, "Content": "              path: /live", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 54, "Content": "              port: 8080", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 55, "Content": "          name: app", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 56, "Content": "          ports:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 57, "Content": "            - containerPort: 8080", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 58, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "deployment pod-018-2-use-uid-between-1k-10k-on-pod in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 10, "EndLine": 10, "Code": {"Lines": [{"Number": 10, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "serviceaccount pod-018-2-use-uid-between-1k-10k-on-pod-dedicated-sa in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "pod-018-3-use-uid-between-1k-10k-on-container.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 3, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV020", "AVDID": "AVD-KSV-0020", "Title": "Runs with UID <= 10000", "Description": "Force the container to run with user ID > 10000 to avoid conflicts with the host\u2019s user table.", "Message": "Container 'app' of Deployment 'pod-018-3-use-uid-between-1k-10k-on-container' should set 'securityContext.runAsUser' > 10000", "Namespace": "builtin.kubernetes.KSV020", "Query": "data.builtin.kubernetes.KSV020.deny", "Resolution": "Set 'containers[].securityContext.runAsUser' to an integer > 10000.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv020", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv020"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 49, "EndLine": 84, "Code": {"Lines": [{"Number": 49, "Content": "        - image: nginx@sha256:aed492c4dc93d2d1f6fe9a49f00bc7e1863d950334a93facd8ca1317292bf6aa", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 50, "Content": "          imagePullPolicy: Always", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 51, "Content": "          livenessProbe:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 52, "Content": "            httpGet:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 53, "Content": "              path: /live", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 54, "Content": "              port: 8080", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 55, "Content": "          name: app", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 56, "Content": "          ports:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 57, "Content": "            - containerPort: 8080", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 58, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "deployment pod-018-3-use-uid-between-1k-10k-on-container in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 10, "EndLine": 10, "Code": {"Lines": [{"Number": 10, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "serviceaccount pod-018-3-use-uid-between-1k-10k-on-container-dedicated-sa in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "pod-018-4-use-uid-set-in-container-takes-precedence.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 4, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV020", "AVDID": "AVD-KSV-0020", "Title": "Runs with UID <= 10000", "Description": "Force the container to run with user ID > 10000 to avoid conflicts with the host\u2019s user table.", "Message": "Container 'app' of Deployment 'pod-018-4-use-uid-set-in-container-takes-precedence' should set 'securityContext.runAsUser' > 10000", "Namespace": "builtin.kubernetes.KSV020", "Query": "data.builtin.kubernetes.KSV020.deny", "Resolution": "Set 'containers[].securityContext.runAsUser' to an integer > 10000.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv020", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv020"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 49, "EndLine": 84, "Code": {"Lines": [{"Number": 49, "Content": "        - image: nginx@sha256:aed492c4dc93d2d1f6fe9a49f00bc7e1863d950334a93facd8ca1317292bf6aa", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 50, "Content": "          imagePullPolicy: Always", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 51, "Content": "          livenessProbe:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 52, "Content": "            httpGet:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 53, "Content": "              path: /live", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 54, "Content": "              port: 8080", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 55, "Content": "          name: app", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 56, "Content": "          ports:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 57, "Content": "            - containerPort: 8080", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 58, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV105", "AVDID": "AVD-KSV-0105", "Title": "Containers must not set runAsUser to 0", "Description": "Containers should be forbidden from running with a root UID.", "Message": "securityContext.runAsUser should be set to a value greater than 0", "Namespace": "builtin.kubernetes.KSV105", "Query": "data.builtin.kubernetes.KSV105.deny", "Resolution": "Set 'securityContext.runAsUser' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv105", "References": ["https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted", "https://avd.aquasec.com/misconfig/ksv105"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 92, "EndLine": 98, "Code": {"Lines": [{"Number": 92, "Content": "        runAsGroup: 31337", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 93, "Content": "        runAsNonRoot: true", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 94, "Content": "        runAsUser: 0", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 95, "Content": "        seLinuxOptions:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 96, "Content": "          level: s0:c123,c456", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 97, "Content": "        seccompProfile:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 98, "Content": "          type: RuntimeDefault", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "deployment pod-018-4-use-uid-set-in-container-takes-precedence in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 10, "EndLine": 10, "Code": {"Lines": [{"Number": 10, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "serviceaccount pod-018-4-use-uid-set-in-container-takes-precedence-dedicated-sa in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "pod-018-5-use-uid-set-in-container-takes-precedence.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 4, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV020", "AVDID": "AVD-KSV-0020", "Title": "Runs with UID <= 10000", "Description": "Force the container to run with user ID > 10000 to avoid conflicts with the host\u2019s user table.", "Message": "Container 'app' of Deployment 'pod-018-5-use-uid-set-in-container-takes-precedence' should set 'securityContext.runAsUser' > 10000", "Namespace": "builtin.kubernetes.KSV020", "Query": "data.builtin.kubernetes.KSV020.deny", "Resolution": "Set 'containers[].securityContext.runAsUser' to an integer > 10000.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv020", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv020"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 49, "EndLine": 84, "Code": {"Lines": [{"Number": 49, "Content": "        - image: nginx@sha256:aed492c4dc93d2d1f6fe9a49f00bc7e1863d950334a93facd8ca1317292bf6aa", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 50, "Content": "          imagePullPolicy: Always", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 51, "Content": "          livenessProbe:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 52, "Content": "            httpGet:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 53, "Content": "              path: /live", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 54, "Content": "              port: 8080", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 55, "Content": "          name: app", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 56, "Content": "          ports:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 57, "Content": "            - containerPort: 8080", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 58, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV105", "AVDID": "AVD-KSV-0105", "Title": "Containers must not set runAsUser to 0", "Description": "Containers should be forbidden from running with a root UID.", "Message": "securityContext.runAsUser should be set to a value greater than 0", "Namespace": "builtin.kubernetes.KSV105", "Query": "data.builtin.kubernetes.KSV105.deny", "Resolution": "Set 'securityContext.runAsUser' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv105", "References": ["https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted", "https://avd.aquasec.com/misconfig/ksv105"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 72, "EndLine": 84, "Code": {"Lines": [{"Number": 72, "Content": "            allowPrivilegeEscalation: false", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 73, "Content": "            capabilities:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 74, "Content": "              drop:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 75, "Content": "                - ALL", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 76, "Content": "            privileged: false", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 77, "Content": "            readOnlyRootFilesystem: true", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 78, "Content": "            runAsGroup: 31337", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 79, "Content": "            runAsNonRoot: true", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 80, "Content": "            runAsUser: 0", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 81, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "deployment pod-018-5-use-uid-set-in-container-takes-precedence in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 10, "EndLine": 10, "Code": {"Lines": [{"Number": 10, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "serviceaccount pod-018-5-use-uid-set-in-container-takes-precedence-dedicated-sa in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "pod-019-1-default-to-root-group.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 3, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV021", "AVDID": "AVD-KSV-0021", "Title": "Runs with GID <= 10000", "Description": "Force the container to run with group ID > 10000 to avoid conflicts with the host\u2019s user table.", "Message": "Container 'app' of Deployment 'pod-019-1-default-to-root-group' should set 'securityContext.runAsGroup' > 10000", "Namespace": "builtin.kubernetes.KSV021", "Query": "data.builtin.kubernetes.KSV021.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to an integer > 10000.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv021", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv021"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 49, "EndLine": 83, "Code": {"Lines": [{"Number": 49, "Content": "        - image: nginx@sha256:aed492c4dc93d2d1f6fe9a49f00bc7e1863d950334a93facd8ca1317292bf6aa", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 50, "Content": "          imagePullPolicy: Always", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 51, "Content": "          livenessProbe:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 52, "Content": "            httpGet:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 53, "Content": "              path: /live", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 54, "Content": "              port: 8080", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 55, "Content": "          name: app", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 56, "Content": "          ports:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 57, "Content": "            - containerPort: 8080", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 58, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "deployment pod-019-1-default-to-root-group in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 10, "EndLine": 10, "Code": {"Lines": [{"Number": 10, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "serviceaccount pod-019-1-default-to-root-group-dedicated-sa in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "pod-019-2-use-gid-between-1k-10k-on-pod.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 3, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV021", "AVDID": "AVD-KSV-0021", "Title": "Runs with GID <= 10000", "Description": "Force the container to run with group ID > 10000 to avoid conflicts with the host\u2019s user table.", "Message": "Container 'app' of Deployment 'pod-019-2-use-gid-between-1k-10k-on-pod' should set 'securityContext.runAsGroup' > 10000", "Namespace": "builtin.kubernetes.KSV021", "Query": "data.builtin.kubernetes.KSV021.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to an integer > 10000.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv021", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv021"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 49, "EndLine": 83, "Code": {"Lines": [{"Number": 49, "Content": "        - image: nginx@sha256:aed492c4dc93d2d1f6fe9a49f00bc7e1863d950334a93facd8ca1317292bf6aa", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 50, "Content": "          imagePullPolicy: Always", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 51, "Content": "          livenessProbe:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 52, "Content": "            httpGet:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 53, "Content": "              path: /live", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 54, "Content": "              port: 8080", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 55, "Content": "          name: app", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 56, "Content": "          ports:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 57, "Content": "            - containerPort: 8080", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 58, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "deployment pod-019-2-use-gid-between-1k-10k-on-pod in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 10, "EndLine": 10, "Code": {"Lines": [{"Number": 10, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "serviceaccount pod-019-2-use-gid-between-1k-10k-on-pod-dedicated-sa in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "pod-019-3-use-gid-between-1k-10k-on-container.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 3, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV021", "AVDID": "AVD-KSV-0021", "Title": "Runs with GID <= 10000", "Description": "Force the container to run with group ID > 10000 to avoid conflicts with the host\u2019s user table.", "Message": "Container 'app' of Deployment 'pod-019-3-use-gid-between-1k-10k-on-container' should set 'securityContext.runAsGroup' > 10000", "Namespace": "builtin.kubernetes.KSV021", "Query": "data.builtin.kubernetes.KSV021.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to an integer > 10000.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv021", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv021"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 49, "EndLine": 84, "Code": {"Lines": [{"Number": 49, "Content": "        - image: nginx@sha256:aed492c4dc93d2d1f6fe9a49f00bc7e1863d950334a93facd8ca1317292bf6aa", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 50, "Content": "          imagePullPolicy: Always", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 51, "Content": "          livenessProbe:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 52, "Content": "            httpGet:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 53, "Content": "              path: /live", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 54, "Content": "              port: 8080", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 55, "Content": "          name: app", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 56, "Content": "          ports:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 57, "Content": "            - containerPort: 8080", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 58, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "deployment pod-019-3-use-gid-between-1k-10k-on-container in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 10, "EndLine": 10, "Code": {"Lines": [{"Number": 10, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "serviceaccount pod-019-3-use-gid-between-1k-10k-on-container-dedicated-sa in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "pod-019-4-use-gid-set-in-container-takes-precedence.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 3, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV021", "AVDID": "AVD-KSV-0021", "Title": "Runs with GID <= 10000", "Description": "Force the container to run with group ID > 10000 to avoid conflicts with the host\u2019s user table.", "Message": "Container 'app' of Deployment 'pod-019-4-use-gid-set-in-container-takes-precedence' should set 'securityContext.runAsGroup' > 10000", "Namespace": "builtin.kubernetes.KSV021", "Query": "data.builtin.kubernetes.KSV021.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to an integer > 10000.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv021", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv021"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 49, "EndLine": 84, "Code": {"Lines": [{"Number": 49, "Content": "        - image: nginx@sha256:aed492c4dc93d2d1f6fe9a49f00bc7e1863d950334a93facd8ca1317292bf6aa", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 50, "Content": "          imagePullPolicy: Always", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 51, "Content": "          livenessProbe:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 52, "Content": "            httpGet:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 53, "Content": "              path: /live", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 54, "Content": "              port: 8080", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 55, "Content": "          name: app", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 56, "Content": "          ports:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 57, "Content": "            - containerPort: 8080", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 58, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "deployment pod-019-4-use-gid-set-in-container-takes-precedence in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 10, "EndLine": 10, "Code": {"Lines": [{"Number": 10, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "serviceaccount pod-019-4-use-gid-set-in-container-takes-precedence-dedicated-sa in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "pod-019-5-use-gid-set-in-container-takes-precedence.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 3, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV021", "AVDID": "AVD-KSV-0021", "Title": "Runs with GID <= 10000", "Description": "Force the container to run with group ID > 10000 to avoid conflicts with the host\u2019s user table.", "Message": "Container 'app' of Deployment 'pod-019-5-use-gid-set-in-container-takes-precedence' should set 'securityContext.runAsGroup' > 10000", "Namespace": "builtin.kubernetes.KSV021", "Query": "data.builtin.kubernetes.KSV021.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to an integer > 10000.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv021", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv021"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 49, "EndLine": 84, "Code": {"Lines": [{"Number": 49, "Content": "        - image: nginx@sha256:aed492c4dc93d2d1f6fe9a49f00bc7e1863d950334a93facd8ca1317292bf6aa", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 50, "Content": "          imagePullPolicy: Always", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 51, "Content": "          livenessProbe:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 52, "Content": "            httpGet:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 53, "Content": "              path: /live", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 54, "Content": "              port: 8080", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 55, "Content": "          name: app", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 56, "Content": "          ports:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 57, "Content": "            - containerPort: 8080", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 58, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "deployment pod-019-5-use-gid-set-in-container-takes-precedence in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 10, "EndLine": 10, "Code": {"Lines": [{"Number": 10, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "serviceaccount pod-019-5-use-gid-set-in-container-takes-precedence-dedicated-sa in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "pod-021-0-using-sysctl-kernel.shm-rmid-forced-c808ea91.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 2, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "deployment pod-021-0-using-sysctl-kernel.shm-rmid-forced in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 10, "EndLine": 10, "Code": {"Lines": [{"Number": 10, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "serviceaccount pod-021-0-using-sysctl-kernel.shm-rmid-forced-dedicated-sa in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "pod-021-1-using-sysctl-net.ipv4.tcp-keepalive-time-c86452e6.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 3, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV026", "AVDID": "AVD-KSV-0026", "Title": "Unsafe sysctl options set", "Description": "Sysctls can disable security mechanisms or affect all containers on a host, and should be disallowed except for an allowed 'safe' subset. A sysctl is considered safe if it is namespaced in the container or the Pod, and it is isolated from other Pods or processes on the same Node.", "Message": "Deployment 'pod-021-1-using-sysctl-net.ipv4.tcp-keepalive-time' should set 'securityContext.sysctl' to the allowed values", "Namespace": "builtin.kubernetes.KSV026", "Query": "data.builtin.kubernetes.KSV026.deny", "Resolution": "Do not set 'spec.securityContext.sysctls' or set to values in an allowed subset", "Severity": "MEDIUM", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv026", "References": ["https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline", "https://avd.aquasec.com/misconfig/ksv026"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 24, "EndLine": 102, "Code": {"Lines": [{"Number": 24, "Content": "  replicas: 1", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 25, "Content": "  selector:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 26, "Content": "    matchLabels:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 27, "Content": "      app.kubernetes.io/part-of: kalm-benchmark", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 28, "Content": "      check: POD-021-1", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 29, "Content": "  template:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 30, "Content": "    metadata:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 31, "Content": "      annotations:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 32, "Content": "        container.apparmor.security.beta.kubernetes.io/app: runtime/default", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 33, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "deployment pod-021-1-using-sysctl-net.ipv4.tcp-keepalive-time in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 10, "EndLine": 10, "Code": {"Lines": [{"Number": 10, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "serviceaccount pod-021-1-using-sysctl-net.ipv4.tcp-keepalive-time-dedicated-sa in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "pod-021-2-using-sysctl-net.ipv4.tcp-keepalive-probes-c83975aa.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 3, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV026", "AVDID": "AVD-KSV-0026", "Title": "Unsafe sysctl options set", "Description": "Sysctls can disable security mechanisms or affect all containers on a host, and should be disallowed except for an allowed 'safe' subset. A sysctl is considered safe if it is namespaced in the container or the Pod, and it is isolated from other Pods or processes on the same Node.", "Message": "Deployment 'pod-021-2-using-sysctl-net.ipv4.tcp-keepalive-probes' should set 'securityContext.sysctl' to the allowed values", "Namespace": "builtin.kubernetes.KSV026", "Query": "data.builtin.kubernetes.KSV026.deny", "Resolution": "Do not set 'spec.securityContext.sysctls' or set to values in an allowed subset", "Severity": "MEDIUM", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv026", "References": ["https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline", "https://avd.aquasec.com/misconfig/ksv026"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 24, "EndLine": 102, "Code": {"Lines": [{"Number": 24, "Content": "  replicas: 1", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 25, "Content": "  selector:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 26, "Content": "    matchLabels:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 27, "Content": "      app.kubernetes.io/part-of: kalm-benchmark", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 28, "Content": "      check: POD-021-2", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 29, "Content": "  template:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 30, "Content": "    metadata:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 31, "Content": "      annotations:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 32, "Content": "        container.apparmor.security.beta.kubernetes.io/app: runtime/default", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 33, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "deployment pod-021-2-using-sysctl-net.ipv4.tcp-keepalive-probes in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 10, "EndLine": 10, "Code": {"Lines": [{"Number": 10, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "serviceaccount pod-021-2-using-sysctl-net.ipv4.tcp-keepalive-probes-dedicated-sa in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "pod-022-1-linux-is-not-hardened.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 4, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV030", "AVDID": "AVD-KSV-0030", "Title": "Runtime/Default Seccomp profile not set", "Description": "According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.", "Message": "Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'", "Namespace": "builtin.kubernetes.KSV030", "Query": "data.builtin.kubernetes.KSV030.deny", "Resolution": "Set 'spec.securityContext.seccompProfile.type', 'spec.containers[*].securityContext.seccompProfile' and 'spec.initContainers[*].securityContext.seccompProfile' to 'RuntimeDefault' or undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv030", "References": ["https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted", "https://avd.aquasec.com/misconfig/ksv030"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 46, "EndLine": 77, "Code": {"Lines": [{"Number": 46, "Content": "        - image: nginx@sha256:aed492c4dc93d2d1f6fe9a49f00bc7e1863d950334a93facd8ca1317292bf6aa", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 47, "Content": "          imagePullPolicy: Always", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 48, "Content": "          livenessProbe:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 49, "Content": "            httpGet:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 50, "Content": "              path: /live", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 51, "Content": "              port: 8080", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 52, "Content": "          name: app", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 53, "Content": "          ports:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 54, "Content": "            - containerPort: 8080", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 55, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV104", "AVDID": "AVD-KSV-0104", "Title": "Seccomp policies disabled", "Description": "A program inside the container can bypass Seccomp protection policies.", "Message": "container app of deployment pod-022-1-linux-is-not-hardened in kalm-benchmark namespace should specify a seccomp profile", "Namespace": "builtin.kubernetes.KSV104", "Query": "data.builtin.kubernetes.KSV104.deny", "Resolution": "Specify seccomp either by annotation or by seccomp profile type having allowed values as per pod security standards", "Severity": "MEDIUM", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv104", "References": ["https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline", "https://avd.aquasec.com/misconfig/ksv104"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 10, "EndLine": 10, "Code": {"Lines": [{"Number": 10, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "deployment pod-022-1-linux-is-not-hardened in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 10, "EndLine": 10, "Code": {"Lines": [{"Number": 10, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "serviceaccount pod-022-1-linux-is-not-hardened-dedicated-sa in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "pod-022-2-one-approach-to-hardening-linux-is-enough.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 2, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "deployment pod-022-2-one-approach-to-hardening-linux-is-enough in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 10, "EndLine": 10, "Code": {"Lines": [{"Number": 10, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "serviceaccount pod-022-2-one-approach-to-hardening-linux-is-enough-dedicated-sa in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "pod-022-3-one-approach-to-hardening-linux-is-enough.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 2, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "deployment pod-022-3-one-approach-to-hardening-linux-is-enough in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 10, "EndLine": 10, "Code": {"Lines": [{"Number": 10, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "serviceaccount pod-022-3-one-approach-to-hardening-linux-is-enough-dedicated-sa in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "pod-023-no-seccomp-profile-defined.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 2, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "deployment pod-023-no-seccomp-profile-defined in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 10, "EndLine": 10, "Code": {"Lines": [{"Number": 10, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "serviceaccount pod-023-no-seccomp-profile-defined-dedicated-sa in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "pod-024-0-usage-of-bin-bash-in-container.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 2, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "deployment pod-024-0-usage-of-bin-bash-in-container in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 10, "EndLine": 10, "Code": {"Lines": [{"Number": 10, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "serviceaccount pod-024-0-usage-of-bin-bash-in-container-dedicated-sa in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "pod-024-1-usage-of-sbin-sh-in-container.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 2, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "deployment pod-024-1-usage-of-sbin-sh-in-container in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 10, "EndLine": 10, "Code": {"Lines": [{"Number": 10, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "serviceaccount pod-024-1-usage-of-sbin-sh-in-container-dedicated-sa in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "pod-024-2-usage-of-bin-ksh-in-container.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 2, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "deployment pod-024-2-usage-of-bin-ksh-in-container in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 10, "EndLine": 10, "Code": {"Lines": [{"Number": 10, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "serviceaccount pod-024-2-usage-of-bin-ksh-in-container-dedicated-sa in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "pod-024-3-usage-of-bin-tcsh-in-container.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 2, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "deployment pod-024-3-usage-of-bin-tcsh-in-container in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 10, "EndLine": 10, "Code": {"Lines": [{"Number": 10, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "serviceaccount pod-024-3-usage-of-bin-tcsh-in-container-dedicated-sa in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "pod-024-4-usage-of-bin-zsh-in-container.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 2, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "deployment pod-024-4-usage-of-bin-zsh-in-container in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 10, "EndLine": 10, "Code": {"Lines": [{"Number": 10, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "serviceaccount pod-024-4-usage-of-bin-zsh-in-container-dedicated-sa in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "pod-024-5-usage-of-usr-bin-scsh-in-container.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 2, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "deployment pod-024-5-usage-of-usr-bin-scsh-in-container in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 10, "EndLine": 10, "Code": {"Lines": [{"Number": 10, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "serviceaccount pod-024-5-usage-of-usr-bin-scsh-in-container-dedicated-sa in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "pod-024-6-usage-of-bin-csh-in-container.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 2, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "deployment pod-024-6-usage-of-bin-csh-in-container in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 10, "EndLine": 10, "Code": {"Lines": [{"Number": 10, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "serviceaccount pod-024-6-usage-of-bin-csh-in-container-dedicated-sa in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "pod-024-7-usage-of-bin-busybox-in-container.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 2, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "deployment pod-024-7-usage-of-bin-busybox-in-container in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 10, "EndLine": 10, "Code": {"Lines": [{"Number": 10, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "serviceaccount pod-024-7-usage-of-bin-busybox-in-container-dedicated-sa in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "pod-024-8-usage-of-usr-bin-busybox-in-container.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 2, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "deployment pod-024-8-usage-of-usr-bin-busybox-in-container in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 10, "EndLine": 10, "Code": {"Lines": [{"Number": 10, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "serviceaccount pod-024-8-usage-of-usr-bin-busybox-in-container-dedicated-sa in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "pod-025-sensitive-key-referenced-in-environment-variable.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 2, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "deployment pod-025-sensitive-key-referenced-in-environment-variable in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 10, "EndLine": 10, "Code": {"Lines": [{"Number": 10, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "serviceaccount pod-025-sensitive-key-referenced-in-environment-variable-dedicated-sa in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "pod-030-no-securitycontext-defined.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 2, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "deployment pod-030-no-securitycontext-defined in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 10, "EndLine": 10, "Code": {"Lines": [{"Number": 10, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "serviceaccount pod-030-no-securitycontext-defined-dedicated-sa in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "pod-031-1-allowed-privilege-escalation-by-default.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 3, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV001", "AVDID": "AVD-KSV-0001", "Title": "Can elevate its own privileges", "Description": "A program inside the container can elevate its own privileges and run as root, which might give the program control over the container and node.", "Message": "Container 'app' of Deployment 'pod-031-1-allowed-privilege-escalation-by-default' should set 'securityContext.allowPrivilegeEscalation' to false", "Namespace": "builtin.kubernetes.KSV001", "Query": "data.builtin.kubernetes.KSV001.deny", "Resolution": "Set 'set containers[].securityContext.allowPrivilegeEscalation' to 'false'.", "Severity": "MEDIUM", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv001", "References": ["https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted", "https://avd.aquasec.com/misconfig/ksv001"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 49, "EndLine": 83, "Code": {"Lines": [{"Number": 49, "Content": "        - image: nginx@sha256:aed492c4dc93d2d1f6fe9a49f00bc7e1863d950334a93facd8ca1317292bf6aa", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 50, "Content": "          imagePullPolicy: Always", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 51, "Content": "          livenessProbe:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 52, "Content": "            httpGet:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 53, "Content": "              path: /live", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 54, "Content": "              port: 8080", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 55, "Content": "          name: app", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 56, "Content": "          ports:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 57, "Content": "            - containerPort: 8080", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 58, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "deployment pod-031-1-allowed-privilege-escalation-by-default in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 10, "EndLine": 10, "Code": {"Lines": [{"Number": 10, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "serviceaccount pod-031-1-allowed-privilege-escalation-by-default-dedicated-sa in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "pod-031-2-allowed-privilege-escalation-explicitly.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 3, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV001", "AVDID": "AVD-KSV-0001", "Title": "Can elevate its own privileges", "Description": "A program inside the container can elevate its own privileges and run as root, which might give the program control over the container and node.", "Message": "Container 'app' of Deployment 'pod-031-2-allowed-privilege-escalation-explicitly' should set 'securityContext.allowPrivilegeEscalation' to false", "Namespace": "builtin.kubernetes.KSV001", "Query": "data.builtin.kubernetes.KSV001.deny", "Resolution": "Set 'set containers[].securityContext.allowPrivilegeEscalation' to 'false'.", "Severity": "MEDIUM", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv001", "References": ["https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted", "https://avd.aquasec.com/misconfig/ksv001"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 49, "EndLine": 84, "Code": {"Lines": [{"Number": 49, "Content": "        - image: nginx@sha256:aed492c4dc93d2d1f6fe9a49f00bc7e1863d950334a93facd8ca1317292bf6aa", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 50, "Content": "          imagePullPolicy: Always", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 51, "Content": "          livenessProbe:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 52, "Content": "            httpGet:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 53, "Content": "              path: /live", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 54, "Content": "              port: 8080", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 55, "Content": "          name: app", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 56, "Content": "          ports:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 57, "Content": "            - containerPort: 8080", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 58, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "deployment pod-031-2-allowed-privilege-escalation-explicitly in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 10, "EndLine": 10, "Code": {"Lines": [{"Number": 10, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "serviceaccount pod-031-2-allowed-privilege-escalation-explicitly-dedicated-sa in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "pod-032-1-non-privileged-container-by-default.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 2, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "deployment pod-032-1-non-privileged-container-by-default in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 10, "EndLine": 10, "Code": {"Lines": [{"Number": 10, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "serviceaccount pod-032-1-non-privileged-container-by-default-dedicated-sa in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "pod-032-2-privileged-container.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 4, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV001", "AVDID": "AVD-KSV-0001", "Title": "Can elevate its own privileges", "Description": "A program inside the container can elevate its own privileges and run as root, which might give the program control over the container and node.", "Message": "Container 'app' of Deployment 'pod-032-2-privileged-container' should set 'securityContext.allowPrivilegeEscalation' to false", "Namespace": "builtin.kubernetes.KSV001", "Query": "data.builtin.kubernetes.KSV001.deny", "Resolution": "Set 'set containers[].securityContext.allowPrivilegeEscalation' to 'false'.", "Severity": "MEDIUM", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv001", "References": ["https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted", "https://avd.aquasec.com/misconfig/ksv001"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 49, "EndLine": 83, "Code": {"Lines": [{"Number": 49, "Content": "        - image: nginx@sha256:aed492c4dc93d2d1f6fe9a49f00bc7e1863d950334a93facd8ca1317292bf6aa", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 50, "Content": "          imagePullPolicy: Always", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 51, "Content": "          livenessProbe:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 52, "Content": "            httpGet:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 53, "Content": "              path: /live", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 54, "Content": "              port: 8080", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 55, "Content": "          name: app", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 56, "Content": "          ports:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 57, "Content": "            - containerPort: 8080", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 58, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV017", "AVDID": "AVD-KSV-0017", "Title": "Privileged", "Description": "Privileged containers share namespaces with the host system and do not offer any security. They should be used exclusively for system containers that require high privileges.", "Message": "Container 'app' of Deployment 'pod-032-2-privileged-container' should set 'securityContext.privileged' to false", "Namespace": "builtin.kubernetes.KSV017", "Query": "data.builtin.kubernetes.KSV017.deny", "Resolution": "Change 'containers[].securityContext.privileged' to 'false'.", "Severity": "HIGH", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv017", "References": ["https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline", "https://avd.aquasec.com/misconfig/ksv017"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 49, "EndLine": 83, "Code": {"Lines": [{"Number": 49, "Content": "        - image: nginx@sha256:aed492c4dc93d2d1f6fe9a49f00bc7e1863d950334a93facd8ca1317292bf6aa", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 50, "Content": "          imagePullPolicy: Always", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 51, "Content": "          livenessProbe:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 52, "Content": "            httpGet:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 53, "Content": "              path: /live", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 54, "Content": "              port: 8080", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 55, "Content": "          name: app", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 56, "Content": "          ports:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 57, "Content": "            - containerPort: 8080", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 58, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "deployment pod-032-2-privileged-container in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 10, "EndLine": 10, "Code": {"Lines": [{"Number": 10, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "serviceaccount pod-032-2-privileged-container-dedicated-sa in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "pod-033-1-root-fs-is-writeable-by-default.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 3, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV014", "AVDID": "AVD-KSV-0014", "Title": "Root file system is not read-only", "Description": "An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.", "Message": "Container 'app' of Deployment 'pod-033-1-root-fs-is-writeable-by-default' should set 'securityContext.readOnlyRootFilesystem' to true", "Namespace": "builtin.kubernetes.KSV014", "Query": "data.builtin.kubernetes.KSV014.deny", "Resolution": "Change 'containers[].securityContext.readOnlyRootFilesystem' to 'true'.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv014", "References": ["https://kubesec.io/basics/containers-securitycontext-readonlyrootfilesystem-true/", "https://avd.aquasec.com/misconfig/ksv014"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 49, "EndLine": 83, "Code": {"Lines": [{"Number": 49, "Content": "        - image: nginx@sha256:aed492c4dc93d2d1f6fe9a49f00bc7e1863d950334a93facd8ca1317292bf6aa", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 50, "Content": "          imagePullPolicy: Always", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 51, "Content": "          livenessProbe:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 52, "Content": "            httpGet:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 53, "Content": "              path: /live", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 54, "Content": "              port: 8080", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 55, "Content": "          name: app", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 56, "Content": "          ports:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 57, "Content": "            - containerPort: 8080", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 58, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "deployment pod-033-1-root-fs-is-writeable-by-default in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 10, "EndLine": 10, "Code": {"Lines": [{"Number": 10, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "serviceaccount pod-033-1-root-fs-is-writeable-by-default-dedicated-sa in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "pod-033-2-root-fs-is-explicitly-writeable.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 3, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV014", "AVDID": "AVD-KSV-0014", "Title": "Root file system is not read-only", "Description": "An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.", "Message": "Container 'app' of Deployment 'pod-033-2-root-fs-is-explicitly-writeable' should set 'securityContext.readOnlyRootFilesystem' to true", "Namespace": "builtin.kubernetes.KSV014", "Query": "data.builtin.kubernetes.KSV014.deny", "Resolution": "Change 'containers[].securityContext.readOnlyRootFilesystem' to 'true'.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv014", "References": ["https://kubesec.io/basics/containers-securitycontext-readonlyrootfilesystem-true/", "https://avd.aquasec.com/misconfig/ksv014"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 49, "EndLine": 84, "Code": {"Lines": [{"Number": 49, "Content": "        - image: nginx@sha256:aed492c4dc93d2d1f6fe9a49f00bc7e1863d950334a93facd8ca1317292bf6aa", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 50, "Content": "          imagePullPolicy: Always", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 51, "Content": "          livenessProbe:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 52, "Content": "            httpGet:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 53, "Content": "              path: /live", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 54, "Content": "              port: 8080", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 55, "Content": "          name: app", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 56, "Content": "          ports:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 57, "Content": "            - containerPort: 8080", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 58, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "deployment pod-033-2-root-fs-is-explicitly-writeable in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 10, "EndLine": 10, "Code": {"Lines": [{"Number": 10, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "serviceaccount pod-033-2-root-fs-is-explicitly-writeable-dedicated-sa in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "pod-034-1-using-dangerous-capability-all.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 4, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV022", "AVDID": "AVD-KSV-0022", "Title": "Specific capabilities added", "Description": "According to pod security standard 'Capabilities', capabilities beyond the default set must not be added.", "Message": "Container 'app' of Deployment 'pod-034-1-using-dangerous-capability-all' should not set 'securityContext.capabilities.add'", "Namespace": "builtin.kubernetes.KSV022", "Query": "data.builtin.kubernetes.KSV022.deny", "Resolution": "Do not set spec.containers[*].securityContext.capabilities.add and spec.initContainers[*].securityContext.capabilities.add.", "Severity": "MEDIUM", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv022", "References": ["https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline", "https://avd.aquasec.com/misconfig/ksv022"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 49, "EndLine": 86, "Code": {"Lines": [{"Number": 49, "Content": "        - image: nginx@sha256:aed492c4dc93d2d1f6fe9a49f00bc7e1863d950334a93facd8ca1317292bf6aa", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 50, "Content": "          imagePullPolicy: Always", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 51, "Content": "          livenessProbe:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 52, "Content": "            httpGet:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 53, "Content": "              path: /live", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 54, "Content": "              port: 8080", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 55, "Content": "          name: app", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 56, "Content": "          ports:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 57, "Content": "            - containerPort: 8080", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 58, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV106", "AVDID": "AVD-KSV-0106", "Title": "Container capabilities must only include NET_BIND_SERVICE", "Description": "Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.", "Message": "container should not add stuff", "Namespace": "builtin.kubernetes.KSV106", "Query": "data.builtin.kubernetes.KSV106.deny", "Resolution": "Set 'spec.containers[*].securityContext.capabilities.drop' to 'ALL' and only add 'NET_BIND_SERVICE' to 'spec.containers[*].securityContext.capabilities.add'.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv106", "References": ["https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted", "https://avd.aquasec.com/misconfig/ksv106"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 74, "EndLine": 77, "Code": {"Lines": [{"Number": 74, "Content": "              add:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 75, "Content": "                - ALL", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 76, "Content": "              drop:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 77, "Content": "                - ALL", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "deployment pod-034-1-using-dangerous-capability-all in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 10, "EndLine": 10, "Code": {"Lines": [{"Number": 10, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "serviceaccount pod-034-1-using-dangerous-capability-all-dedicated-sa in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "pod-034-2-using-dangerous-capability-sys-admin.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 5, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV005", "AVDID": "AVD-KSV-0005", "Title": "SYS_ADMIN capability added", "Description": "SYS_ADMIN gives the processes running inside the container privileges that are equivalent to root.", "Message": "Container 'app' of Deployment 'pod-034-2-using-dangerous-capability-sys-admin' should not include 'SYS_ADMIN' in 'securityContext.capabilities.add'", "Namespace": "builtin.kubernetes.KSV005", "Query": "data.builtin.kubernetes.KSV005.deny", "Resolution": "Remove the SYS_ADMIN capability from 'containers[].securityContext.capabilities.add'.", "Severity": "HIGH", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv005", "References": ["https://kubesec.io/basics/containers-securitycontext-capabilities-add-index-sys-admin/", "https://avd.aquasec.com/misconfig/ksv005"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 49, "EndLine": 86, "Code": {"Lines": [{"Number": 49, "Content": "        - image: nginx@sha256:aed492c4dc93d2d1f6fe9a49f00bc7e1863d950334a93facd8ca1317292bf6aa", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 50, "Content": "          imagePullPolicy: Always", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 51, "Content": "          livenessProbe:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 52, "Content": "            httpGet:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 53, "Content": "              path: /live", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 54, "Content": "              port: 8080", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 55, "Content": "          name: app", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 56, "Content": "          ports:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 57, "Content": "            - containerPort: 8080", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 58, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV022", "AVDID": "AVD-KSV-0022", "Title": "Specific capabilities added", "Description": "According to pod security standard 'Capabilities', capabilities beyond the default set must not be added.", "Message": "Container 'app' of Deployment 'pod-034-2-using-dangerous-capability-sys-admin' should not set 'securityContext.capabilities.add'", "Namespace": "builtin.kubernetes.KSV022", "Query": "data.builtin.kubernetes.KSV022.deny", "Resolution": "Do not set spec.containers[*].securityContext.capabilities.add and spec.initContainers[*].securityContext.capabilities.add.", "Severity": "MEDIUM", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv022", "References": ["https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline", "https://avd.aquasec.com/misconfig/ksv022"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 49, "EndLine": 86, "Code": {"Lines": [{"Number": 49, "Content": "        - image: nginx@sha256:aed492c4dc93d2d1f6fe9a49f00bc7e1863d950334a93facd8ca1317292bf6aa", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 50, "Content": "          imagePullPolicy: Always", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 51, "Content": "          livenessProbe:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 52, "Content": "            httpGet:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 53, "Content": "              path: /live", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 54, "Content": "              port: 8080", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 55, "Content": "          name: app", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 56, "Content": "          ports:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 57, "Content": "            - containerPort: 8080", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 58, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV106", "AVDID": "AVD-KSV-0106", "Title": "Container capabilities must only include NET_BIND_SERVICE", "Description": "Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.", "Message": "container should not add stuff", "Namespace": "builtin.kubernetes.KSV106", "Query": "data.builtin.kubernetes.KSV106.deny", "Resolution": "Set 'spec.containers[*].securityContext.capabilities.drop' to 'ALL' and only add 'NET_BIND_SERVICE' to 'spec.containers[*].securityContext.capabilities.add'.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv106", "References": ["https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted", "https://avd.aquasec.com/misconfig/ksv106"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 74, "EndLine": 77, "Code": {"Lines": [{"Number": 74, "Content": "              add:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 75, "Content": "                - SYS_ADMIN", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 76, "Content": "              drop:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 77, "Content": "                - ALL", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "deployment pod-034-2-using-dangerous-capability-sys-admin in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 10, "EndLine": 10, "Code": {"Lines": [{"Number": 10, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "serviceaccount pod-034-2-using-dangerous-capability-sys-admin-dedicated-sa in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "pod-034-3-using-dangerous-capability-net-admin.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 4, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV022", "AVDID": "AVD-KSV-0022", "Title": "Specific capabilities added", "Description": "According to pod security standard 'Capabilities', capabilities beyond the default set must not be added.", "Message": "Container 'app' of Deployment 'pod-034-3-using-dangerous-capability-net-admin' should not set 'securityContext.capabilities.add'", "Namespace": "builtin.kubernetes.KSV022", "Query": "data.builtin.kubernetes.KSV022.deny", "Resolution": "Do not set spec.containers[*].securityContext.capabilities.add and spec.initContainers[*].securityContext.capabilities.add.", "Severity": "MEDIUM", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv022", "References": ["https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline", "https://avd.aquasec.com/misconfig/ksv022"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 49, "EndLine": 86, "Code": {"Lines": [{"Number": 49, "Content": "        - image: nginx@sha256:aed492c4dc93d2d1f6fe9a49f00bc7e1863d950334a93facd8ca1317292bf6aa", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 50, "Content": "          imagePullPolicy: Always", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 51, "Content": "          livenessProbe:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 52, "Content": "            httpGet:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 53, "Content": "              path: /live", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 54, "Content": "              port: 8080", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 55, "Content": "          name: app", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 56, "Content": "          ports:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 57, "Content": "            - containerPort: 8080", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 58, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV106", "AVDID": "AVD-KSV-0106", "Title": "Container capabilities must only include NET_BIND_SERVICE", "Description": "Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.", "Message": "container should not add stuff", "Namespace": "builtin.kubernetes.KSV106", "Query": "data.builtin.kubernetes.KSV106.deny", "Resolution": "Set 'spec.containers[*].securityContext.capabilities.drop' to 'ALL' and only add 'NET_BIND_SERVICE' to 'spec.containers[*].securityContext.capabilities.add'.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv106", "References": ["https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted", "https://avd.aquasec.com/misconfig/ksv106"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 74, "EndLine": 77, "Code": {"Lines": [{"Number": 74, "Content": "              add:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 75, "Content": "                - NET_ADMIN", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 76, "Content": "              drop:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 77, "Content": "                - ALL", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "deployment pod-034-3-using-dangerous-capability-net-admin in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 10, "EndLine": 10, "Code": {"Lines": [{"Number": 10, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "serviceaccount pod-034-3-using-dangerous-capability-net-admin-dedicated-sa in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "pod-035-1-using-insecure-capability-audit-write.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 4, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV022", "AVDID": "AVD-KSV-0022", "Title": "Specific capabilities added", "Description": "According to pod security standard 'Capabilities', capabilities beyond the default set must not be added.", "Message": "Container 'app' of Deployment 'pod-035-1-using-insecure-capability-audit-write' should not set 'securityContext.capabilities.add'", "Namespace": "builtin.kubernetes.KSV022", "Query": "data.builtin.kubernetes.KSV022.deny", "Resolution": "Do not set spec.containers[*].securityContext.capabilities.add and spec.initContainers[*].securityContext.capabilities.add.", "Severity": "MEDIUM", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv022", "References": ["https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline", "https://avd.aquasec.com/misconfig/ksv022"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 49, "EndLine": 86, "Code": {"Lines": [{"Number": 49, "Content": "        - image: nginx@sha256:aed492c4dc93d2d1f6fe9a49f00bc7e1863d950334a93facd8ca1317292bf6aa", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 50, "Content": "          imagePullPolicy: Always", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 51, "Content": "          livenessProbe:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 52, "Content": "            httpGet:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 53, "Content": "              path: /live", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 54, "Content": "              port: 8080", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 55, "Content": "          name: app", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 56, "Content": "          ports:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 57, "Content": "            - containerPort: 8080", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 58, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV106", "AVDID": "AVD-KSV-0106", "Title": "Container capabilities must only include NET_BIND_SERVICE", "Description": "Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.", "Message": "container should not add stuff", "Namespace": "builtin.kubernetes.KSV106", "Query": "data.builtin.kubernetes.KSV106.deny", "Resolution": "Set 'spec.containers[*].securityContext.capabilities.drop' to 'ALL' and only add 'NET_BIND_SERVICE' to 'spec.containers[*].securityContext.capabilities.add'.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv106", "References": ["https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted", "https://avd.aquasec.com/misconfig/ksv106"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 74, "EndLine": 77, "Code": {"Lines": [{"Number": 74, "Content": "              add:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 75, "Content": "                - AUDIT_WRITE", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 76, "Content": "              drop:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 77, "Content": "                - ALL", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "deployment pod-035-1-using-insecure-capability-audit-write in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 10, "EndLine": 10, "Code": {"Lines": [{"Number": 10, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "serviceaccount pod-035-1-using-insecure-capability-audit-write-dedicated-sa in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "pod-035-10-using-insecure-capability-mknod.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 4, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV022", "AVDID": "AVD-KSV-0022", "Title": "Specific capabilities added", "Description": "According to pod security standard 'Capabilities', capabilities beyond the default set must not be added.", "Message": "Container 'app' of Deployment 'pod-035-10-using-insecure-capability-mknod' should not set 'securityContext.capabilities.add'", "Namespace": "builtin.kubernetes.KSV022", "Query": "data.builtin.kubernetes.KSV022.deny", "Resolution": "Do not set spec.containers[*].securityContext.capabilities.add and spec.initContainers[*].securityContext.capabilities.add.", "Severity": "MEDIUM", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv022", "References": ["https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline", "https://avd.aquasec.com/misconfig/ksv022"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 49, "EndLine": 86, "Code": {"Lines": [{"Number": 49, "Content": "        - image: nginx@sha256:aed492c4dc93d2d1f6fe9a49f00bc7e1863d950334a93facd8ca1317292bf6aa", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 50, "Content": "          imagePullPolicy: Always", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 51, "Content": "          livenessProbe:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 52, "Content": "            httpGet:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 53, "Content": "              path: /live", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 54, "Content": "              port: 8080", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 55, "Content": "          name: app", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 56, "Content": "          ports:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 57, "Content": "            - containerPort: 8080", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 58, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV106", "AVDID": "AVD-KSV-0106", "Title": "Container capabilities must only include NET_BIND_SERVICE", "Description": "Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.", "Message": "container should not add stuff", "Namespace": "builtin.kubernetes.KSV106", "Query": "data.builtin.kubernetes.KSV106.deny", "Resolution": "Set 'spec.containers[*].securityContext.capabilities.drop' to 'ALL' and only add 'NET_BIND_SERVICE' to 'spec.containers[*].securityContext.capabilities.add'.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv106", "References": ["https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted", "https://avd.aquasec.com/misconfig/ksv106"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 74, "EndLine": 77, "Code": {"Lines": [{"Number": 74, "Content": "              add:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 75, "Content": "                - MKNOD", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 76, "Content": "              drop:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 77, "Content": "                - ALL", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "deployment pod-035-10-using-insecure-capability-mknod in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 10, "EndLine": 10, "Code": {"Lines": [{"Number": 10, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "serviceaccount pod-035-10-using-insecure-capability-mknod-dedicated-sa in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "pod-035-11-using-insecure-capability-net-bind-service.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 3, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV022", "AVDID": "AVD-KSV-0022", "Title": "Specific capabilities added", "Description": "According to pod security standard 'Capabilities', capabilities beyond the default set must not be added.", "Message": "Container 'app' of Deployment 'pod-035-11-using-insecure-capability-net-bind-service' should not set 'securityContext.capabilities.add'", "Namespace": "builtin.kubernetes.KSV022", "Query": "data.builtin.kubernetes.KSV022.deny", "Resolution": "Do not set spec.containers[*].securityContext.capabilities.add and spec.initContainers[*].securityContext.capabilities.add.", "Severity": "MEDIUM", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv022", "References": ["https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline", "https://avd.aquasec.com/misconfig/ksv022"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 49, "EndLine": 86, "Code": {"Lines": [{"Number": 49, "Content": "        - image: nginx@sha256:aed492c4dc93d2d1f6fe9a49f00bc7e1863d950334a93facd8ca1317292bf6aa", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 50, "Content": "          imagePullPolicy: Always", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 51, "Content": "          livenessProbe:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 52, "Content": "            httpGet:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 53, "Content": "              path: /live", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 54, "Content": "              port: 8080", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 55, "Content": "          name: app", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 56, "Content": "          ports:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 57, "Content": "            - containerPort: 8080", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 58, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "deployment pod-035-11-using-insecure-capability-net-bind-service in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 10, "EndLine": 10, "Code": {"Lines": [{"Number": 10, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "serviceaccount pod-035-11-using-insecure-capability-net-bind-service-dedicated-sa in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "pod-035-12-using-insecure-capability-net-raw.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 5, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV022", "AVDID": "AVD-KSV-0022", "Title": "Specific capabilities added", "Description": "According to pod security standard 'Capabilities', capabilities beyond the default set must not be added.", "Message": "Container 'app' of Deployment 'pod-035-12-using-insecure-capability-net-raw' should not set 'securityContext.capabilities.add'", "Namespace": "builtin.kubernetes.KSV022", "Query": "data.builtin.kubernetes.KSV022.deny", "Resolution": "Do not set spec.containers[*].securityContext.capabilities.add and spec.initContainers[*].securityContext.capabilities.add.", "Severity": "MEDIUM", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv022", "References": ["https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline", "https://avd.aquasec.com/misconfig/ksv022"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 49, "EndLine": 86, "Code": {"Lines": [{"Number": 49, "Content": "        - image: nginx@sha256:aed492c4dc93d2d1f6fe9a49f00bc7e1863d950334a93facd8ca1317292bf6aa", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 50, "Content": "          imagePullPolicy: Always", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 51, "Content": "          livenessProbe:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 52, "Content": "            httpGet:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 53, "Content": "              path: /live", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 54, "Content": "              port: 8080", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 55, "Content": "          name: app", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 56, "Content": "          ports:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 57, "Content": "            - containerPort: 8080", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 58, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV106", "AVDID": "AVD-KSV-0106", "Title": "Container capabilities must only include NET_BIND_SERVICE", "Description": "Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.", "Message": "container should not add stuff", "Namespace": "builtin.kubernetes.KSV106", "Query": "data.builtin.kubernetes.KSV106.deny", "Resolution": "Set 'spec.containers[*].securityContext.capabilities.drop' to 'ALL' and only add 'NET_BIND_SERVICE' to 'spec.containers[*].securityContext.capabilities.add'.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv106", "References": ["https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted", "https://avd.aquasec.com/misconfig/ksv106"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 74, "EndLine": 77, "Code": {"Lines": [{"Number": 74, "Content": "              add:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 75, "Content": "                - NET_RAW", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 76, "Content": "              drop:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 77, "Content": "                - ALL", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "deployment pod-035-12-using-insecure-capability-net-raw in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 10, "EndLine": 10, "Code": {"Lines": [{"Number": 10, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "serviceaccount pod-035-12-using-insecure-capability-net-raw-dedicated-sa in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}, {"Type": "Kubernetes Security Check", "ID": "KSV119", "AVDID": "AVD-KSV-0119", "Title": "NET_RAW capability added", "Description": "The NET_RAW capability grants attackers the ability to eavesdrop on network traffic or generate IP traffic with falsified source addresses, posing serious security risks.", "Message": "container app of deployment pod-035-12-using-insecure-capability-net-raw in kalm-benchmark namespace should not include 'NET_RAW' in securityContext.capabilities.add", "Namespace": "builtin.kubernetes.KSV119", "Query": "data.builtin.kubernetes.KSV119.deny", "Resolution": "To mitigate potential security risks, it is strongly recommended to remove the NET_RAW capability from 'containers[].securityContext.capabilities.add'. It is advisable to follow the practice of dropping all capabilities and only adding the necessary ones.", "Severity": "HIGH", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv119", "References": ["https://kubernetes.io/docs/concepts/security/pod-security-standards/", "https://avd.aquasec.com/misconfig/ksv119"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 10, "EndLine": 10, "Code": {"Lines": [{"Number": 10, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}]}, {"Target": "pod-035-13-using-insecure-capability-perfmon.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 4, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV022", "AVDID": "AVD-KSV-0022", "Title": "Specific capabilities added", "Description": "According to pod security standard 'Capabilities', capabilities beyond the default set must not be added.", "Message": "Container 'app' of Deployment 'pod-035-13-using-insecure-capability-perfmon' should not set 'securityContext.capabilities.add'", "Namespace": "builtin.kubernetes.KSV022", "Query": "data.builtin.kubernetes.KSV022.deny", "Resolution": "Do not set spec.containers[*].securityContext.capabilities.add and spec.initContainers[*].securityContext.capabilities.add.", "Severity": "MEDIUM", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv022", "References": ["https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline", "https://avd.aquasec.com/misconfig/ksv022"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 49, "EndLine": 86, "Code": {"Lines": [{"Number": 49, "Content": "        - image: nginx@sha256:aed492c4dc93d2d1f6fe9a49f00bc7e1863d950334a93facd8ca1317292bf6aa", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 50, "Content": "          imagePullPolicy: Always", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 51, "Content": "          livenessProbe:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 52, "Content": "            httpGet:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 53, "Content": "              path: /live", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 54, "Content": "              port: 8080", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 55, "Content": "          name: app", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 56, "Content": "          ports:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 57, "Content": "            - containerPort: 8080", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 58, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV106", "AVDID": "AVD-KSV-0106", "Title": "Container capabilities must only include NET_BIND_SERVICE", "Description": "Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.", "Message": "container should not add stuff", "Namespace": "builtin.kubernetes.KSV106", "Query": "data.builtin.kubernetes.KSV106.deny", "Resolution": "Set 'spec.containers[*].securityContext.capabilities.drop' to 'ALL' and only add 'NET_BIND_SERVICE' to 'spec.containers[*].securityContext.capabilities.add'.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv106", "References": ["https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted", "https://avd.aquasec.com/misconfig/ksv106"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 74, "EndLine": 77, "Code": {"Lines": [{"Number": 74, "Content": "              add:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 75, "Content": "                - PERFMON", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 76, "Content": "              drop:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 77, "Content": "                - ALL", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "deployment pod-035-13-using-insecure-capability-perfmon in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 10, "EndLine": 10, "Code": {"Lines": [{"Number": 10, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "serviceaccount pod-035-13-using-insecure-capability-perfmon-dedicated-sa in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "pod-035-14-using-insecure-capability-setfcap.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 4, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV022", "AVDID": "AVD-KSV-0022", "Title": "Specific capabilities added", "Description": "According to pod security standard 'Capabilities', capabilities beyond the default set must not be added.", "Message": "Container 'app' of Deployment 'pod-035-14-using-insecure-capability-setfcap' should not set 'securityContext.capabilities.add'", "Namespace": "builtin.kubernetes.KSV022", "Query": "data.builtin.kubernetes.KSV022.deny", "Resolution": "Do not set spec.containers[*].securityContext.capabilities.add and spec.initContainers[*].securityContext.capabilities.add.", "Severity": "MEDIUM", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv022", "References": ["https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline", "https://avd.aquasec.com/misconfig/ksv022"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 49, "EndLine": 86, "Code": {"Lines": [{"Number": 49, "Content": "        - image: nginx@sha256:aed492c4dc93d2d1f6fe9a49f00bc7e1863d950334a93facd8ca1317292bf6aa", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 50, "Content": "          imagePullPolicy: Always", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 51, "Content": "          livenessProbe:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 52, "Content": "            httpGet:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 53, "Content": "              path: /live", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 54, "Content": "              port: 8080", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 55, "Content": "          name: app", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 56, "Content": "          ports:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 57, "Content": "            - containerPort: 8080", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 58, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV106", "AVDID": "AVD-KSV-0106", "Title": "Container capabilities must only include NET_BIND_SERVICE", "Description": "Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.", "Message": "container should not add stuff", "Namespace": "builtin.kubernetes.KSV106", "Query": "data.builtin.kubernetes.KSV106.deny", "Resolution": "Set 'spec.containers[*].securityContext.capabilities.drop' to 'ALL' and only add 'NET_BIND_SERVICE' to 'spec.containers[*].securityContext.capabilities.add'.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv106", "References": ["https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted", "https://avd.aquasec.com/misconfig/ksv106"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 74, "EndLine": 77, "Code": {"Lines": [{"Number": 74, "Content": "              add:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 75, "Content": "                - SETFCAP", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 76, "Content": "              drop:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 77, "Content": "                - ALL", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "deployment pod-035-14-using-insecure-capability-setfcap in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 10, "EndLine": 10, "Code": {"Lines": [{"Number": 10, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "serviceaccount pod-035-14-using-insecure-capability-setfcap-dedicated-sa in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "pod-035-15-using-insecure-capability-setgid.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 4, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV022", "AVDID": "AVD-KSV-0022", "Title": "Specific capabilities added", "Description": "According to pod security standard 'Capabilities', capabilities beyond the default set must not be added.", "Message": "Container 'app' of Deployment 'pod-035-15-using-insecure-capability-setgid' should not set 'securityContext.capabilities.add'", "Namespace": "builtin.kubernetes.KSV022", "Query": "data.builtin.kubernetes.KSV022.deny", "Resolution": "Do not set spec.containers[*].securityContext.capabilities.add and spec.initContainers[*].securityContext.capabilities.add.", "Severity": "MEDIUM", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv022", "References": ["https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline", "https://avd.aquasec.com/misconfig/ksv022"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 49, "EndLine": 86, "Code": {"Lines": [{"Number": 49, "Content": "        - image: nginx@sha256:aed492c4dc93d2d1f6fe9a49f00bc7e1863d950334a93facd8ca1317292bf6aa", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 50, "Content": "          imagePullPolicy: Always", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 51, "Content": "          livenessProbe:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 52, "Content": "            httpGet:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 53, "Content": "              path: /live", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 54, "Content": "              port: 8080", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 55, "Content": "          name: app", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 56, "Content": "          ports:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 57, "Content": "            - containerPort: 8080", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 58, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV106", "AVDID": "AVD-KSV-0106", "Title": "Container capabilities must only include NET_BIND_SERVICE", "Description": "Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.", "Message": "container should not add stuff", "Namespace": "builtin.kubernetes.KSV106", "Query": "data.builtin.kubernetes.KSV106.deny", "Resolution": "Set 'spec.containers[*].securityContext.capabilities.drop' to 'ALL' and only add 'NET_BIND_SERVICE' to 'spec.containers[*].securityContext.capabilities.add'.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv106", "References": ["https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted", "https://avd.aquasec.com/misconfig/ksv106"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 74, "EndLine": 77, "Code": {"Lines": [{"Number": 74, "Content": "              add:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 75, "Content": "                - SETGID", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 76, "Content": "              drop:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 77, "Content": "                - ALL", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "deployment pod-035-15-using-insecure-capability-setgid in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 10, "EndLine": 10, "Code": {"Lines": [{"Number": 10, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "serviceaccount pod-035-15-using-insecure-capability-setgid-dedicated-sa in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "pod-035-16-using-insecure-capability-setpcap.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 4, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV022", "AVDID": "AVD-KSV-0022", "Title": "Specific capabilities added", "Description": "According to pod security standard 'Capabilities', capabilities beyond the default set must not be added.", "Message": "Container 'app' of Deployment 'pod-035-16-using-insecure-capability-setpcap' should not set 'securityContext.capabilities.add'", "Namespace": "builtin.kubernetes.KSV022", "Query": "data.builtin.kubernetes.KSV022.deny", "Resolution": "Do not set spec.containers[*].securityContext.capabilities.add and spec.initContainers[*].securityContext.capabilities.add.", "Severity": "MEDIUM", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv022", "References": ["https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline", "https://avd.aquasec.com/misconfig/ksv022"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 49, "EndLine": 86, "Code": {"Lines": [{"Number": 49, "Content": "        - image: nginx@sha256:aed492c4dc93d2d1f6fe9a49f00bc7e1863d950334a93facd8ca1317292bf6aa", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 50, "Content": "          imagePullPolicy: Always", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 51, "Content": "          livenessProbe:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 52, "Content": "            httpGet:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 53, "Content": "              path: /live", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 54, "Content": "              port: 8080", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 55, "Content": "          name: app", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 56, "Content": "          ports:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 57, "Content": "            - containerPort: 8080", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 58, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV106", "AVDID": "AVD-KSV-0106", "Title": "Container capabilities must only include NET_BIND_SERVICE", "Description": "Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.", "Message": "container should not add stuff", "Namespace": "builtin.kubernetes.KSV106", "Query": "data.builtin.kubernetes.KSV106.deny", "Resolution": "Set 'spec.containers[*].securityContext.capabilities.drop' to 'ALL' and only add 'NET_BIND_SERVICE' to 'spec.containers[*].securityContext.capabilities.add'.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv106", "References": ["https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted", "https://avd.aquasec.com/misconfig/ksv106"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 74, "EndLine": 77, "Code": {"Lines": [{"Number": 74, "Content": "              add:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 75, "Content": "                - SETPCAP", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 76, "Content": "              drop:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 77, "Content": "                - ALL", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "deployment pod-035-16-using-insecure-capability-setpcap in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 10, "EndLine": 10, "Code": {"Lines": [{"Number": 10, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "serviceaccount pod-035-16-using-insecure-capability-setpcap-dedicated-sa in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "pod-035-17-using-insecure-capability-setuid.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 4, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV022", "AVDID": "AVD-KSV-0022", "Title": "Specific capabilities added", "Description": "According to pod security standard 'Capabilities', capabilities beyond the default set must not be added.", "Message": "Container 'app' of Deployment 'pod-035-17-using-insecure-capability-setuid' should not set 'securityContext.capabilities.add'", "Namespace": "builtin.kubernetes.KSV022", "Query": "data.builtin.kubernetes.KSV022.deny", "Resolution": "Do not set spec.containers[*].securityContext.capabilities.add and spec.initContainers[*].securityContext.capabilities.add.", "Severity": "MEDIUM", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv022", "References": ["https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline", "https://avd.aquasec.com/misconfig/ksv022"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 49, "EndLine": 86, "Code": {"Lines": [{"Number": 49, "Content": "        - image: nginx@sha256:aed492c4dc93d2d1f6fe9a49f00bc7e1863d950334a93facd8ca1317292bf6aa", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 50, "Content": "          imagePullPolicy: Always", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 51, "Content": "          livenessProbe:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 52, "Content": "            httpGet:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 53, "Content": "              path: /live", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 54, "Content": "              port: 8080", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 55, "Content": "          name: app", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 56, "Content": "          ports:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 57, "Content": "            - containerPort: 8080", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 58, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV106", "AVDID": "AVD-KSV-0106", "Title": "Container capabilities must only include NET_BIND_SERVICE", "Description": "Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.", "Message": "container should not add stuff", "Namespace": "builtin.kubernetes.KSV106", "Query": "data.builtin.kubernetes.KSV106.deny", "Resolution": "Set 'spec.containers[*].securityContext.capabilities.drop' to 'ALL' and only add 'NET_BIND_SERVICE' to 'spec.containers[*].securityContext.capabilities.add'.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv106", "References": ["https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted", "https://avd.aquasec.com/misconfig/ksv106"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 74, "EndLine": 77, "Code": {"Lines": [{"Number": 74, "Content": "              add:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 75, "Content": "                - SETUID", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 76, "Content": "              drop:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 77, "Content": "                - ALL", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "deployment pod-035-17-using-insecure-capability-setuid in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 10, "EndLine": 10, "Code": {"Lines": [{"Number": 10, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "serviceaccount pod-035-17-using-insecure-capability-setuid-dedicated-sa in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "pod-035-18-using-insecure-capability-sys-boot.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 4, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV022", "AVDID": "AVD-KSV-0022", "Title": "Specific capabilities added", "Description": "According to pod security standard 'Capabilities', capabilities beyond the default set must not be added.", "Message": "Container 'app' of Deployment 'pod-035-18-using-insecure-capability-sys-boot' should not set 'securityContext.capabilities.add'", "Namespace": "builtin.kubernetes.KSV022", "Query": "data.builtin.kubernetes.KSV022.deny", "Resolution": "Do not set spec.containers[*].securityContext.capabilities.add and spec.initContainers[*].securityContext.capabilities.add.", "Severity": "MEDIUM", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv022", "References": ["https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline", "https://avd.aquasec.com/misconfig/ksv022"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 49, "EndLine": 86, "Code": {"Lines": [{"Number": 49, "Content": "        - image: nginx@sha256:aed492c4dc93d2d1f6fe9a49f00bc7e1863d950334a93facd8ca1317292bf6aa", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 50, "Content": "          imagePullPolicy: Always", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 51, "Content": "          livenessProbe:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 52, "Content": "            httpGet:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 53, "Content": "              path: /live", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 54, "Content": "              port: 8080", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 55, "Content": "          name: app", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 56, "Content": "          ports:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 57, "Content": "            - containerPort: 8080", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 58, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV106", "AVDID": "AVD-KSV-0106", "Title": "Container capabilities must only include NET_BIND_SERVICE", "Description": "Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.", "Message": "container should not add stuff", "Namespace": "builtin.kubernetes.KSV106", "Query": "data.builtin.kubernetes.KSV106.deny", "Resolution": "Set 'spec.containers[*].securityContext.capabilities.drop' to 'ALL' and only add 'NET_BIND_SERVICE' to 'spec.containers[*].securityContext.capabilities.add'.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv106", "References": ["https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted", "https://avd.aquasec.com/misconfig/ksv106"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 74, "EndLine": 77, "Code": {"Lines": [{"Number": 74, "Content": "              add:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 75, "Content": "                - SYS_BOOT", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 76, "Content": "              drop:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 77, "Content": "                - ALL", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "deployment pod-035-18-using-insecure-capability-sys-boot in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 10, "EndLine": 10, "Code": {"Lines": [{"Number": 10, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "serviceaccount pod-035-18-using-insecure-capability-sys-boot-dedicated-sa in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "pod-035-19-using-insecure-capability-sys-chroot.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 4, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV022", "AVDID": "AVD-KSV-0022", "Title": "Specific capabilities added", "Description": "According to pod security standard 'Capabilities', capabilities beyond the default set must not be added.", "Message": "Container 'app' of Deployment 'pod-035-19-using-insecure-capability-sys-chroot' should not set 'securityContext.capabilities.add'", "Namespace": "builtin.kubernetes.KSV022", "Query": "data.builtin.kubernetes.KSV022.deny", "Resolution": "Do not set spec.containers[*].securityContext.capabilities.add and spec.initContainers[*].securityContext.capabilities.add.", "Severity": "MEDIUM", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv022", "References": ["https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline", "https://avd.aquasec.com/misconfig/ksv022"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 49, "EndLine": 86, "Code": {"Lines": [{"Number": 49, "Content": "        - image: nginx@sha256:aed492c4dc93d2d1f6fe9a49f00bc7e1863d950334a93facd8ca1317292bf6aa", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 50, "Content": "          imagePullPolicy: Always", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 51, "Content": "          livenessProbe:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 52, "Content": "            httpGet:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 53, "Content": "              path: /live", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 54, "Content": "              port: 8080", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 55, "Content": "          name: app", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 56, "Content": "          ports:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 57, "Content": "            - containerPort: 8080", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 58, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV106", "AVDID": "AVD-KSV-0106", "Title": "Container capabilities must only include NET_BIND_SERVICE", "Description": "Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.", "Message": "container should not add stuff", "Namespace": "builtin.kubernetes.KSV106", "Query": "data.builtin.kubernetes.KSV106.deny", "Resolution": "Set 'spec.containers[*].securityContext.capabilities.drop' to 'ALL' and only add 'NET_BIND_SERVICE' to 'spec.containers[*].securityContext.capabilities.add'.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv106", "References": ["https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted", "https://avd.aquasec.com/misconfig/ksv106"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 74, "EndLine": 77, "Code": {"Lines": [{"Number": 74, "Content": "              add:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 75, "Content": "                - SYS_CHROOT", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 76, "Content": "              drop:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 77, "Content": "                - ALL", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "deployment pod-035-19-using-insecure-capability-sys-chroot in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 10, "EndLine": 10, "Code": {"Lines": [{"Number": 10, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "serviceaccount pod-035-19-using-insecure-capability-sys-chroot-dedicated-sa in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "pod-035-2-using-insecure-capability-bpf.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 4, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV022", "AVDID": "AVD-KSV-0022", "Title": "Specific capabilities added", "Description": "According to pod security standard 'Capabilities', capabilities beyond the default set must not be added.", "Message": "Container 'app' of Deployment 'pod-035-2-using-insecure-capability-bpf' should not set 'securityContext.capabilities.add'", "Namespace": "builtin.kubernetes.KSV022", "Query": "data.builtin.kubernetes.KSV022.deny", "Resolution": "Do not set spec.containers[*].securityContext.capabilities.add and spec.initContainers[*].securityContext.capabilities.add.", "Severity": "MEDIUM", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv022", "References": ["https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline", "https://avd.aquasec.com/misconfig/ksv022"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 49, "EndLine": 86, "Code": {"Lines": [{"Number": 49, "Content": "        - image: nginx@sha256:aed492c4dc93d2d1f6fe9a49f00bc7e1863d950334a93facd8ca1317292bf6aa", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 50, "Content": "          imagePullPolicy: Always", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 51, "Content": "          livenessProbe:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 52, "Content": "            httpGet:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 53, "Content": "              path: /live", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 54, "Content": "              port: 8080", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 55, "Content": "          name: app", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 56, "Content": "          ports:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 57, "Content": "            - containerPort: 8080", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 58, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV106", "AVDID": "AVD-KSV-0106", "Title": "Container capabilities must only include NET_BIND_SERVICE", "Description": "Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.", "Message": "container should not add stuff", "Namespace": "builtin.kubernetes.KSV106", "Query": "data.builtin.kubernetes.KSV106.deny", "Resolution": "Set 'spec.containers[*].securityContext.capabilities.drop' to 'ALL' and only add 'NET_BIND_SERVICE' to 'spec.containers[*].securityContext.capabilities.add'.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv106", "References": ["https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted", "https://avd.aquasec.com/misconfig/ksv106"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 74, "EndLine": 77, "Code": {"Lines": [{"Number": 74, "Content": "              add:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 75, "Content": "                - BPF", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 76, "Content": "              drop:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 77, "Content": "                - ALL", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "deployment pod-035-2-using-insecure-capability-bpf in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 10, "EndLine": 10, "Code": {"Lines": [{"Number": 10, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "serviceaccount pod-035-2-using-insecure-capability-bpf-dedicated-sa in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "pod-035-20-using-insecure-capability-sys-module.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 5, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV022", "AVDID": "AVD-KSV-0022", "Title": "Specific capabilities added", "Description": "According to pod security standard 'Capabilities', capabilities beyond the default set must not be added.", "Message": "Container 'app' of Deployment 'pod-035-20-using-insecure-capability-sys-module' should not set 'securityContext.capabilities.add'", "Namespace": "builtin.kubernetes.KSV022", "Query": "data.builtin.kubernetes.KSV022.deny", "Resolution": "Do not set spec.containers[*].securityContext.capabilities.add and spec.initContainers[*].securityContext.capabilities.add.", "Severity": "MEDIUM", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv022", "References": ["https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline", "https://avd.aquasec.com/misconfig/ksv022"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 49, "EndLine": 86, "Code": {"Lines": [{"Number": 49, "Content": "        - image: nginx@sha256:aed492c4dc93d2d1f6fe9a49f00bc7e1863d950334a93facd8ca1317292bf6aa", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 50, "Content": "          imagePullPolicy: Always", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 51, "Content": "          livenessProbe:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 52, "Content": "            httpGet:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 53, "Content": "              path: /live", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 54, "Content": "              port: 8080", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 55, "Content": "          name: app", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 56, "Content": "          ports:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 57, "Content": "            - containerPort: 8080", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 58, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV106", "AVDID": "AVD-KSV-0106", "Title": "Container capabilities must only include NET_BIND_SERVICE", "Description": "Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.", "Message": "container should not add stuff", "Namespace": "builtin.kubernetes.KSV106", "Query": "data.builtin.kubernetes.KSV106.deny", "Resolution": "Set 'spec.containers[*].securityContext.capabilities.drop' to 'ALL' and only add 'NET_BIND_SERVICE' to 'spec.containers[*].securityContext.capabilities.add'.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv106", "References": ["https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted", "https://avd.aquasec.com/misconfig/ksv106"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 74, "EndLine": 77, "Code": {"Lines": [{"Number": 74, "Content": "              add:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 75, "Content": "                - SYS_MODULE", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 76, "Content": "              drop:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 77, "Content": "                - ALL", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "deployment pod-035-20-using-insecure-capability-sys-module in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 10, "EndLine": 10, "Code": {"Lines": [{"Number": 10, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "serviceaccount pod-035-20-using-insecure-capability-sys-module-dedicated-sa in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}, {"Type": "Kubernetes Security Check", "ID": "KSV120", "AVDID": "AVD-KSV-0120", "Title": "SYS_MODULE capability added", "Description": "The SYS_MODULE capability grants attackers the ability to install and remove kernel modules, posing serious security risks.", "Message": "container {\"__defsec_metadata\": {\"endline\": 76, \"filepath\": \"pod-035-20-using-insecure-capability-sys-module.yaml\", \"offset\": 0, \"startline\": 39}, \"image\": \"nginx@sha256:aed492c4dc93d2d1f6fe9a49f00bc7e1863d950334a93facd8ca1317292bf6aa\", \"imagePullPolicy\": \"Always\", \"livenessProbe\": {\"__defsec_metadata\": {\"endline\": 44, \"filepath\": \"pod-035-20-using-insecure-capability-sys-module.yaml\", \"offset\": 0, \"startline\": 42}, \"httpGet\": {\"__defsec_metadata\": {\"endline\": 44, \"filepath\": \"pod-035-20-using-insecure-capability-sys-module.yaml\", \"offset\": 0, \"startline\": 43}, \"path\": \"/live\", \"port\": 8080}}, \"name\": \"app\", \"ports\": [{\"__defsec_metadata\": {\"endline\": 47, \"filepath\": \"pod-035-20-using-insecure-capability-sys-module.yaml\", \"offset\": 0, \"startline\": 47}, \"containerPort\": 8080}], \"readinessProbe\": {\"__defsec_metadata\": {\"endline\": 51, \"filepath\": \"pod-035-20-using-insecure-capability-sys-module.yaml\", \"offset\": 0, \"startline\": 49}, \"httpGet\": {\"__defsec_metadata\": {\"endline\": 51, \"filepath\": \"pod-035-20-using-insecure-capability-sys-module.yaml\", \"offset\": 0, \"startline\": 50}, \"path\": \"/ready\", \"port\": 8080}}, \"resources\": {\"__defsec_metadata\": {\"endline\": 60, \"filepath\": \"pod-035-20-using-insecure-capability-sys-module.yaml\", \"offset\": 0, \"startline\": 53}, \"limits\": {\"__defsec_metadata\": {\"endline\": 56, \"filepath\": \"pod-035-20-using-insecure-capability-sys-module.yaml\", \"offset\": 0, \"startline\": 54}, \"cpu\": \"1m\", \"ephemeral-storage\": \"1Mi\", \"memory\": \"1Mi\"}, \"requests\": {\"__defsec_metadata\": {\"endline\": 60, \"filepath\": \"pod-035-20-using-insecure-capability-sys-module.yaml\", \"offset\": 0, \"startline\": 58}, \"cpu\": \"1m\", \"ephemeral-storage\": \"1Mi\", \"memory\": \"1Mi\"}}, \"securityContext\": {\"__defsec_metadata\": {\"endline\": 76, \"filepath\": \"pod-035-20-using-insecure-capability-sys-module.yaml\", \"offset\": 0, \"startline\": 62}, \"allowPrivilegeEscalation\": false, \"capabilities\": {\"__defsec_metadata\": {\"endline\": 67, \"filepath\": \"pod-035-20-using-insecure-capability-sys-module.yaml\", \"offset\": 0, \"startline\": 64}, \"add\": [\"SYS_MODULE\"], \"drop\": [\"ALL\"]}, \"privileged\": false, \"readOnlyRootFilesystem\": true, \"runAsGroup\": 31337, \"runAsNonRoot\": true, \"runAsUser\": 31337, \"seLinuxOptions\": {\"__defsec_metadata\": {\"endline\": 74, \"filepath\": \"pod-035-20-using-insecure-capability-sys-module.yaml\", \"offset\": 0, \"startline\": 74}, \"level\": \"s0:c123,c456\"}, \"seccompProfile\": {\"__defsec_metadata\": {\"endline\": 76, \"filepath\": \"pod-035-20-using-insecure-capability-sys-module.yaml\", \"offset\": 0, \"startline\": 76}, \"type\": \"RuntimeDefault\"}}} of deployment pod-035-20-using-insecure-capability-sys-module in kalm-benchmark namespace should not include 'SYS_MODULE' in securityContext.capabilities.add", "Namespace": "builtin.kubernetes.KSV120", "Query": "data.builtin.kubernetes.KSV120.deny", "Resolution": "To mitigate potential security risks, it is strongly recommended to remove the SYS_MODULE capability from 'containers[].securityContext.capabilities.add'. It is advisable to follow the practice of dropping all capabilities and only adding the necessary ones.", "Severity": "HIGH", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv120", "References": ["https://kubernetes.io/docs/tasks/configure-pod-container/security-context/", "https://avd.aquasec.com/misconfig/ksv120"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 49, "EndLine": 86, "Code": {"Lines": [{"Number": 49, "Content": "        - image: nginx@sha256:aed492c4dc93d2d1f6fe9a49f00bc7e1863d950334a93facd8ca1317292bf6aa", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 50, "Content": "          imagePullPolicy: Always", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 51, "Content": "          livenessProbe:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 52, "Content": "            httpGet:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 53, "Content": "              path: /live", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 54, "Content": "              port: 8080", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 55, "Content": "          name: app", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 56, "Content": "          ports:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 57, "Content": "            - containerPort: 8080", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 58, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}]}, {"Target": "pod-035-21-using-insecure-capability-sys-rawio.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 4, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV022", "AVDID": "AVD-KSV-0022", "Title": "Specific capabilities added", "Description": "According to pod security standard 'Capabilities', capabilities beyond the default set must not be added.", "Message": "Container 'app' of Deployment 'pod-035-21-using-insecure-capability-sys-rawio' should not set 'securityContext.capabilities.add'", "Namespace": "builtin.kubernetes.KSV022", "Query": "data.builtin.kubernetes.KSV022.deny", "Resolution": "Do not set spec.containers[*].securityContext.capabilities.add and spec.initContainers[*].securityContext.capabilities.add.", "Severity": "MEDIUM", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv022", "References": ["https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline", "https://avd.aquasec.com/misconfig/ksv022"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 49, "EndLine": 86, "Code": {"Lines": [{"Number": 49, "Content": "        - image: nginx@sha256:aed492c4dc93d2d1f6fe9a49f00bc7e1863d950334a93facd8ca1317292bf6aa", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 50, "Content": "          imagePullPolicy: Always", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 51, "Content": "          livenessProbe:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 52, "Content": "            httpGet:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 53, "Content": "              path: /live", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 54, "Content": "              port: 8080", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 55, "Content": "          name: app", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 56, "Content": "          ports:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 57, "Content": "            - containerPort: 8080", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 58, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV106", "AVDID": "AVD-KSV-0106", "Title": "Container capabilities must only include NET_BIND_SERVICE", "Description": "Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.", "Message": "container should not add stuff", "Namespace": "builtin.kubernetes.KSV106", "Query": "data.builtin.kubernetes.KSV106.deny", "Resolution": "Set 'spec.containers[*].securityContext.capabilities.drop' to 'ALL' and only add 'NET_BIND_SERVICE' to 'spec.containers[*].securityContext.capabilities.add'.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv106", "References": ["https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted", "https://avd.aquasec.com/misconfig/ksv106"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 74, "EndLine": 77, "Code": {"Lines": [{"Number": 74, "Content": "              add:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 75, "Content": "                - SYS_RAWIO", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 76, "Content": "              drop:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 77, "Content": "                - ALL", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "deployment pod-035-21-using-insecure-capability-sys-rawio in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 10, "EndLine": 10, "Code": {"Lines": [{"Number": 10, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "serviceaccount pod-035-21-using-insecure-capability-sys-rawio-dedicated-sa in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "pod-035-22-using-insecure-capability-sys-ptrace.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 4, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV022", "AVDID": "AVD-KSV-0022", "Title": "Specific capabilities added", "Description": "According to pod security standard 'Capabilities', capabilities beyond the default set must not be added.", "Message": "Container 'app' of Deployment 'pod-035-22-using-insecure-capability-sys-ptrace' should not set 'securityContext.capabilities.add'", "Namespace": "builtin.kubernetes.KSV022", "Query": "data.builtin.kubernetes.KSV022.deny", "Resolution": "Do not set spec.containers[*].securityContext.capabilities.add and spec.initContainers[*].securityContext.capabilities.add.", "Severity": "MEDIUM", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv022", "References": ["https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline", "https://avd.aquasec.com/misconfig/ksv022"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 49, "EndLine": 86, "Code": {"Lines": [{"Number": 49, "Content": "        - image: nginx@sha256:aed492c4dc93d2d1f6fe9a49f00bc7e1863d950334a93facd8ca1317292bf6aa", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 50, "Content": "          imagePullPolicy: Always", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 51, "Content": "          livenessProbe:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 52, "Content": "            httpGet:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 53, "Content": "              path: /live", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 54, "Content": "              port: 8080", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 55, "Content": "          name: app", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 56, "Content": "          ports:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 57, "Content": "            - containerPort: 8080", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 58, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV106", "AVDID": "AVD-KSV-0106", "Title": "Container capabilities must only include NET_BIND_SERVICE", "Description": "Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.", "Message": "container should not add stuff", "Namespace": "builtin.kubernetes.KSV106", "Query": "data.builtin.kubernetes.KSV106.deny", "Resolution": "Set 'spec.containers[*].securityContext.capabilities.drop' to 'ALL' and only add 'NET_BIND_SERVICE' to 'spec.containers[*].securityContext.capabilities.add'.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv106", "References": ["https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted", "https://avd.aquasec.com/misconfig/ksv106"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 74, "EndLine": 77, "Code": {"Lines": [{"Number": 74, "Content": "              add:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 75, "Content": "                - SYS_PTRACE", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 76, "Content": "              drop:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 77, "Content": "                - ALL", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "deployment pod-035-22-using-insecure-capability-sys-ptrace in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 10, "EndLine": 10, "Code": {"Lines": [{"Number": 10, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "serviceaccount pod-035-22-using-insecure-capability-sys-ptrace-dedicated-sa in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "pod-035-3-using-insecure-capability-chown.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 4, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV022", "AVDID": "AVD-KSV-0022", "Title": "Specific capabilities added", "Description": "According to pod security standard 'Capabilities', capabilities beyond the default set must not be added.", "Message": "Container 'app' of Deployment 'pod-035-3-using-insecure-capability-chown' should not set 'securityContext.capabilities.add'", "Namespace": "builtin.kubernetes.KSV022", "Query": "data.builtin.kubernetes.KSV022.deny", "Resolution": "Do not set spec.containers[*].securityContext.capabilities.add and spec.initContainers[*].securityContext.capabilities.add.", "Severity": "MEDIUM", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv022", "References": ["https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline", "https://avd.aquasec.com/misconfig/ksv022"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 49, "EndLine": 86, "Code": {"Lines": [{"Number": 49, "Content": "        - image: nginx@sha256:aed492c4dc93d2d1f6fe9a49f00bc7e1863d950334a93facd8ca1317292bf6aa", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 50, "Content": "          imagePullPolicy: Always", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 51, "Content": "          livenessProbe:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 52, "Content": "            httpGet:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 53, "Content": "              path: /live", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 54, "Content": "              port: 8080", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 55, "Content": "          name: app", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 56, "Content": "          ports:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 57, "Content": "            - containerPort: 8080", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 58, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV106", "AVDID": "AVD-KSV-0106", "Title": "Container capabilities must only include NET_BIND_SERVICE", "Description": "Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.", "Message": "container should not add stuff", "Namespace": "builtin.kubernetes.KSV106", "Query": "data.builtin.kubernetes.KSV106.deny", "Resolution": "Set 'spec.containers[*].securityContext.capabilities.drop' to 'ALL' and only add 'NET_BIND_SERVICE' to 'spec.containers[*].securityContext.capabilities.add'.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv106", "References": ["https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted", "https://avd.aquasec.com/misconfig/ksv106"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 74, "EndLine": 77, "Code": {"Lines": [{"Number": 74, "Content": "              add:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 75, "Content": "                - CHOWN", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 76, "Content": "              drop:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 77, "Content": "                - ALL", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "deployment pod-035-3-using-insecure-capability-chown in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 10, "EndLine": 10, "Code": {"Lines": [{"Number": 10, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "serviceaccount pod-035-3-using-insecure-capability-chown-dedicated-sa in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "pod-035-4-using-insecure-capability-dac-overrides.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 4, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV022", "AVDID": "AVD-KSV-0022", "Title": "Specific capabilities added", "Description": "According to pod security standard 'Capabilities', capabilities beyond the default set must not be added.", "Message": "Container 'app' of Deployment 'pod-035-4-using-insecure-capability-dac-overrides' should not set 'securityContext.capabilities.add'", "Namespace": "builtin.kubernetes.KSV022", "Query": "data.builtin.kubernetes.KSV022.deny", "Resolution": "Do not set spec.containers[*].securityContext.capabilities.add and spec.initContainers[*].securityContext.capabilities.add.", "Severity": "MEDIUM", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv022", "References": ["https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline", "https://avd.aquasec.com/misconfig/ksv022"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 49, "EndLine": 86, "Code": {"Lines": [{"Number": 49, "Content": "        - image: nginx@sha256:aed492c4dc93d2d1f6fe9a49f00bc7e1863d950334a93facd8ca1317292bf6aa", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 50, "Content": "          imagePullPolicy: Always", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 51, "Content": "          livenessProbe:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 52, "Content": "            httpGet:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 53, "Content": "              path: /live", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 54, "Content": "              port: 8080", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 55, "Content": "          name: app", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 56, "Content": "          ports:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 57, "Content": "            - containerPort: 8080", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 58, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV106", "AVDID": "AVD-KSV-0106", "Title": "Container capabilities must only include NET_BIND_SERVICE", "Description": "Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.", "Message": "container should not add stuff", "Namespace": "builtin.kubernetes.KSV106", "Query": "data.builtin.kubernetes.KSV106.deny", "Resolution": "Set 'spec.containers[*].securityContext.capabilities.drop' to 'ALL' and only add 'NET_BIND_SERVICE' to 'spec.containers[*].securityContext.capabilities.add'.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv106", "References": ["https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted", "https://avd.aquasec.com/misconfig/ksv106"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 74, "EndLine": 77, "Code": {"Lines": [{"Number": 74, "Content": "              add:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 75, "Content": "                - DAC_OVERRIDES", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 76, "Content": "              drop:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 77, "Content": "                - ALL", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "deployment pod-035-4-using-insecure-capability-dac-overrides in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 10, "EndLine": 10, "Code": {"Lines": [{"Number": 10, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "serviceaccount pod-035-4-using-insecure-capability-dac-overrides-dedicated-sa in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "pod-035-5-using-insecure-capability-fowner.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 4, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV022", "AVDID": "AVD-KSV-0022", "Title": "Specific capabilities added", "Description": "According to pod security standard 'Capabilities', capabilities beyond the default set must not be added.", "Message": "Container 'app' of Deployment 'pod-035-5-using-insecure-capability-fowner' should not set 'securityContext.capabilities.add'", "Namespace": "builtin.kubernetes.KSV022", "Query": "data.builtin.kubernetes.KSV022.deny", "Resolution": "Do not set spec.containers[*].securityContext.capabilities.add and spec.initContainers[*].securityContext.capabilities.add.", "Severity": "MEDIUM", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv022", "References": ["https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline", "https://avd.aquasec.com/misconfig/ksv022"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 49, "EndLine": 86, "Code": {"Lines": [{"Number": 49, "Content": "        - image: nginx@sha256:aed492c4dc93d2d1f6fe9a49f00bc7e1863d950334a93facd8ca1317292bf6aa", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 50, "Content": "          imagePullPolicy: Always", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 51, "Content": "          livenessProbe:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 52, "Content": "            httpGet:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 53, "Content": "              path: /live", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 54, "Content": "              port: 8080", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 55, "Content": "          name: app", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 56, "Content": "          ports:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 57, "Content": "            - containerPort: 8080", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 58, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV106", "AVDID": "AVD-KSV-0106", "Title": "Container capabilities must only include NET_BIND_SERVICE", "Description": "Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.", "Message": "container should not add stuff", "Namespace": "builtin.kubernetes.KSV106", "Query": "data.builtin.kubernetes.KSV106.deny", "Resolution": "Set 'spec.containers[*].securityContext.capabilities.drop' to 'ALL' and only add 'NET_BIND_SERVICE' to 'spec.containers[*].securityContext.capabilities.add'.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv106", "References": ["https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted", "https://avd.aquasec.com/misconfig/ksv106"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 74, "EndLine": 77, "Code": {"Lines": [{"Number": 74, "Content": "              add:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 75, "Content": "                - FOWNER", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 76, "Content": "              drop:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 77, "Content": "                - ALL", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "deployment pod-035-5-using-insecure-capability-fowner in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 10, "EndLine": 10, "Code": {"Lines": [{"Number": 10, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "serviceaccount pod-035-5-using-insecure-capability-fowner-dedicated-sa in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "pod-035-6-using-insecure-capability-fsetid.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 4, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV022", "AVDID": "AVD-KSV-0022", "Title": "Specific capabilities added", "Description": "According to pod security standard 'Capabilities', capabilities beyond the default set must not be added.", "Message": "Container 'app' of Deployment 'pod-035-6-using-insecure-capability-fsetid' should not set 'securityContext.capabilities.add'", "Namespace": "builtin.kubernetes.KSV022", "Query": "data.builtin.kubernetes.KSV022.deny", "Resolution": "Do not set spec.containers[*].securityContext.capabilities.add and spec.initContainers[*].securityContext.capabilities.add.", "Severity": "MEDIUM", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv022", "References": ["https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline", "https://avd.aquasec.com/misconfig/ksv022"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 49, "EndLine": 86, "Code": {"Lines": [{"Number": 49, "Content": "        - image: nginx@sha256:aed492c4dc93d2d1f6fe9a49f00bc7e1863d950334a93facd8ca1317292bf6aa", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 50, "Content": "          imagePullPolicy: Always", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 51, "Content": "          livenessProbe:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 52, "Content": "            httpGet:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 53, "Content": "              path: /live", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 54, "Content": "              port: 8080", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 55, "Content": "          name: app", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 56, "Content": "          ports:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 57, "Content": "            - containerPort: 8080", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 58, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV106", "AVDID": "AVD-KSV-0106", "Title": "Container capabilities must only include NET_BIND_SERVICE", "Description": "Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.", "Message": "container should not add stuff", "Namespace": "builtin.kubernetes.KSV106", "Query": "data.builtin.kubernetes.KSV106.deny", "Resolution": "Set 'spec.containers[*].securityContext.capabilities.drop' to 'ALL' and only add 'NET_BIND_SERVICE' to 'spec.containers[*].securityContext.capabilities.add'.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv106", "References": ["https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted", "https://avd.aquasec.com/misconfig/ksv106"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 74, "EndLine": 77, "Code": {"Lines": [{"Number": 74, "Content": "              add:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 75, "Content": "                - FSETID", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 76, "Content": "              drop:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 77, "Content": "                - ALL", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "deployment pod-035-6-using-insecure-capability-fsetid in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 10, "EndLine": 10, "Code": {"Lines": [{"Number": 10, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "serviceaccount pod-035-6-using-insecure-capability-fsetid-dedicated-sa in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "pod-035-7-using-insecure-capability-kill.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 4, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV022", "AVDID": "AVD-KSV-0022", "Title": "Specific capabilities added", "Description": "According to pod security standard 'Capabilities', capabilities beyond the default set must not be added.", "Message": "Container 'app' of Deployment 'pod-035-7-using-insecure-capability-kill' should not set 'securityContext.capabilities.add'", "Namespace": "builtin.kubernetes.KSV022", "Query": "data.builtin.kubernetes.KSV022.deny", "Resolution": "Do not set spec.containers[*].securityContext.capabilities.add and spec.initContainers[*].securityContext.capabilities.add.", "Severity": "MEDIUM", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv022", "References": ["https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline", "https://avd.aquasec.com/misconfig/ksv022"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 49, "EndLine": 86, "Code": {"Lines": [{"Number": 49, "Content": "        - image: nginx@sha256:aed492c4dc93d2d1f6fe9a49f00bc7e1863d950334a93facd8ca1317292bf6aa", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 50, "Content": "          imagePullPolicy: Always", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 51, "Content": "          livenessProbe:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 52, "Content": "            httpGet:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 53, "Content": "              path: /live", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 54, "Content": "              port: 8080", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 55, "Content": "          name: app", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 56, "Content": "          ports:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 57, "Content": "            - containerPort: 8080", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 58, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV106", "AVDID": "AVD-KSV-0106", "Title": "Container capabilities must only include NET_BIND_SERVICE", "Description": "Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.", "Message": "container should not add stuff", "Namespace": "builtin.kubernetes.KSV106", "Query": "data.builtin.kubernetes.KSV106.deny", "Resolution": "Set 'spec.containers[*].securityContext.capabilities.drop' to 'ALL' and only add 'NET_BIND_SERVICE' to 'spec.containers[*].securityContext.capabilities.add'.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv106", "References": ["https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted", "https://avd.aquasec.com/misconfig/ksv106"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 74, "EndLine": 77, "Code": {"Lines": [{"Number": 74, "Content": "              add:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 75, "Content": "                - KILL", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 76, "Content": "              drop:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 77, "Content": "                - ALL", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "deployment pod-035-7-using-insecure-capability-kill in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 10, "EndLine": 10, "Code": {"Lines": [{"Number": 10, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "serviceaccount pod-035-7-using-insecure-capability-kill-dedicated-sa in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "pod-035-8-using-insecure-capability-mac-override.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 4, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV022", "AVDID": "AVD-KSV-0022", "Title": "Specific capabilities added", "Description": "According to pod security standard 'Capabilities', capabilities beyond the default set must not be added.", "Message": "Container 'app' of Deployment 'pod-035-8-using-insecure-capability-mac-override' should not set 'securityContext.capabilities.add'", "Namespace": "builtin.kubernetes.KSV022", "Query": "data.builtin.kubernetes.KSV022.deny", "Resolution": "Do not set spec.containers[*].securityContext.capabilities.add and spec.initContainers[*].securityContext.capabilities.add.", "Severity": "MEDIUM", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv022", "References": ["https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline", "https://avd.aquasec.com/misconfig/ksv022"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 49, "EndLine": 86, "Code": {"Lines": [{"Number": 49, "Content": "        - image: nginx@sha256:aed492c4dc93d2d1f6fe9a49f00bc7e1863d950334a93facd8ca1317292bf6aa", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 50, "Content": "          imagePullPolicy: Always", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 51, "Content": "          livenessProbe:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 52, "Content": "            httpGet:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 53, "Content": "              path: /live", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 54, "Content": "              port: 8080", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 55, "Content": "          name: app", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 56, "Content": "          ports:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 57, "Content": "            - containerPort: 8080", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 58, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV106", "AVDID": "AVD-KSV-0106", "Title": "Container capabilities must only include NET_BIND_SERVICE", "Description": "Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.", "Message": "container should not add stuff", "Namespace": "builtin.kubernetes.KSV106", "Query": "data.builtin.kubernetes.KSV106.deny", "Resolution": "Set 'spec.containers[*].securityContext.capabilities.drop' to 'ALL' and only add 'NET_BIND_SERVICE' to 'spec.containers[*].securityContext.capabilities.add'.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv106", "References": ["https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted", "https://avd.aquasec.com/misconfig/ksv106"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 74, "EndLine": 77, "Code": {"Lines": [{"Number": 74, "Content": "              add:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 75, "Content": "                - MAC_OVERRIDE", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 76, "Content": "              drop:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 77, "Content": "                - ALL", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "deployment pod-035-8-using-insecure-capability-mac-override in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 10, "EndLine": 10, "Code": {"Lines": [{"Number": 10, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "serviceaccount pod-035-8-using-insecure-capability-mac-override-dedicated-sa in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "pod-035-9-using-insecure-capability-mac-admin.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 4, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV022", "AVDID": "AVD-KSV-0022", "Title": "Specific capabilities added", "Description": "According to pod security standard 'Capabilities', capabilities beyond the default set must not be added.", "Message": "Container 'app' of Deployment 'pod-035-9-using-insecure-capability-mac-admin' should not set 'securityContext.capabilities.add'", "Namespace": "builtin.kubernetes.KSV022", "Query": "data.builtin.kubernetes.KSV022.deny", "Resolution": "Do not set spec.containers[*].securityContext.capabilities.add and spec.initContainers[*].securityContext.capabilities.add.", "Severity": "MEDIUM", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv022", "References": ["https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline", "https://avd.aquasec.com/misconfig/ksv022"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 49, "EndLine": 86, "Code": {"Lines": [{"Number": 49, "Content": "        - image: nginx@sha256:aed492c4dc93d2d1f6fe9a49f00bc7e1863d950334a93facd8ca1317292bf6aa", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 50, "Content": "          imagePullPolicy: Always", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 51, "Content": "          livenessProbe:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 52, "Content": "            httpGet:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 53, "Content": "              path: /live", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 54, "Content": "              port: 8080", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 55, "Content": "          name: app", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 56, "Content": "          ports:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 57, "Content": "            - containerPort: 8080", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 58, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV106", "AVDID": "AVD-KSV-0106", "Title": "Container capabilities must only include NET_BIND_SERVICE", "Description": "Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.", "Message": "container should not add stuff", "Namespace": "builtin.kubernetes.KSV106", "Query": "data.builtin.kubernetes.KSV106.deny", "Resolution": "Set 'spec.containers[*].securityContext.capabilities.drop' to 'ALL' and only add 'NET_BIND_SERVICE' to 'spec.containers[*].securityContext.capabilities.add'.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv106", "References": ["https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted", "https://avd.aquasec.com/misconfig/ksv106"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 74, "EndLine": 77, "Code": {"Lines": [{"Number": 74, "Content": "              add:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 75, "Content": "                - MAC_ADMIN", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 76, "Content": "              drop:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 77, "Content": "                - ALL", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "deployment pod-035-9-using-insecure-capability-mac-admin in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 10, "EndLine": 10, "Code": {"Lines": [{"Number": 10, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "serviceaccount pod-035-9-using-insecure-capability-mac-admin-dedicated-sa in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "pod-036-keep-default-capabilities.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 4, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV003", "AVDID": "AVD-KSV-0003", "Title": "Default capabilities: some containers do not drop all", "Description": "The container should drop all default capabilities and add only those that are needed for its execution.", "Message": "Container 'app' of Deployment 'pod-036-keep-default-capabilities' should add 'ALL' to 'securityContext.capabilities.drop'", "Namespace": "builtin.kubernetes.KSV003", "Query": "data.builtin.kubernetes.KSV003.deny", "Resolution": "Add 'ALL' to containers[].securityContext.capabilities.drop.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv003", "References": ["https://kubesec.io/basics/containers-securitycontext-capabilities-drop-index-all/", "https://avd.aquasec.com/misconfig/ksv003"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 49, "EndLine": 82, "Code": {"Lines": [{"Number": 49, "Content": "        - image: nginx@sha256:aed492c4dc93d2d1f6fe9a49f00bc7e1863d950334a93facd8ca1317292bf6aa", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 50, "Content": "          imagePullPolicy: Always", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 51, "Content": "          livenessProbe:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 52, "Content": "            httpGet:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 53, "Content": "              path: /live", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 54, "Content": "              port: 8080", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 55, "Content": "          name: app", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 56, "Content": "          ports:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 57, "Content": "            - containerPort: 8080", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 58, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV106", "AVDID": "AVD-KSV-0106", "Title": "Container capabilities must only include NET_BIND_SERVICE", "Description": "Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.", "Message": "container should drop all", "Namespace": "builtin.kubernetes.KSV106", "Query": "data.builtin.kubernetes.KSV106.deny", "Resolution": "Set 'spec.containers[*].securityContext.capabilities.drop' to 'ALL' and only add 'NET_BIND_SERVICE' to 'spec.containers[*].securityContext.capabilities.add'.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv106", "References": ["https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted", "https://avd.aquasec.com/misconfig/ksv106"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 49, "EndLine": 82, "Code": {"Lines": [{"Number": 49, "Content": "        - image: nginx@sha256:aed492c4dc93d2d1f6fe9a49f00bc7e1863d950334a93facd8ca1317292bf6aa", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 50, "Content": "          imagePullPolicy: Always", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 51, "Content": "          livenessProbe:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 52, "Content": "            httpGet:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 53, "Content": "              path: /live", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 54, "Content": "              port: 8080", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 55, "Content": "          name: app", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 56, "Content": "          ports:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 57, "Content": "            - containerPort: 8080", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 58, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "deployment pod-036-keep-default-capabilities in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 10, "EndLine": 10, "Code": {"Lines": [{"Number": 10, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "serviceaccount pod-036-keep-default-capabilities-dedicated-sa in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "pod-042-1-volume-with-read-only-hostpath.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 3, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV023", "AVDID": "AVD-KSV-0023", "Title": "hostPath volumes mounted", "Description": "According to pod security standard 'HostPath Volumes', HostPath volumes must be forbidden.", "Message": "Deployment 'pod-042-1-volume-with-read-only-hostpath' should not set 'spec.template.volumes.hostPath'", "Namespace": "builtin.kubernetes.KSV023", "Query": "data.builtin.kubernetes.KSV023.deny", "Resolution": "Do not set 'spec.volumes[*].hostPath'.", "Severity": "MEDIUM", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv023", "References": ["https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline", "https://avd.aquasec.com/misconfig/ksv023"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 24, "EndLine": 107, "Code": {"Lines": [{"Number": 24, "Content": "  replicas: 1", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 25, "Content": "  selector:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 26, "Content": "    matchLabels:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 27, "Content": "      app.kubernetes.io/part-of: kalm-benchmark", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 28, "Content": "      check: POD-042-1", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 29, "Content": "  template:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 30, "Content": "    metadata:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 31, "Content": "      annotations:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 32, "Content": "        container.apparmor.security.beta.kubernetes.io/app: runtime/default", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 33, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "deployment pod-042-1-volume-with-read-only-hostpath in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 10, "EndLine": 10, "Code": {"Lines": [{"Number": 10, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "serviceaccount pod-042-1-volume-with-read-only-hostpath-dedicated-sa in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "pod-042-2-volume-with-writeable-hostpath.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 3, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV023", "AVDID": "AVD-KSV-0023", "Title": "hostPath volumes mounted", "Description": "According to pod security standard 'HostPath Volumes', HostPath volumes must be forbidden.", "Message": "Deployment 'pod-042-2-volume-with-writeable-hostpath' should not set 'spec.template.volumes.hostPath'", "Namespace": "builtin.kubernetes.KSV023", "Query": "data.builtin.kubernetes.KSV023.deny", "Resolution": "Do not set 'spec.volumes[*].hostPath'.", "Severity": "MEDIUM", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv023", "References": ["https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline", "https://avd.aquasec.com/misconfig/ksv023"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 24, "EndLine": 107, "Code": {"Lines": [{"Number": 24, "Content": "  replicas: 1", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 25, "Content": "  selector:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 26, "Content": "    matchLabels:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 27, "Content": "      app.kubernetes.io/part-of: kalm-benchmark", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 28, "Content": "      check: POD-042-2", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 29, "Content": "  template:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 30, "Content": "    metadata:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 31, "Content": "      annotations:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 32, "Content": "        container.apparmor.security.beta.kubernetes.io/app: runtime/default", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 33, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "deployment pod-042-2-volume-with-writeable-hostpath in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 10, "EndLine": 10, "Code": {"Lines": [{"Number": 10, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "serviceaccount pod-042-2-volume-with-writeable-hostpath-dedicated-sa in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "pod-042-3-volume-with-writeable-hostpath-by-default.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 3, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV023", "AVDID": "AVD-KSV-0023", "Title": "hostPath volumes mounted", "Description": "According to pod security standard 'HostPath Volumes', HostPath volumes must be forbidden.", "Message": "Deployment 'pod-042-3-volume-with-writeable-hostpath-by-default' should not set 'spec.template.volumes.hostPath'", "Namespace": "builtin.kubernetes.KSV023", "Query": "data.builtin.kubernetes.KSV023.deny", "Resolution": "Do not set 'spec.volumes[*].hostPath'.", "Severity": "MEDIUM", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv023", "References": ["https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline", "https://avd.aquasec.com/misconfig/ksv023"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 24, "EndLine": 106, "Code": {"Lines": [{"Number": 24, "Content": "  replicas: 1", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 25, "Content": "  selector:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 26, "Content": "    matchLabels:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 27, "Content": "      app.kubernetes.io/part-of: kalm-benchmark", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 28, "Content": "      check: POD-042-3", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 29, "Content": "  template:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 30, "Content": "    metadata:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 31, "Content": "      annotations:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 32, "Content": "        container.apparmor.security.beta.kubernetes.io/app: runtime/default", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 33, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "deployment pod-042-3-volume-with-writeable-hostpath-by-default in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 10, "EndLine": 10, "Code": {"Lines": [{"Number": 10, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "serviceaccount pod-042-3-volume-with-writeable-hostpath-by-default-dedicated-sa in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "pod-043-1-mount-azure-cloud-credentials.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 3, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV023", "AVDID": "AVD-KSV-0023", "Title": "hostPath volumes mounted", "Description": "According to pod security standard 'HostPath Volumes', HostPath volumes must be forbidden.", "Message": "Deployment 'pod-043-1-mount-azure-cloud-credentials' should not set 'spec.template.volumes.hostPath'", "Namespace": "builtin.kubernetes.KSV023", "Query": "data.builtin.kubernetes.KSV023.deny", "Resolution": "Do not set 'spec.volumes[*].hostPath'.", "Severity": "MEDIUM", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv023", "References": ["https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline", "https://avd.aquasec.com/misconfig/ksv023"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 24, "EndLine": 108, "Code": {"Lines": [{"Number": 24, "Content": "  replicas: 1", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 25, "Content": "  selector:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 26, "Content": "    matchLabels:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 27, "Content": "      app.kubernetes.io/part-of: kalm-benchmark", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 28, "Content": "      check: POD-043-1", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 29, "Content": "  template:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 30, "Content": "    metadata:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 31, "Content": "      annotations:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 32, "Content": "        container.apparmor.security.beta.kubernetes.io/app: runtime/default", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 33, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "deployment pod-043-1-mount-azure-cloud-credentials in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 10, "EndLine": 10, "Code": {"Lines": [{"Number": 10, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "serviceaccount pod-043-1-mount-azure-cloud-credentials-dedicated-sa in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "pod-044-1-mounting-docker-socket.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 4, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV006", "AVDID": "AVD-KSV-0006", "Title": "hostPath volume mounted with docker.sock", "Description": "Mounting docker.sock from the host can give the container full root access to the host.", "Message": "Deployment 'pod-044-1-mounting-docker-socket' should not specify '/var/run/docker.socker' in 'spec.template.volumes.hostPath.path'", "Namespace": "builtin.kubernetes.KSV006", "Query": "data.builtin.kubernetes.KSV006.deny", "Resolution": "Do not specify /var/run/docker.socket in 'spec.template.volumes.hostPath.path'.", "Severity": "HIGH", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv006", "References": ["https://kubesec.io/basics/spec-volumes-hostpath-path-var-run-docker-sock/", "https://avd.aquasec.com/misconfig/ksv006"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 24, "EndLine": 107, "Code": {"Lines": [{"Number": 24, "Content": "  replicas: 1", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 25, "Content": "  selector:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 26, "Content": "    matchLabels:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 27, "Content": "      app.kubernetes.io/part-of: kalm-benchmark", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 28, "Content": "      check: POD-044-1", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 29, "Content": "  template:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 30, "Content": "    metadata:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 31, "Content": "      annotations:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 32, "Content": "        container.apparmor.security.beta.kubernetes.io/app: runtime/default", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 33, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV023", "AVDID": "AVD-KSV-0023", "Title": "hostPath volumes mounted", "Description": "According to pod security standard 'HostPath Volumes', HostPath volumes must be forbidden.", "Message": "Deployment 'pod-044-1-mounting-docker-socket' should not set 'spec.template.volumes.hostPath'", "Namespace": "builtin.kubernetes.KSV023", "Query": "data.builtin.kubernetes.KSV023.deny", "Resolution": "Do not set 'spec.volumes[*].hostPath'.", "Severity": "MEDIUM", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv023", "References": ["https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline", "https://avd.aquasec.com/misconfig/ksv023"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 24, "EndLine": 107, "Code": {"Lines": [{"Number": 24, "Content": "  replicas: 1", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 25, "Content": "  selector:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 26, "Content": "    matchLabels:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 27, "Content": "      app.kubernetes.io/part-of: kalm-benchmark", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 28, "Content": "      check: POD-044-1", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 29, "Content": "  template:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 30, "Content": "    metadata:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 31, "Content": "      annotations:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 32, "Content": "        container.apparmor.security.beta.kubernetes.io/app: runtime/default", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 33, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "deployment pod-044-1-mounting-docker-socket in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 10, "EndLine": 10, "Code": {"Lines": [{"Number": 10, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "serviceaccount pod-044-1-mounting-docker-socket-dedicated-sa in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "pod-044-2-mounting-docker-directory.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 4, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV023", "AVDID": "AVD-KSV-0023", "Title": "hostPath volumes mounted", "Description": "According to pod security standard 'HostPath Volumes', HostPath volumes must be forbidden.", "Message": "Deployment 'pod-044-2-mounting-docker-directory' should not set 'spec.template.volumes.hostPath'", "Namespace": "builtin.kubernetes.KSV023", "Query": "data.builtin.kubernetes.KSV023.deny", "Resolution": "Do not set 'spec.volumes[*].hostPath'.", "Severity": "MEDIUM", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv023", "References": ["https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline", "https://avd.aquasec.com/misconfig/ksv023"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 24, "EndLine": 107, "Code": {"Lines": [{"Number": 24, "Content": "  replicas: 1", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 25, "Content": "  selector:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 26, "Content": "    matchLabels:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 27, "Content": "      app.kubernetes.io/part-of: kalm-benchmark", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 28, "Content": "      check: POD-044-2", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 29, "Content": "  template:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 30, "Content": "    metadata:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 31, "Content": "      annotations:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 32, "Content": "        container.apparmor.security.beta.kubernetes.io/app: runtime/default", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 33, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "deployment pod-044-2-mounting-docker-directory in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 10, "EndLine": 10, "Code": {"Lines": [{"Number": 10, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "serviceaccount pod-044-2-mounting-docker-directory-dedicated-sa in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}, {"Type": "Kubernetes Security Check", "ID": "KSV121", "AVDID": "AVD-KSV-0121", "Title": "Kubernetes resource with disallowed volumes mounted", "Description": "HostPath present many security risks and as a security practice it is better to avoid critical host paths mounts.", "Message": "deployment pod-044-2-mounting-docker-directory in kalm-benchmark namespace shouldn't have volumes set to {\"/var/lib/docker\"}", "Namespace": "builtin.kubernetes.KSV121", "Query": "data.builtin.kubernetes.KSV121.deny", "Resolution": "Do not Set 'spec.volumes[*].hostPath.path' to any of the disallowed volumes.", "Severity": "HIGH", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv121", "References": ["https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted", "https://avd.aquasec.com/misconfig/ksv121"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 24, "EndLine": 107, "Code": {"Lines": [{"Number": 24, "Content": "  replicas: 1", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 25, "Content": "  selector:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 26, "Content": "    matchLabels:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 27, "Content": "      app.kubernetes.io/part-of: kalm-benchmark", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 28, "Content": "      check: POD-044-2", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 29, "Content": "  template:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 30, "Content": "    metadata:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 31, "Content": "      annotations:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 32, "Content": "        container.apparmor.security.beta.kubernetes.io/app: runtime/default", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 33, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}]}, {"Target": "pod-045-containing-cve-2021-25741.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 2, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "deployment pod-045-containing-cve-2021-25741 in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 10, "EndLine": 10, "Code": {"Lines": [{"Number": 10, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "serviceaccount pod-045-containing-cve-2021-25741-dedicated-sa in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "ps-001-1-podsecurity-level-should-be-specified.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 6, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "deployment ps-001-1-podsecurity-level-should-be-specified in ps-001-1-podsecurity-level-should-be-specified namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 87, "EndLine": 87, "Code": {"Lines": [{"Number": 87, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "limitrange ps-001-1-podsecurity-level-should-be-specified in ps-001-1-podsecurity-level-should-be-specified namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 31, "EndLine": 31, "Code": {"Lines": [{"Number": 31, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "namespace ps-001-1-podsecurity-level-should-be-specified in ps-001-1-podsecurity-level-should-be-specified namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "networkpolicy ps-001-1-podsecurity-level-should-be-specified in ps-001-1-podsecurity-level-should-be-specified namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 59, "EndLine": 59, "Code": {"Lines": [{"Number": 59, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "resourcequota ps-001-1-podsecurity-level-should-be-specified in ps-001-1-podsecurity-level-should-be-specified namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 13, "EndLine": 13, "Code": {"Lines": [{"Number": 13, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "serviceaccount ps-001-1-podsecurity-level-should-be-specified-filler-dedicated-sa in ps-001-1-podsecurity-level-should-be-specified namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 77, "EndLine": 77, "Code": {"Lines": [{"Number": 77, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}]}, {"Target": "ps-001-no-pod-security-admission-label-configured.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 6, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "deployment ps-001-no-pod-security-admission-label-configured in ps-001-no-pod-security-admission-label-configured namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 87, "EndLine": 87, "Code": {"Lines": [{"Number": 87, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "limitrange ps-001-no-pod-security-admission-label-configured in ps-001-no-pod-security-admission-label-configured namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 31, "EndLine": 31, "Code": {"Lines": [{"Number": 31, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "namespace ps-001-no-pod-security-admission-label-configured in ps-001-no-pod-security-admission-label-configured namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "networkpolicy ps-001-no-pod-security-admission-label-configured in ps-001-no-pod-security-admission-label-configured namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 59, "EndLine": 59, "Code": {"Lines": [{"Number": 59, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "resourcequota ps-001-no-pod-security-admission-label-configured in ps-001-no-pod-security-admission-label-configured namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 13, "EndLine": 13, "Code": {"Lines": [{"Number": 13, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "serviceaccount ps-001-no-pod-security-admission-label-configured-filler-dedicated-sa in ps-001-no-pod-security-admission-label-configured namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 77, "EndLine": 77, "Code": {"Lines": [{"Number": 77, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}]}, {"Target": "ps-002-using-privilegedpodsecurity-level-is-insecure.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 6, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "deployment ps-002-using-privilegedpodsecurity-level-is-insecure in ps-002-using-privilegedpodsecurity-level-is-insecure namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 88, "EndLine": 88, "Code": {"Lines": [{"Number": 88, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "limitrange ps-002-using-privilegedpodsecurity-level-is-insecure in ps-002-using-privilegedpodsecurity-level-is-insecure namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 32, "EndLine": 32, "Code": {"Lines": [{"Number": 32, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "namespace ps-002-using-privilegedpodsecurity-level-is-insecure in ps-002-using-privilegedpodsecurity-level-is-insecure namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "networkpolicy ps-002-using-privilegedpodsecurity-level-is-insecure in ps-002-using-privilegedpodsecurity-level-is-insecure namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 60, "EndLine": 60, "Code": {"Lines": [{"Number": 60, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "resourcequota ps-002-using-privilegedpodsecurity-level-is-insecure in ps-002-using-privilegedpodsecurity-level-is-insecure namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 14, "EndLine": 14, "Code": {"Lines": [{"Number": 14, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "serviceaccount ps-002-using-privilegedpodsecurity-level-is-insecure-filler-dedicated-sa in ps-002-using-privilegedpodsecurity-level-is-insecure namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 78, "EndLine": 78, "Code": {"Lines": [{"Number": 78, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}]}, {"Target": "psa-001-no-pod-security-admission-label-configured.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 6, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "deployment psa-001-no-pod-security-admission-label-configured in psa-001-no-pod-security-admission-label-configured namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 87, "EndLine": 87, "Code": {"Lines": [{"Number": 87, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "limitrange psa-001-no-pod-security-admission-label-configured in psa-001-no-pod-security-admission-label-configured namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 31, "EndLine": 31, "Code": {"Lines": [{"Number": 31, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "namespace psa-001-no-pod-security-admission-label-configured in psa-001-no-pod-security-admission-label-configured namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "networkpolicy psa-001-no-pod-security-admission-label-configured in psa-001-no-pod-security-admission-label-configured namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 59, "EndLine": 59, "Code": {"Lines": [{"Number": 59, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "resourcequota psa-001-no-pod-security-admission-label-configured in psa-001-no-pod-security-admission-label-configured namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 13, "EndLine": 13, "Code": {"Lines": [{"Number": 13, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "serviceaccount psa-001-no-pod-security-admission-label-configured-filler-dedicated-sa in psa-001-no-pod-security-admission-label-configured namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 77, "EndLine": 77, "Code": {"Lines": [{"Number": 77, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}]}, {"Target": "psa-002-using-privileged-privilegedpodsecurity-level-is-insecur.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 6, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "deployment psa-002-using-privileged-privilegedpodsecurity-level-is-insecur in psa-002-using-privileged-privilegedpodsecurity-level-is-insecur namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 88, "EndLine": 88, "Code": {"Lines": [{"Number": 88, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "limitrange psa-002-using-privileged-privilegedpodsecurity-level-is-insecur in psa-002-using-privileged-privilegedpodsecurity-level-is-insecur namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 32, "EndLine": 32, "Code": {"Lines": [{"Number": 32, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "namespace psa-002-using-privileged-privilegedpodsecurity-level-is-insecur in psa-002-using-privileged-privilegedpodsecurity-level-is-insecur namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "networkpolicy psa-002-using-privileged-privilegedpodsecurity-level-is-insecur in psa-002-using-privileged-privilegedpodsecurity-level-is-insecur namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 60, "EndLine": 60, "Code": {"Lines": [{"Number": 60, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "resourcequota psa-002-using-privileged-privilegedpodsecurity-level-is-insecur in psa-002-using-privileged-privilegedpodsecurity-level-is-insecur namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 14, "EndLine": 14, "Code": {"Lines": [{"Number": 14, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "serviceaccount psa-002-using-privileged-privilegedpodsecurity-level-is-insecur-filler-dedicated-sa in psa-002-using-privileged-privilegedpodsecurity-level-is-insecur namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 78, "EndLine": 78, "Code": {"Lines": [{"Number": 78, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}]}, {"Target": "psa-003-just-warning-about-violations-of-the-pod-security-stand.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 6, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "deployment psa-003-just-warning-about-violations-of-the-pod-security-stand in psa-003-just-warning-about-violations-of-the-pod-security-stand namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 88, "EndLine": 88, "Code": {"Lines": [{"Number": 88, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "limitrange psa-003-just-warning-about-violations-of-the-pod-security-stand in psa-003-just-warning-about-violations-of-the-pod-security-stand namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 32, "EndLine": 32, "Code": {"Lines": [{"Number": 32, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "namespace psa-003-just-warning-about-violations-of-the-pod-security-stand in psa-003-just-warning-about-violations-of-the-pod-security-stand namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "networkpolicy psa-003-just-warning-about-violations-of-the-pod-security-stand in psa-003-just-warning-about-violations-of-the-pod-security-stand namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 60, "EndLine": 60, "Code": {"Lines": [{"Number": 60, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "resourcequota psa-003-just-warning-about-violations-of-the-pod-security-stand in psa-003-just-warning-about-violations-of-the-pod-security-stand namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 14, "EndLine": 14, "Code": {"Lines": [{"Number": 14, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "serviceaccount psa-003-just-warning-about-violations-of-the-pod-security-stand-filler-dedicated-sa in psa-003-just-warning-about-violations-of-the-pod-security-stand namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 78, "EndLine": 78, "Code": {"Lines": [{"Number": 78, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}]}, {"Target": "rbac-001-1-use-cluster-admin-role.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 150, "Failures": 2, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV111", "AVDID": "AVD-KSV-0111", "Title": "User with admin access", "Description": "Either cluster-admin or those granted powerful permissions.", "Message": "RoleBinding 'rbac-001-1-use-cluster-admin-role-rb-cluster-admin' should not bind to roles [\"cluster-admin\", \"admin\", \"edit\"]", "Namespace": "builtin.kubernetes.KSV111", "Query": "data.builtin.kubernetes.KSV111.deny", "Resolution": "Remove binding for clusterrole 'cluster-admin', 'admin' or 'edit'", "Severity": "MEDIUM", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv111", "References": ["https://kubernetes.io/docs/concepts/security/rbac-good-practices/", "https://avd.aquasec.com/misconfig/ksv111"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 4, "EndLine": 12, "Code": {"Lines": [{"Number": 4, "Content": "  annotations:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 5, "Content": "    check_path: RoleBinding.roleRef.name|ClusterRoleBinding.roleRef.name|.roleRef.name", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 6, "Content": "    description: The role cluster-admin provides wide-ranging powers over the environment and should be used only where and when needed", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 7, "Content": "    expected: alert", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 8, "Content": "  labels:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 9, "Content": "    app.kubernetes.io/part-of: kalm-benchmark", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 10, "Content": "    check: RBAC-001-1", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 11, "Content": "  name: rbac-001-1-use-cluster-admin-role-rb-cluster-admin", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 12, "Content": "  namespace: kalm-benchmark", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "rolebinding rbac-001-1-use-cluster-admin-role-rb-cluster-admin in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "rbac-001-2-use-cluster-admin-role-cluster-wide.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 150, "Failures": 2, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV111", "AVDID": "AVD-KSV-0111", "Title": "User with admin access", "Description": "Either cluster-admin or those granted powerful permissions.", "Message": "ClusterRoleBinding 'rbac-001-2-use-cluster-admin-role-cluster-wide-rb-cluster-admin' should not bind to roles [\"cluster-admin\", \"admin\", \"edit\"]", "Namespace": "builtin.kubernetes.KSV111", "Query": "data.builtin.kubernetes.KSV111.deny", "Resolution": "Remove binding for clusterrole 'cluster-admin', 'admin' or 'edit'", "Severity": "MEDIUM", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv111", "References": ["https://kubernetes.io/docs/concepts/security/rbac-good-practices/", "https://avd.aquasec.com/misconfig/ksv111"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 4, "EndLine": 12, "Code": {"Lines": [{"Number": 4, "Content": "  annotations:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 5, "Content": "    check_path: RoleBinding.roleRef.name|ClusterRoleBinding.roleRef.name|.roleRef.name", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 6, "Content": "    description: The role cluster-admin provides wide-ranging powers over the environment and should be used only where and when needed", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 7, "Content": "    expected: alert", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 8, "Content": "  labels:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 9, "Content": "    app.kubernetes.io/part-of: kalm-benchmark", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 10, "Content": "    check: RBAC-001-2", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 11, "Content": "  name: rbac-001-2-use-cluster-admin-role-cluster-wide-rb-cluster-admin", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 12, "Content": "  namespace: kalm-benchmark", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "clusterrolebinding rbac-001-2-use-cluster-admin-role-cluster-wide-rb-cluster-admin in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "rbac-002-1-read-access-to-secrets.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 150, "Failures": 2, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV113", "AVDID": "AVD-KSV-0113", "Title": "Manage namespace secrets", "Description": "Viewing secrets at the namespace scope can lead to escalation if another service account in that namespace has a higher privileged rolebinding or clusterrolebinding bound.", "Message": "Role 'rbac-002-1-secret-read-get' shouldn't have access to manage secrets in namespace 'kalm-benchmark'", "Namespace": "builtin.kubernetes.KSV113", "Query": "data.builtin.kubernetes.KSV113.deny", "Resolution": "Manage namespace secrets are not allowed. Remove resource 'secrets' from role", "Severity": "MEDIUM", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv113", "References": ["https://kubernetes.io/docs/concepts/security/rbac-good-practices/", "https://avd.aquasec.com/misconfig/ksv113"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 14, "EndLine": 19, "Code": {"Lines": [{"Number": 14, "Content": "  - apiGroups:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 15, "Content": "      - \"\"", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 16, "Content": "    resources:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 17, "Content": "      - secrets", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 18, "Content": "    verbs:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 19, "Content": "      - get", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "role rbac-002-1-secret-read-get in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "rbac-002-2-read-access-to-secrets.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 150, "Failures": 2, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV113", "AVDID": "AVD-KSV-0113", "Title": "Manage namespace secrets", "Description": "Viewing secrets at the namespace scope can lead to escalation if another service account in that namespace has a higher privileged rolebinding or clusterrolebinding bound.", "Message": "Role 'rbac-002-2-secret-read-list' shouldn't have access to manage secrets in namespace 'kalm-benchmark'", "Namespace": "builtin.kubernetes.KSV113", "Query": "data.builtin.kubernetes.KSV113.deny", "Resolution": "Manage namespace secrets are not allowed. Remove resource 'secrets' from role", "Severity": "MEDIUM", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv113", "References": ["https://kubernetes.io/docs/concepts/security/rbac-good-practices/", "https://avd.aquasec.com/misconfig/ksv113"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 14, "EndLine": 19, "Code": {"Lines": [{"Number": 14, "Content": "  - apiGroups:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 15, "Content": "      - \"\"", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 16, "Content": "    resources:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 17, "Content": "      - secrets", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 18, "Content": "    verbs:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 19, "Content": "      - list", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "role rbac-002-2-secret-read-list in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "rbac-002-3-read-access-to-secrets.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 150, "Failures": 2, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV113", "AVDID": "AVD-KSV-0113", "Title": "Manage namespace secrets", "Description": "Viewing secrets at the namespace scope can lead to escalation if another service account in that namespace has a higher privileged rolebinding or clusterrolebinding bound.", "Message": "Role 'rbac-002-3-secret-read-watch' shouldn't have access to manage secrets in namespace 'kalm-benchmark'", "Namespace": "builtin.kubernetes.KSV113", "Query": "data.builtin.kubernetes.KSV113.deny", "Resolution": "Manage namespace secrets are not allowed. Remove resource 'secrets' from role", "Severity": "MEDIUM", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv113", "References": ["https://kubernetes.io/docs/concepts/security/rbac-good-practices/", "https://avd.aquasec.com/misconfig/ksv113"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 14, "EndLine": 19, "Code": {"Lines": [{"Number": 14, "Content": "  - apiGroups:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 15, "Content": "      - \"\"", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 16, "Content": "    resources:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 17, "Content": "      - secrets", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 18, "Content": "    verbs:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 19, "Content": "      - watch", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "role rbac-002-3-secret-read-watch in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "rbac-002-4-read-access-to-secrets.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 150, "Failures": 2, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV041", "AVDID": "AVD-KSV-0041", "Title": "Manage secrets", "Description": "Viewing secrets at the cluster-scope is akin to cluster-admin in most clusters as there are typically at least one service accounts (their token stored in a secret) bound to cluster-admin directly or a role/clusterrole that gives similar permissions.", "Message": "ClusterRole 'rbac-002-4-secret-read-get' shouldn't have access to manage resource 'secrets'", "Namespace": "builtin.kubernetes.KSV041", "Query": "data.builtin.kubernetes.KSV041.deny", "Resolution": "Manage secrets are not allowed. Remove resource 'secrets' from cluster role", "Severity": "CRITICAL", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv041", "References": ["https://kubernetes.io/docs/concepts/security/rbac-good-practices/", "https://avd.aquasec.com/misconfig/ksv041"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 14, "EndLine": 19, "Code": {"Lines": [{"Number": 14, "Content": "  - apiGroups:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 15, "Content": "      - \"\"", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 16, "Content": "    resources:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 17, "Content": "      - secrets", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 18, "Content": "    verbs:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 19, "Content": "      - get", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "clusterrole rbac-002-4-secret-read-get in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "rbac-002-5-read-access-to-secrets.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 150, "Failures": 2, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV041", "AVDID": "AVD-KSV-0041", "Title": "Manage secrets", "Description": "Viewing secrets at the cluster-scope is akin to cluster-admin in most clusters as there are typically at least one service accounts (their token stored in a secret) bound to cluster-admin directly or a role/clusterrole that gives similar permissions.", "Message": "ClusterRole 'rbac-002-5-secret-read-list' shouldn't have access to manage resource 'secrets'", "Namespace": "builtin.kubernetes.KSV041", "Query": "data.builtin.kubernetes.KSV041.deny", "Resolution": "Manage secrets are not allowed. Remove resource 'secrets' from cluster role", "Severity": "CRITICAL", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv041", "References": ["https://kubernetes.io/docs/concepts/security/rbac-good-practices/", "https://avd.aquasec.com/misconfig/ksv041"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 14, "EndLine": 19, "Code": {"Lines": [{"Number": 14, "Content": "  - apiGroups:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 15, "Content": "      - \"\"", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 16, "Content": "    resources:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 17, "Content": "      - secrets", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 18, "Content": "    verbs:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 19, "Content": "      - list", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "clusterrole rbac-002-5-secret-read-list in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "rbac-002-6-read-access-to-secrets.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 150, "Failures": 2, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV041", "AVDID": "AVD-KSV-0041", "Title": "Manage secrets", "Description": "Viewing secrets at the cluster-scope is akin to cluster-admin in most clusters as there are typically at least one service accounts (their token stored in a secret) bound to cluster-admin directly or a role/clusterrole that gives similar permissions.", "Message": "ClusterRole 'rbac-002-6-secret-read-watch' shouldn't have access to manage resource 'secrets'", "Namespace": "builtin.kubernetes.KSV041", "Query": "data.builtin.kubernetes.KSV041.deny", "Resolution": "Manage secrets are not allowed. Remove resource 'secrets' from cluster role", "Severity": "CRITICAL", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv041", "References": ["https://kubernetes.io/docs/concepts/security/rbac-good-practices/", "https://avd.aquasec.com/misconfig/ksv041"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 14, "EndLine": 19, "Code": {"Lines": [{"Number": 14, "Content": "  - apiGroups:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 15, "Content": "      - \"\"", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 16, "Content": "    resources:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 17, "Content": "      - secrets", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 18, "Content": "    verbs:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 19, "Content": "      - watch", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "clusterrole rbac-002-6-secret-read-watch in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "rbac-003-1-role-use-resource-wildcard.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 150, "Failures": 2, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV112", "AVDID": "AVD-KSV-0112", "Title": "Manage all resources at the namespace", "Description": "Full control of the resources within a namespace.  In some cluster configurations, this is excessive. In others, this is normal (a gitops deployment operator like flux)", "Message": "Role 'rbac-003-1-all-resource-reader' shouldn't manage all resources at the namespace 'kalm-benchmark'", "Namespace": "builtin.kubernetes.KSV112", "Query": "data.builtin.kubernetes.KSV112.deny", "Resolution": "Remove '*' from 'rules.resources'. Provide specific list of resources to be managed by role in namespace", "Severity": "CRITICAL", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv112", "References": ["https://kubernetes.io/docs/concepts/security/rbac-good-practices/", "https://avd.aquasec.com/misconfig/ksv112"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 14, "EndLine": 19, "Code": {"Lines": [{"Number": 14, "Content": "  - apiGroups:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 15, "Content": "      - \"\"", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 16, "Content": "    resources:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 17, "Content": "      - \"*\"", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 18, "Content": "    verbs:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 19, "Content": "      - get", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "role rbac-003-1-all-resource-reader in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "rbac-003-2-cluster-role-use-resource-wildcard.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 150, "Failures": 2, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV046", "AVDID": "AVD-KSV-0046", "Title": "Manage all resources", "Description": "Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.", "Message": "ClusterRole 'rbac-003-2-cluster-all-resource-reader' shouldn't manage all resources", "Namespace": "builtin.kubernetes.KSV046", "Query": "data.builtin.kubernetes.KSV046.deny", "Resolution": "Remove '*' from 'rules.resources'. Provide specific list of resources to be managed by cluster role", "Severity": "CRITICAL", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv046", "References": ["https://kubernetes.io/docs/concepts/security/rbac-good-practices/", "https://avd.aquasec.com/misconfig/ksv046"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 14, "EndLine": 19, "Code": {"Lines": [{"Number": 14, "Content": "  - apiGroups:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 15, "Content": "      - \"\"", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 16, "Content": "    resources:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 17, "Content": "      - \"*\"", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 18, "Content": "    verbs:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 19, "Content": "      - get", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "clusterrole rbac-003-2-cluster-all-resource-reader in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "rbac-003-3-role-use-verb-wildcard.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 149, "Failures": 3, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV045", "AVDID": "AVD-KSV-0045", "Title": "No wildcard verb roles", "Description": "Check whether role permits wildcard verb on specific resources", "Message": "Role permits wildcard verb on specific resources", "Namespace": "builtin.kubernetes.KSV045", "Query": "data.builtin.kubernetes.KSV045.deny", "Resolution": "Create a role which does not permit wildcard verb on specific resources", "Severity": "CRITICAL", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv045", "References": ["https://kubernetes.io/docs/concepts/security/rbac-good-practices/", "https://avd.aquasec.com/misconfig/ksv045"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 14, "EndLine": 19, "Code": {"Lines": [{"Number": 14, "Content": "  - apiGroups:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 15, "Content": "      - \"\"", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 16, "Content": "    resources:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 17, "Content": "      - jobs", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 18, "Content": "    verbs:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 19, "Content": "      - \"*\"", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV048", "AVDID": "AVD-KSV-0048", "Title": "Manage Kubernetes workloads and pods", "Description": "Depending on the policies enforced by the admission controller, this permission ranges from the ability to steal compute (crypto) by running workloads or allowing for creating workloads that escape to the node as root and escalation to cluster-admin.", "Message": "Role 'rbac-003-3-all-ns-verbs' should not have access to resources [\"pods\", \"deployments\", \"jobs\", \"cronjobs\", \"statefulsets\", \"daemonsets\", \"replicasets\", \"replicationcontrollers\"] for verbs [\"create\", \"update\", \"patch\", \"delete\", \"deletecollection\", \"impersonate\", \"*\"]", "Namespace": "builtin.kubernetes.KSV048", "Query": "data.builtin.kubernetes.KSV048.deny", "Resolution": "Kubernetes workloads resources are only allowed for verbs 'list', 'watch', 'get'", "Severity": "MEDIUM", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv048", "References": ["https://kubernetes.io/docs/concepts/security/rbac-good-practices/", "https://avd.aquasec.com/misconfig/ksv048"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 14, "EndLine": 19, "Code": {"Lines": [{"Number": 14, "Content": "  - apiGroups:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 15, "Content": "      - \"\"", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 16, "Content": "    resources:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 17, "Content": "      - jobs", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 18, "Content": "    verbs:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 19, "Content": "      - \"*\"", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "role rbac-003-3-all-ns-verbs in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "rbac-003-4-cluster-role-use-verb-wildcard.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 149, "Failures": 3, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV045", "AVDID": "AVD-KSV-0045", "Title": "No wildcard verb roles", "Description": "Check whether role permits wildcard verb on specific resources", "Message": "Role permits wildcard verb on specific resources", "Namespace": "builtin.kubernetes.KSV045", "Query": "data.builtin.kubernetes.KSV045.deny", "Resolution": "Create a role which does not permit wildcard verb on specific resources", "Severity": "CRITICAL", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv045", "References": ["https://kubernetes.io/docs/concepts/security/rbac-good-practices/", "https://avd.aquasec.com/misconfig/ksv045"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 14, "EndLine": 19, "Code": {"Lines": [{"Number": 14, "Content": "  - apiGroups:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 15, "Content": "      - \"\"", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 16, "Content": "    resources:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 17, "Content": "      - jobs", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 18, "Content": "    verbs:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 19, "Content": "      - \"*\"", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV048", "AVDID": "AVD-KSV-0048", "Title": "Manage Kubernetes workloads and pods", "Description": "Depending on the policies enforced by the admission controller, this permission ranges from the ability to steal compute (crypto) by running workloads or allowing for creating workloads that escape to the node as root and escalation to cluster-admin.", "Message": "ClusterRole 'rbac-003-4-cluster-all-ns-verbs' should not have access to resources [\"pods\", \"deployments\", \"jobs\", \"cronjobs\", \"statefulsets\", \"daemonsets\", \"replicasets\", \"replicationcontrollers\"] for verbs [\"create\", \"update\", \"patch\", \"delete\", \"deletecollection\", \"impersonate\", \"*\"]", "Namespace": "builtin.kubernetes.KSV048", "Query": "data.builtin.kubernetes.KSV048.deny", "Resolution": "Kubernetes workloads resources are only allowed for verbs 'list', 'watch', 'get'", "Severity": "MEDIUM", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv048", "References": ["https://kubernetes.io/docs/concepts/security/rbac-good-practices/", "https://avd.aquasec.com/misconfig/ksv048"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 14, "EndLine": 19, "Code": {"Lines": [{"Number": 14, "Content": "  - apiGroups:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 15, "Content": "      - \"\"", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 16, "Content": "    resources:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 17, "Content": "      - jobs", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 18, "Content": "    verbs:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 19, "Content": "      - \"*\"", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "clusterrole rbac-003-4-cluster-all-ns-verbs in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "rbac-003-5-role-use-verb-wildcard.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 1, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "role rbac-003-5-all-ns-verbs in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "rbac-003-6-cluster-role-use-verb-wildcard.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 1, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "clusterrole rbac-003-6-cluster-all-ns-verbs in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "rbac-004-1-role-creates-pods.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 1, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "role rbac-004-1-pod-creator in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "rbac-004-2-cluster-role-creates-pods.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 1, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "clusterrole rbac-004-2-cluster-pod-creator in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "rbac-005-1-role-attaches-to-pods.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 1, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "role rbac-005-1-pod-attach in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "rbac-005-2-cluster-role-attaches-to-pods.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 1, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "clusterrole rbac-005-2-cluster-pod-attach in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "rbac-006-1-role-exec-into-pods.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 150, "Failures": 2, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV053", "AVDID": "AVD-KSV-0053", "Title": "Exec into Pods", "Description": "The ability to exec into a container with privileged access to the host or with an attached SA with higher RBAC permissions is a common escalation path to cluster-admin.", "Message": "Role 'rbac-006-1-pod-exec' should not have access to resource '[\"pods/exec\"]' for verbs [\"create\", \"update\", \"patch\", \"delete\", \"deletecollection\", \"impersonate\", \"*\"]", "Namespace": "builtin.kubernetes.KSV053", "Query": "data.builtin.kubernetes.KSV053.deny", "Resolution": "Remove write permission verbs for resource 'pods/exec'", "Severity": "HIGH", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv053", "References": ["https://kubernetes.io/docs/concepts/security/rbac-good-practices/", "https://avd.aquasec.com/misconfig/ksv053"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 14, "EndLine": 19, "Code": {"Lines": [{"Number": 14, "Content": "  - apiGroups:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 15, "Content": "      - \"\"", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 16, "Content": "    resources:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 17, "Content": "      - pods/exec", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 18, "Content": "    verbs:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 19, "Content": "      - create", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "role rbac-006-1-pod-exec in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "rbac-006-2-cluster-role-exec-into-pods.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 150, "Failures": 2, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV053", "AVDID": "AVD-KSV-0053", "Title": "Exec into Pods", "Description": "The ability to exec into a container with privileged access to the host or with an attached SA with higher RBAC permissions is a common escalation path to cluster-admin.", "Message": "ClusterRole 'rbac-006-2-cluster-pod-exec' should not have access to resource '[\"pods/exec\"]' for verbs [\"create\", \"update\", \"patch\", \"delete\", \"deletecollection\", \"impersonate\", \"*\"]", "Namespace": "builtin.kubernetes.KSV053", "Query": "data.builtin.kubernetes.KSV053.deny", "Resolution": "Remove write permission verbs for resource 'pods/exec'", "Severity": "HIGH", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv053", "References": ["https://kubernetes.io/docs/concepts/security/rbac-good-practices/", "https://avd.aquasec.com/misconfig/ksv053"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 14, "EndLine": 19, "Code": {"Lines": [{"Number": 14, "Content": "  - apiGroups:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 15, "Content": "      - \"\"", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 16, "Content": "    resources:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 17, "Content": "      - pods/exec", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 18, "Content": "    verbs:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 19, "Content": "      - create", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "clusterrole rbac-006-2-cluster-pod-exec in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "rbac-007-1-role-binds-default-serviceaccount.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 2, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "role rbac-007-1-role-bind-default-sa in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 22, "EndLine": 22, "Code": {"Lines": [{"Number": 22, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "rolebinding rbac-007-1-role-binds-default-serviceaccount-rb-rbac-007-1-role-bind-default-sa in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "rbac-007-2-cluster-role-binds-default-serviceaccount.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 2, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "clusterrole rbac-007-2-cluster-role-bind-default-sa in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 22, "EndLine": 22, "Code": {"Lines": [{"Number": 22, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "clusterrolebinding rbac-007-2-cluster-role-binds-default-serviceaccount-rb-rbac-007-2-cluster-role-bind-default-sa in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "rbac-008-1-role-port-forward-pods.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 1, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "role rbac-008-1-pod-forward in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "rbac-008-2-role-port-forward-pods.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 1, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "role rbac-008-2-pod-forward in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "rbac-008-3-role-port-forward-pods.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 1, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "role rbac-008-3-pod-forward in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "rbac-008-4-cluster-role-port-forward-pods.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 1, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "clusterrole rbac-008-4-cluster-pod-forward in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "rbac-008-5-cluster-role-port-forward-pods.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 1, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "clusterrole rbac-008-5-cluster-pod-forward in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "rbac-008-6-cluster-role-port-forward-pods.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 1, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "clusterrole rbac-008-6-cluster-pod-forward in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "rbac-009-1-role-impersonation.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 1, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "role rbac-009-1-role-bind-default-sa in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "rbac-009-2-cluster-role-impersonation.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 1, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "clusterrole rbac-009-2-cluster-role-bind-default-sa in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "rbac-010-1-role-manages-rbac.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 1, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "role rbac-010-1-role-destroy-resources in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "rbac-010-2-role-manages-rbac.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 1, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "role rbac-010-2-role-destroy-resources in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "rbac-010-3-role-manages-rbac.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 1, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "role rbac-010-3-role-destroy-resources in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "rbac-010-4-role-manages-rbac.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 1, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "role rbac-010-4-role-destroy-resources in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "rbac-010-5-cluster-role-manages-rbac.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 1, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "clusterrole rbac-010-5-cluster-role-destroy-resources in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "rbac-010-6-cluster-role-manages-rbac.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 1, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "clusterrole rbac-010-6-cluster-role-destroy-resources in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "rbac-010-7-cluster-role-manages-rbac.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 1, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "clusterrole rbac-010-7-cluster-role-destroy-resources in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "rbac-010-8-cluster-role-manages-rbac.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 1, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "clusterrole rbac-010-8-cluster-role-destroy-resources in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "rbac-012-1-role-info-disclosure.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 150, "Failures": 2, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV113", "AVDID": "AVD-KSV-0113", "Title": "Manage namespace secrets", "Description": "Viewing secrets at the namespace scope can lead to escalation if another service account in that namespace has a higher privileged rolebinding or clusterrolebinding bound.", "Message": "Role 'rbac-012-1-role-disclose-info' shouldn't have access to manage secrets in namespace 'kalm-benchmark'", "Namespace": "builtin.kubernetes.KSV113", "Query": "data.builtin.kubernetes.KSV113.deny", "Resolution": "Manage namespace secrets are not allowed. Remove resource 'secrets' from role", "Severity": "MEDIUM", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv113", "References": ["https://kubernetes.io/docs/concepts/security/rbac-good-practices/", "https://avd.aquasec.com/misconfig/ksv113"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 14, "EndLine": 27, "Code": {"Lines": [{"Number": 14, "Content": "  - apiGroups:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 15, "Content": "      - \"\"", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 16, "Content": "    resources:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 17, "Content": "      - secrets", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 18, "Content": "      - pods", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 19, "Content": "      - services", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 20, "Content": "      - deployments", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 21, "Content": "      - replicasets", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 22, "Content": "      - daemonsets", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 23, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "role rbac-012-1-role-disclose-info in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "rbac-012-2-role-info-disclosure.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 150, "Failures": 2, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV113", "AVDID": "AVD-KSV-0113", "Title": "Manage namespace secrets", "Description": "Viewing secrets at the namespace scope can lead to escalation if another service account in that namespace has a higher privileged rolebinding or clusterrolebinding bound.", "Message": "Role 'rbac-012-2-role-disclose-info' shouldn't have access to manage secrets in namespace 'kalm-benchmark'", "Namespace": "builtin.kubernetes.KSV113", "Query": "data.builtin.kubernetes.KSV113.deny", "Resolution": "Manage namespace secrets are not allowed. Remove resource 'secrets' from role", "Severity": "MEDIUM", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv113", "References": ["https://kubernetes.io/docs/concepts/security/rbac-good-practices/", "https://avd.aquasec.com/misconfig/ksv113"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 14, "EndLine": 27, "Code": {"Lines": [{"Number": 14, "Content": "  - apiGroups:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 15, "Content": "      - \"\"", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 16, "Content": "    resources:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 17, "Content": "      - secrets", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 18, "Content": "      - pods", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 19, "Content": "      - services", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 20, "Content": "      - deployments", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 21, "Content": "      - replicasets", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 22, "Content": "      - daemonsets", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 23, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "role rbac-012-2-role-disclose-info in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "rbac-012-3-role-info-disclosure.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 150, "Failures": 2, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV113", "AVDID": "AVD-KSV-0113", "Title": "Manage namespace secrets", "Description": "Viewing secrets at the namespace scope can lead to escalation if another service account in that namespace has a higher privileged rolebinding or clusterrolebinding bound.", "Message": "Role 'rbac-012-3-role-disclose-info' shouldn't have access to manage secrets in namespace 'kalm-benchmark'", "Namespace": "builtin.kubernetes.KSV113", "Query": "data.builtin.kubernetes.KSV113.deny", "Resolution": "Manage namespace secrets are not allowed. Remove resource 'secrets' from role", "Severity": "MEDIUM", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv113", "References": ["https://kubernetes.io/docs/concepts/security/rbac-good-practices/", "https://avd.aquasec.com/misconfig/ksv113"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 14, "EndLine": 27, "Code": {"Lines": [{"Number": 14, "Content": "  - apiGroups:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 15, "Content": "      - \"\"", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 16, "Content": "    resources:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 17, "Content": "      - secrets", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 18, "Content": "      - pods", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 19, "Content": "      - services", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 20, "Content": "      - deployments", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 21, "Content": "      - replicasets", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 22, "Content": "      - daemonsets", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 23, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "role rbac-012-3-role-disclose-info in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "rbac-012-4-cluster-role-info-disclosure.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 150, "Failures": 2, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV041", "AVDID": "AVD-KSV-0041", "Title": "Manage secrets", "Description": "Viewing secrets at the cluster-scope is akin to cluster-admin in most clusters as there are typically at least one service accounts (their token stored in a secret) bound to cluster-admin directly or a role/clusterrole that gives similar permissions.", "Message": "ClusterRole 'rbac-012-4-cluster-role-disclose-info' shouldn't have access to manage resource 'secrets'", "Namespace": "builtin.kubernetes.KSV041", "Query": "data.builtin.kubernetes.KSV041.deny", "Resolution": "Manage secrets are not allowed. Remove resource 'secrets' from cluster role", "Severity": "CRITICAL", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv041", "References": ["https://kubernetes.io/docs/concepts/security/rbac-good-practices/", "https://avd.aquasec.com/misconfig/ksv041"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 14, "EndLine": 27, "Code": {"Lines": [{"Number": 14, "Content": "  - apiGroups:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 15, "Content": "      - \"\"", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 16, "Content": "    resources:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 17, "Content": "      - secrets", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 18, "Content": "      - pods", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 19, "Content": "      - services", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 20, "Content": "      - deployments", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 21, "Content": "      - replicasets", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 22, "Content": "      - daemonsets", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 23, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "clusterrole rbac-012-4-cluster-role-disclose-info in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "rbac-012-5-cluster-role-info-disclosure.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 150, "Failures": 2, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV041", "AVDID": "AVD-KSV-0041", "Title": "Manage secrets", "Description": "Viewing secrets at the cluster-scope is akin to cluster-admin in most clusters as there are typically at least one service accounts (their token stored in a secret) bound to cluster-admin directly or a role/clusterrole that gives similar permissions.", "Message": "ClusterRole 'rbac-012-5-cluster-role-disclose-info' shouldn't have access to manage resource 'secrets'", "Namespace": "builtin.kubernetes.KSV041", "Query": "data.builtin.kubernetes.KSV041.deny", "Resolution": "Manage secrets are not allowed. Remove resource 'secrets' from cluster role", "Severity": "CRITICAL", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv041", "References": ["https://kubernetes.io/docs/concepts/security/rbac-good-practices/", "https://avd.aquasec.com/misconfig/ksv041"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 14, "EndLine": 27, "Code": {"Lines": [{"Number": 14, "Content": "  - apiGroups:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 15, "Content": "      - \"\"", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 16, "Content": "    resources:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 17, "Content": "      - secrets", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 18, "Content": "      - pods", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 19, "Content": "      - services", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 20, "Content": "      - deployments", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 21, "Content": "      - replicasets", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 22, "Content": "      - daemonsets", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 23, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "clusterrole rbac-012-5-cluster-role-disclose-info in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "rbac-012-6-cluster-role-info-disclosure.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 150, "Failures": 2, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV041", "AVDID": "AVD-KSV-0041", "Title": "Manage secrets", "Description": "Viewing secrets at the cluster-scope is akin to cluster-admin in most clusters as there are typically at least one service accounts (their token stored in a secret) bound to cluster-admin directly or a role/clusterrole that gives similar permissions.", "Message": "ClusterRole 'rbac-012-6-cluster-role-disclose-info' shouldn't have access to manage resource 'secrets'", "Namespace": "builtin.kubernetes.KSV041", "Query": "data.builtin.kubernetes.KSV041.deny", "Resolution": "Manage secrets are not allowed. Remove resource 'secrets' from cluster role", "Severity": "CRITICAL", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv041", "References": ["https://kubernetes.io/docs/concepts/security/rbac-good-practices/", "https://avd.aquasec.com/misconfig/ksv041"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 14, "EndLine": 27, "Code": {"Lines": [{"Number": 14, "Content": "  - apiGroups:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 15, "Content": "      - \"\"", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 16, "Content": "    resources:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 17, "Content": "      - secrets", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 18, "Content": "      - pods", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 19, "Content": "      - services", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 20, "Content": "      - deployments", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 21, "Content": "      - replicasets", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 22, "Content": "      - daemonsets", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 23, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "clusterrole rbac-012-6-cluster-role-disclose-info in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "rbac-013-1-role-destructive.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 148, "Failures": 4, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV048", "AVDID": "AVD-KSV-0048", "Title": "Manage Kubernetes workloads and pods", "Description": "Depending on the policies enforced by the admission controller, this permission ranges from the ability to steal compute (crypto) by running workloads or allowing for creating workloads that escape to the node as root and escalation to cluster-admin.", "Message": "Role 'rbac-013-1-role-destroy-resources' should not have access to resources [\"pods\", \"deployments\", \"jobs\", \"cronjobs\", \"statefulsets\", \"daemonsets\", \"replicasets\", \"replicationcontrollers\"] for verbs [\"create\", \"update\", \"patch\", \"delete\", \"deletecollection\", \"impersonate\", \"*\"]", "Namespace": "builtin.kubernetes.KSV048", "Query": "data.builtin.kubernetes.KSV048.deny", "Resolution": "Kubernetes workloads resources are only allowed for verbs 'list', 'watch', 'get'", "Severity": "MEDIUM", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv048", "References": ["https://kubernetes.io/docs/concepts/security/rbac-good-practices/", "https://avd.aquasec.com/misconfig/ksv048"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 14, "EndLine": 27, "Code": {"Lines": [{"Number": 14, "Content": "  - apiGroups:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 15, "Content": "      - \"\"", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 16, "Content": "    resources:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 17, "Content": "      - secrets", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 18, "Content": "      - pods", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 19, "Content": "      - services", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 20, "Content": "      - deployments", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 21, "Content": "      - replicasets", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 22, "Content": "      - daemonsets", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 23, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV056", "AVDID": "AVD-KSV-0056", "Title": "Manage Kubernetes networking", "Description": "The ability to control which pods get service traffic directed to them allows for interception attacks. Controlling network policy allows for bypassing lateral movement restrictions.", "Message": "Role 'rbac-013-1-role-destroy-resources' should not have access to resources [\"services\", \"endpoints\", \"endpointslices\", \"networkpolicies\", \"ingresses\"] for verbs [\"create\", \"update\", \"patch\", \"delete\", \"deletecollection\", \"impersonate\", \"*\"]", "Namespace": "builtin.kubernetes.KSV056", "Query": "data.builtin.kubernetes.KSV056.deny", "Resolution": "Networking resources are only allowed for verbs 'list', 'watch', 'get'", "Severity": "HIGH", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv056", "References": ["https://kubernetes.io/docs/concepts/security/rbac-good-practices/", "https://avd.aquasec.com/misconfig/ksv056"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 14, "EndLine": 27, "Code": {"Lines": [{"Number": 14, "Content": "  - apiGroups:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 15, "Content": "      - \"\"", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 16, "Content": "    resources:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 17, "Content": "      - secrets", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 18, "Content": "      - pods", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 19, "Content": "      - services", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 20, "Content": "      - deployments", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 21, "Content": "      - replicasets", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 22, "Content": "      - daemonsets", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 23, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV113", "AVDID": "AVD-KSV-0113", "Title": "Manage namespace secrets", "Description": "Viewing secrets at the namespace scope can lead to escalation if another service account in that namespace has a higher privileged rolebinding or clusterrolebinding bound.", "Message": "Role 'rbac-013-1-role-destroy-resources' shouldn't have access to manage secrets in namespace 'kalm-benchmark'", "Namespace": "builtin.kubernetes.KSV113", "Query": "data.builtin.kubernetes.KSV113.deny", "Resolution": "Manage namespace secrets are not allowed. Remove resource 'secrets' from role", "Severity": "MEDIUM", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv113", "References": ["https://kubernetes.io/docs/concepts/security/rbac-good-practices/", "https://avd.aquasec.com/misconfig/ksv113"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 14, "EndLine": 27, "Code": {"Lines": [{"Number": 14, "Content": "  - apiGroups:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 15, "Content": "      - \"\"", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 16, "Content": "    resources:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 17, "Content": "      - secrets", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 18, "Content": "      - pods", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 19, "Content": "      - services", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 20, "Content": "      - deployments", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 21, "Content": "      - replicasets", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 22, "Content": "      - daemonsets", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 23, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "role rbac-013-1-role-destroy-resources in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "rbac-013-2-role-destructive.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 148, "Failures": 4, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV048", "AVDID": "AVD-KSV-0048", "Title": "Manage Kubernetes workloads and pods", "Description": "Depending on the policies enforced by the admission controller, this permission ranges from the ability to steal compute (crypto) by running workloads or allowing for creating workloads that escape to the node as root and escalation to cluster-admin.", "Message": "Role 'rbac-013-2-role-destroy-resources' should not have access to resources [\"pods\", \"deployments\", \"jobs\", \"cronjobs\", \"statefulsets\", \"daemonsets\", \"replicasets\", \"replicationcontrollers\"] for verbs [\"create\", \"update\", \"patch\", \"delete\", \"deletecollection\", \"impersonate\", \"*\"]", "Namespace": "builtin.kubernetes.KSV048", "Query": "data.builtin.kubernetes.KSV048.deny", "Resolution": "Kubernetes workloads resources are only allowed for verbs 'list', 'watch', 'get'", "Severity": "MEDIUM", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv048", "References": ["https://kubernetes.io/docs/concepts/security/rbac-good-practices/", "https://avd.aquasec.com/misconfig/ksv048"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 14, "EndLine": 27, "Code": {"Lines": [{"Number": 14, "Content": "  - apiGroups:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 15, "Content": "      - \"\"", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 16, "Content": "    resources:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 17, "Content": "      - secrets", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 18, "Content": "      - pods", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 19, "Content": "      - services", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 20, "Content": "      - deployments", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 21, "Content": "      - replicasets", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 22, "Content": "      - daemonsets", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 23, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV056", "AVDID": "AVD-KSV-0056", "Title": "Manage Kubernetes networking", "Description": "The ability to control which pods get service traffic directed to them allows for interception attacks. Controlling network policy allows for bypassing lateral movement restrictions.", "Message": "Role 'rbac-013-2-role-destroy-resources' should not have access to resources [\"services\", \"endpoints\", \"endpointslices\", \"networkpolicies\", \"ingresses\"] for verbs [\"create\", \"update\", \"patch\", \"delete\", \"deletecollection\", \"impersonate\", \"*\"]", "Namespace": "builtin.kubernetes.KSV056", "Query": "data.builtin.kubernetes.KSV056.deny", "Resolution": "Networking resources are only allowed for verbs 'list', 'watch', 'get'", "Severity": "HIGH", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv056", "References": ["https://kubernetes.io/docs/concepts/security/rbac-good-practices/", "https://avd.aquasec.com/misconfig/ksv056"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 14, "EndLine": 27, "Code": {"Lines": [{"Number": 14, "Content": "  - apiGroups:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 15, "Content": "      - \"\"", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 16, "Content": "    resources:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 17, "Content": "      - secrets", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 18, "Content": "      - pods", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 19, "Content": "      - services", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 20, "Content": "      - deployments", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 21, "Content": "      - replicasets", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 22, "Content": "      - daemonsets", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 23, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV113", "AVDID": "AVD-KSV-0113", "Title": "Manage namespace secrets", "Description": "Viewing secrets at the namespace scope can lead to escalation if another service account in that namespace has a higher privileged rolebinding or clusterrolebinding bound.", "Message": "Role 'rbac-013-2-role-destroy-resources' shouldn't have access to manage secrets in namespace 'kalm-benchmark'", "Namespace": "builtin.kubernetes.KSV113", "Query": "data.builtin.kubernetes.KSV113.deny", "Resolution": "Manage namespace secrets are not allowed. Remove resource 'secrets' from role", "Severity": "MEDIUM", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv113", "References": ["https://kubernetes.io/docs/concepts/security/rbac-good-practices/", "https://avd.aquasec.com/misconfig/ksv113"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 14, "EndLine": 27, "Code": {"Lines": [{"Number": 14, "Content": "  - apiGroups:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 15, "Content": "      - \"\"", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 16, "Content": "    resources:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 17, "Content": "      - secrets", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 18, "Content": "      - pods", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 19, "Content": "      - services", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 20, "Content": "      - deployments", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 21, "Content": "      - replicasets", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 22, "Content": "      - daemonsets", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 23, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "role rbac-013-2-role-destroy-resources in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "rbac-013-3-cluster-role-destructive.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 148, "Failures": 4, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV041", "AVDID": "AVD-KSV-0041", "Title": "Manage secrets", "Description": "Viewing secrets at the cluster-scope is akin to cluster-admin in most clusters as there are typically at least one service accounts (their token stored in a secret) bound to cluster-admin directly or a role/clusterrole that gives similar permissions.", "Message": "ClusterRole 'rbac-013-3-cluster-role-destroy-resources' shouldn't have access to manage resource 'secrets'", "Namespace": "builtin.kubernetes.KSV041", "Query": "data.builtin.kubernetes.KSV041.deny", "Resolution": "Manage secrets are not allowed. Remove resource 'secrets' from cluster role", "Severity": "CRITICAL", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv041", "References": ["https://kubernetes.io/docs/concepts/security/rbac-good-practices/", "https://avd.aquasec.com/misconfig/ksv041"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 14, "EndLine": 27, "Code": {"Lines": [{"Number": 14, "Content": "  - apiGroups:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 15, "Content": "      - \"\"", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 16, "Content": "    resources:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 17, "Content": "      - secrets", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 18, "Content": "      - pods", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 19, "Content": "      - services", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 20, "Content": "      - deployments", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 21, "Content": "      - replicasets", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 22, "Content": "      - daemonsets", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 23, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV048", "AVDID": "AVD-KSV-0048", "Title": "Manage Kubernetes workloads and pods", "Description": "Depending on the policies enforced by the admission controller, this permission ranges from the ability to steal compute (crypto) by running workloads or allowing for creating workloads that escape to the node as root and escalation to cluster-admin.", "Message": "ClusterRole 'rbac-013-3-cluster-role-destroy-resources' should not have access to resources [\"pods\", \"deployments\", \"jobs\", \"cronjobs\", \"statefulsets\", \"daemonsets\", \"replicasets\", \"replicationcontrollers\"] for verbs [\"create\", \"update\", \"patch\", \"delete\", \"deletecollection\", \"impersonate\", \"*\"]", "Namespace": "builtin.kubernetes.KSV048", "Query": "data.builtin.kubernetes.KSV048.deny", "Resolution": "Kubernetes workloads resources are only allowed for verbs 'list', 'watch', 'get'", "Severity": "MEDIUM", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv048", "References": ["https://kubernetes.io/docs/concepts/security/rbac-good-practices/", "https://avd.aquasec.com/misconfig/ksv048"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 14, "EndLine": 27, "Code": {"Lines": [{"Number": 14, "Content": "  - apiGroups:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 15, "Content": "      - \"\"", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 16, "Content": "    resources:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 17, "Content": "      - secrets", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 18, "Content": "      - pods", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 19, "Content": "      - services", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 20, "Content": "      - deployments", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 21, "Content": "      - replicasets", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 22, "Content": "      - daemonsets", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 23, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV056", "AVDID": "AVD-KSV-0056", "Title": "Manage Kubernetes networking", "Description": "The ability to control which pods get service traffic directed to them allows for interception attacks. Controlling network policy allows for bypassing lateral movement restrictions.", "Message": "ClusterRole 'rbac-013-3-cluster-role-destroy-resources' should not have access to resources [\"services\", \"endpoints\", \"endpointslices\", \"networkpolicies\", \"ingresses\"] for verbs [\"create\", \"update\", \"patch\", \"delete\", \"deletecollection\", \"impersonate\", \"*\"]", "Namespace": "builtin.kubernetes.KSV056", "Query": "data.builtin.kubernetes.KSV056.deny", "Resolution": "Networking resources are only allowed for verbs 'list', 'watch', 'get'", "Severity": "HIGH", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv056", "References": ["https://kubernetes.io/docs/concepts/security/rbac-good-practices/", "https://avd.aquasec.com/misconfig/ksv056"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 14, "EndLine": 27, "Code": {"Lines": [{"Number": 14, "Content": "  - apiGroups:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 15, "Content": "      - \"\"", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 16, "Content": "    resources:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 17, "Content": "      - secrets", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 18, "Content": "      - pods", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 19, "Content": "      - services", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 20, "Content": "      - deployments", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 21, "Content": "      - replicasets", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 22, "Content": "      - daemonsets", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 23, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "clusterrole rbac-013-3-cluster-role-destroy-resources in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "rbac-013-4-cluster-role-destructive.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 148, "Failures": 4, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV041", "AVDID": "AVD-KSV-0041", "Title": "Manage secrets", "Description": "Viewing secrets at the cluster-scope is akin to cluster-admin in most clusters as there are typically at least one service accounts (their token stored in a secret) bound to cluster-admin directly or a role/clusterrole that gives similar permissions.", "Message": "ClusterRole 'rbac-013-4-cluster-role-destroy-resources' shouldn't have access to manage resource 'secrets'", "Namespace": "builtin.kubernetes.KSV041", "Query": "data.builtin.kubernetes.KSV041.deny", "Resolution": "Manage secrets are not allowed. Remove resource 'secrets' from cluster role", "Severity": "CRITICAL", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv041", "References": ["https://kubernetes.io/docs/concepts/security/rbac-good-practices/", "https://avd.aquasec.com/misconfig/ksv041"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 14, "EndLine": 27, "Code": {"Lines": [{"Number": 14, "Content": "  - apiGroups:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 15, "Content": "      - \"\"", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 16, "Content": "    resources:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 17, "Content": "      - secrets", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 18, "Content": "      - pods", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 19, "Content": "      - services", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 20, "Content": "      - deployments", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 21, "Content": "      - replicasets", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 22, "Content": "      - daemonsets", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 23, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV048", "AVDID": "AVD-KSV-0048", "Title": "Manage Kubernetes workloads and pods", "Description": "Depending on the policies enforced by the admission controller, this permission ranges from the ability to steal compute (crypto) by running workloads or allowing for creating workloads that escape to the node as root and escalation to cluster-admin.", "Message": "ClusterRole 'rbac-013-4-cluster-role-destroy-resources' should not have access to resources [\"pods\", \"deployments\", \"jobs\", \"cronjobs\", \"statefulsets\", \"daemonsets\", \"replicasets\", \"replicationcontrollers\"] for verbs [\"create\", \"update\", \"patch\", \"delete\", \"deletecollection\", \"impersonate\", \"*\"]", "Namespace": "builtin.kubernetes.KSV048", "Query": "data.builtin.kubernetes.KSV048.deny", "Resolution": "Kubernetes workloads resources are only allowed for verbs 'list', 'watch', 'get'", "Severity": "MEDIUM", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv048", "References": ["https://kubernetes.io/docs/concepts/security/rbac-good-practices/", "https://avd.aquasec.com/misconfig/ksv048"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 14, "EndLine": 27, "Code": {"Lines": [{"Number": 14, "Content": "  - apiGroups:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 15, "Content": "      - \"\"", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 16, "Content": "    resources:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 17, "Content": "      - secrets", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 18, "Content": "      - pods", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 19, "Content": "      - services", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 20, "Content": "      - deployments", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 21, "Content": "      - replicasets", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 22, "Content": "      - daemonsets", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 23, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV056", "AVDID": "AVD-KSV-0056", "Title": "Manage Kubernetes networking", "Description": "The ability to control which pods get service traffic directed to them allows for interception attacks. Controlling network policy allows for bypassing lateral movement restrictions.", "Message": "ClusterRole 'rbac-013-4-cluster-role-destroy-resources' should not have access to resources [\"services\", \"endpoints\", \"endpointslices\", \"networkpolicies\", \"ingresses\"] for verbs [\"create\", \"update\", \"patch\", \"delete\", \"deletecollection\", \"impersonate\", \"*\"]", "Namespace": "builtin.kubernetes.KSV056", "Query": "data.builtin.kubernetes.KSV056.deny", "Resolution": "Networking resources are only allowed for verbs 'list', 'watch', 'get'", "Severity": "HIGH", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv056", "References": ["https://kubernetes.io/docs/concepts/security/rbac-good-practices/", "https://avd.aquasec.com/misconfig/ksv056"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 14, "EndLine": 27, "Code": {"Lines": [{"Number": 14, "Content": "  - apiGroups:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 15, "Content": "      - \"\"", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 16, "Content": "    resources:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 17, "Content": "      - secrets", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 18, "Content": "      - pods", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 19, "Content": "      - services", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 20, "Content": "      - deployments", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 21, "Content": "      - replicasets", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 22, "Content": "      - daemonsets", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 23, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "clusterrole rbac-013-4-cluster-role-destroy-resources in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "rbac-014-1-role-event-deletion.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 1, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "role rbac-014-1--destroy-events in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "rbac-014-2-role-event-deletion.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 1, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "role rbac-014-2--destroy-events in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "rbac-014-3-cluster-role-event-deletion.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 1, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "clusterrole rbac-014-3-cluster--destroy-events in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "rbac-014-4-cluster-role-event-deletion.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 1, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "clusterrole rbac-014-4-cluster--destroy-events in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "rbac-015-1-role-core-dns-poisoning.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 150, "Failures": 2, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV049", "AVDID": "AVD-KSV-0049", "Title": "Manage configmaps", "Description": "Some workloads leverage configmaps to store sensitive data or configuration parameters that affect runtime behavior that can be modified by an attacker or combined with another issue to potentially lead to compromise.", "Message": "Role 'rbac-015-1-role-poison-dns' should not have access to resource 'configmaps' for verbs [\"create\", \"update\", \"patch\", \"delete\", \"deletecollection\", \"impersonate\", \"*\"]", "Namespace": "builtin.kubernetes.KSV049", "Query": "data.builtin.kubernetes.KSV049.deny", "Resolution": "Remove write permission verbs for resource 'configmaps'", "Severity": "MEDIUM", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv049", "References": ["https://kubernetes.io/docs/concepts/security/rbac-good-practices/", "https://avd.aquasec.com/misconfig/ksv049"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 14, "EndLine": 19, "Code": {"Lines": [{"Number": 14, "Content": "  - apiGroups:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 15, "Content": "      - \"\"", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 16, "Content": "    resources:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 17, "Content": "      - configmaps", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 18, "Content": "    verbs:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 19, "Content": "      - update", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "role rbac-015-1-role-poison-dns in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "rbac-015-2-role-core-dns-poisoning.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 150, "Failures": 2, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV049", "AVDID": "AVD-KSV-0049", "Title": "Manage configmaps", "Description": "Some workloads leverage configmaps to store sensitive data or configuration parameters that affect runtime behavior that can be modified by an attacker or combined with another issue to potentially lead to compromise.", "Message": "Role 'rbac-015-2-role-poison-dns' should not have access to resource 'configmaps' for verbs [\"create\", \"update\", \"patch\", \"delete\", \"deletecollection\", \"impersonate\", \"*\"]", "Namespace": "builtin.kubernetes.KSV049", "Query": "data.builtin.kubernetes.KSV049.deny", "Resolution": "Remove write permission verbs for resource 'configmaps'", "Severity": "MEDIUM", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv049", "References": ["https://kubernetes.io/docs/concepts/security/rbac-good-practices/", "https://avd.aquasec.com/misconfig/ksv049"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 14, "EndLine": 19, "Code": {"Lines": [{"Number": 14, "Content": "  - apiGroups:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 15, "Content": "      - \"\"", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 16, "Content": "    resources:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 17, "Content": "      - configmaps", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 18, "Content": "    verbs:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 19, "Content": "      - patch", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "role rbac-015-2-role-poison-dns in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "rbac-015-3-cluster-role-core-dns-poisoning.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 150, "Failures": 2, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV049", "AVDID": "AVD-KSV-0049", "Title": "Manage configmaps", "Description": "Some workloads leverage configmaps to store sensitive data or configuration parameters that affect runtime behavior that can be modified by an attacker or combined with another issue to potentially lead to compromise.", "Message": "ClusterRole 'rbac-015-3-cluster-role-poison-dns' should not have access to resource 'configmaps' for verbs [\"create\", \"update\", \"patch\", \"delete\", \"deletecollection\", \"impersonate\", \"*\"]", "Namespace": "builtin.kubernetes.KSV049", "Query": "data.builtin.kubernetes.KSV049.deny", "Resolution": "Remove write permission verbs for resource 'configmaps'", "Severity": "MEDIUM", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv049", "References": ["https://kubernetes.io/docs/concepts/security/rbac-good-practices/", "https://avd.aquasec.com/misconfig/ksv049"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 14, "EndLine": 19, "Code": {"Lines": [{"Number": 14, "Content": "  - apiGroups:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 15, "Content": "      - \"\"", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 16, "Content": "    resources:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 17, "Content": "      - configmaps", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 18, "Content": "    verbs:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 19, "Content": "      - update", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "clusterrole rbac-015-3-cluster-role-poison-dns in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "rbac-015-4-cluster-role-core-dns-poisoning.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 150, "Failures": 2, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV049", "AVDID": "AVD-KSV-0049", "Title": "Manage configmaps", "Description": "Some workloads leverage configmaps to store sensitive data or configuration parameters that affect runtime behavior that can be modified by an attacker or combined with another issue to potentially lead to compromise.", "Message": "ClusterRole 'rbac-015-4-cluster-role-poison-dns' should not have access to resource 'configmaps' for verbs [\"create\", \"update\", \"patch\", \"delete\", \"deletecollection\", \"impersonate\", \"*\"]", "Namespace": "builtin.kubernetes.KSV049", "Query": "data.builtin.kubernetes.KSV049.deny", "Resolution": "Remove write permission verbs for resource 'configmaps'", "Severity": "MEDIUM", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv049", "References": ["https://kubernetes.io/docs/concepts/security/rbac-good-practices/", "https://avd.aquasec.com/misconfig/ksv049"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 14, "EndLine": 19, "Code": {"Lines": [{"Number": 14, "Content": "  - apiGroups:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 15, "Content": "      - \"\"", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 16, "Content": "    resources:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 17, "Content": "      - configmaps", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 18, "Content": "    verbs:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 19, "Content": "      - patch", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "clusterrole rbac-015-4-cluster-role-poison-dns in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "rbac-016-serviceaccount-without-binding.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 1, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "serviceaccount rbac-016-ronin-sa in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "rbac-017-too-many-roles-per-subject.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 20, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "role rbac-017-role-0-too-much in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 21, "EndLine": 21, "Code": {"Lines": [{"Number": 21, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "role rbac-017-role-1-too-much in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 62, "EndLine": 62, "Code": {"Lines": [{"Number": 62, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "role rbac-017-role-2-too-much in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 103, "EndLine": 103, "Code": {"Lines": [{"Number": 103, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "role rbac-017-role-3-too-much in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 144, "EndLine": 144, "Code": {"Lines": [{"Number": 144, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "role rbac-017-role-4-too-much in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 185, "EndLine": 185, "Code": {"Lines": [{"Number": 185, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "role rbac-017-role-5-too-much in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 226, "EndLine": 226, "Code": {"Lines": [{"Number": 226, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "role rbac-017-role-6-too-much in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 267, "EndLine": 267, "Code": {"Lines": [{"Number": 267, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "role rbac-017-role-7-too-much in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 308, "EndLine": 308, "Code": {"Lines": [{"Number": 308, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "role rbac-017-role-8-too-much in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 349, "EndLine": 349, "Code": {"Lines": [{"Number": 349, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "role rbac-017-role-9-too-much in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 390, "EndLine": 390, "Code": {"Lines": [{"Number": 390, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "rolebinding rbac-017-too-many-roles-per-subject-rb-rbac-017-role-0-too-much in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "rolebinding rbac-017-too-many-roles-per-subject-rb-rbac-017-role-1-too-much in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 41, "EndLine": 41, "Code": {"Lines": [{"Number": 41, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "rolebinding rbac-017-too-many-roles-per-subject-rb-rbac-017-role-2-too-much in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 82, "EndLine": 82, "Code": {"Lines": [{"Number": 82, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "rolebinding rbac-017-too-many-roles-per-subject-rb-rbac-017-role-3-too-much in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 123, "EndLine": 123, "Code": {"Lines": [{"Number": 123, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "rolebinding rbac-017-too-many-roles-per-subject-rb-rbac-017-role-4-too-much in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 164, "EndLine": 164, "Code": {"Lines": [{"Number": 164, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "rolebinding rbac-017-too-many-roles-per-subject-rb-rbac-017-role-5-too-much in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 205, "EndLine": 205, "Code": {"Lines": [{"Number": 205, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "rolebinding rbac-017-too-many-roles-per-subject-rb-rbac-017-role-6-too-much in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 246, "EndLine": 246, "Code": {"Lines": [{"Number": 246, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "rolebinding rbac-017-too-many-roles-per-subject-rb-rbac-017-role-7-too-much in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 287, "EndLine": 287, "Code": {"Lines": [{"Number": 287, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "rolebinding rbac-017-too-many-roles-per-subject-rb-rbac-017-role-8-too-much in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 328, "EndLine": 328, "Code": {"Lines": [{"Number": 328, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "rolebinding rbac-017-too-many-roles-per-subject-rb-rbac-017-role-9-too-much in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 369, "EndLine": 369, "Code": {"Lines": [{"Number": 369, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}]}, {"Target": "rbac-020-1-role-manages-rbac.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 1, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "role rbac-020-1-role-escalate-resources in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "rbac-020-2-role-manages-rbac.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 1, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "role rbac-020-2-role-escalate-resources in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "rbac-020-3-role-manages-rbac.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 1, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "role rbac-020-3-role-escalate-resources in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "rbac-020-4-role-manages-rbac.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 1, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "role rbac-020-4-role-escalate-resources in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "rbac-020-5-cluster-role-manages-rbac.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 1, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "clusterrole rbac-020-5-cluster-role-escalate-resources in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "rbac-020-6-cluster-role-manages-rbac.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 1, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "clusterrole rbac-020-6-cluster-role-escalate-resources in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "rbac-020-7-cluster-role-manages-rbac.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 1, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "clusterrole rbac-020-7-cluster-role-escalate-resources in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "rbac-020-8-cluster-role-manages-rbac.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 1, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "clusterrole rbac-020-8-cluster-role-escalate-resources in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "rel-001-no-readinessprobe.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 2, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "deployment rel-001-no-readinessprobe in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 10, "EndLine": 10, "Code": {"Lines": [{"Number": 10, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "serviceaccount rel-001-no-readinessprobe-dedicated-sa in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "rel-002-no-livenessprobe.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 2, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "deployment rel-002-no-livenessprobe in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 10, "EndLine": 10, "Code": {"Lines": [{"Number": 10, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "serviceaccount rel-002-no-livenessprobe-dedicated-sa in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "rel-003-no-priorityclass.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 2, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "deployment rel-003-no-priorityclass in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 10, "EndLine": 10, "Code": {"Lines": [{"Number": 10, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "serviceaccount rel-003-no-priorityclass-dedicated-sa in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "rel-004-1-no-node-selection-specified.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 2, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "deployment rel-004-1-no-node-selection-specified in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 10, "EndLine": 10, "Code": {"Lines": [{"Number": 10, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "serviceaccount rel-004-1-no-node-selection-specified-dedicated-sa in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "rel-004-2-only-nodeaffinity-is-enough.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 2, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "deployment rel-004-2-only-nodeaffinity-is-enough in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 10, "EndLine": 10, "Code": {"Lines": [{"Number": 10, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "serviceaccount rel-004-2-only-nodeaffinity-is-enough-dedicated-sa in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "rel-004-3-only-nodeselector-is-enough.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 2, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "deployment rel-004-3-only-nodeselector-is-enough in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 10, "EndLine": 10, "Code": {"Lines": [{"Number": 10, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "serviceaccount rel-004-3-only-nodeselector-is-enough-dedicated-sa in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "res-001-1-default-memory-requests-from-namespace.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 3, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV016", "AVDID": "AVD-KSV-0016", "Title": "Memory requests not specified", "Description": "When containers have memory requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.", "Message": "Container 'app' of Deployment 'res-001-1-default-memory-requests-from-namespace' should set 'resources.requests.memory'", "Namespace": "builtin.kubernetes.KSV016", "Query": "data.builtin.kubernetes.KSV016.deny", "Resolution": "Set 'containers[].resources.requests.memory'.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv016", "References": ["https://kubesec.io/basics/containers-resources-limits-memory/", "https://avd.aquasec.com/misconfig/ksv016"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 49, "EndLine": 83, "Code": {"Lines": [{"Number": 49, "Content": "        - image: nginx@sha256:aed492c4dc93d2d1f6fe9a49f00bc7e1863d950334a93facd8ca1317292bf6aa", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 50, "Content": "          imagePullPolicy: Always", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 51, "Content": "          livenessProbe:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 52, "Content": "            httpGet:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 53, "Content": "              path: /live", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 54, "Content": "              port: 8080", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 55, "Content": "          name: app", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 56, "Content": "          ports:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 57, "Content": "            - containerPort: 8080", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 58, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "deployment res-001-1-default-memory-requests-from-namespace in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 10, "EndLine": 10, "Code": {"Lines": [{"Number": 10, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "serviceaccount res-001-1-default-memory-requests-from-namespace-dedicated-sa in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "res-001-2-no-memory-requests.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 3, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV016", "AVDID": "AVD-KSV-0016", "Title": "Memory requests not specified", "Description": "When containers have memory requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.", "Message": "Container 'app' of Deployment 'res-001-2-no-memory-requests' should set 'resources.requests.memory'", "Namespace": "builtin.kubernetes.KSV016", "Query": "data.builtin.kubernetes.KSV016.deny", "Resolution": "Set 'containers[].resources.requests.memory'.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv016", "References": ["https://kubesec.io/basics/containers-resources-limits-memory/", "https://avd.aquasec.com/misconfig/ksv016"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 49, "EndLine": 83, "Code": {"Lines": [{"Number": 49, "Content": "        - image: nginx@sha256:aed492c4dc93d2d1f6fe9a49f00bc7e1863d950334a93facd8ca1317292bf6aa", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 50, "Content": "          imagePullPolicy: Always", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 51, "Content": "          livenessProbe:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 52, "Content": "            httpGet:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 53, "Content": "              path: /live", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 54, "Content": "              port: 8080", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 55, "Content": "          name: app", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 56, "Content": "          ports:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 57, "Content": "            - containerPort: 8080", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 58, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "deployment res-001-2-no-memory-requests in kalm-benchmark-unrestricted-ns namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 10, "EndLine": 10, "Code": {"Lines": [{"Number": 10, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "serviceaccount res-001-2-no-memory-requests-dedicated-sa in kalm-benchmark-unrestricted-ns namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "res-002-1-default-memory-limits-from-namespace.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 3, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV018", "AVDID": "AVD-KSV-0018", "Title": "Memory not limited", "Description": "Enforcing memory limits prevents DoS via resource exhaustion.", "Message": "Container 'app' of Deployment 'res-002-1-default-memory-limits-from-namespace' should set 'resources.limits.memory'", "Namespace": "builtin.kubernetes.KSV018", "Query": "data.builtin.kubernetes.KSV018.deny", "Resolution": "Set a limit value under 'containers[].resources.limits.memory'.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv018", "References": ["https://kubesec.io/basics/containers-resources-limits-memory/", "https://avd.aquasec.com/misconfig/ksv018"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 49, "EndLine": 83, "Code": {"Lines": [{"Number": 49, "Content": "        - image: nginx@sha256:aed492c4dc93d2d1f6fe9a49f00bc7e1863d950334a93facd8ca1317292bf6aa", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 50, "Content": "          imagePullPolicy: Always", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 51, "Content": "          livenessProbe:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 52, "Content": "            httpGet:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 53, "Content": "              path: /live", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 54, "Content": "              port: 8080", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 55, "Content": "          name: app", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 56, "Content": "          ports:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 57, "Content": "            - containerPort: 8080", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 58, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "deployment res-002-1-default-memory-limits-from-namespace in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 10, "EndLine": 10, "Code": {"Lines": [{"Number": 10, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "serviceaccount res-002-1-default-memory-limits-from-namespace-dedicated-sa in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "res-002-2-no-memory-limits.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 3, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV018", "AVDID": "AVD-KSV-0018", "Title": "Memory not limited", "Description": "Enforcing memory limits prevents DoS via resource exhaustion.", "Message": "Container 'app' of Deployment 'res-002-2-no-memory-limits' should set 'resources.limits.memory'", "Namespace": "builtin.kubernetes.KSV018", "Query": "data.builtin.kubernetes.KSV018.deny", "Resolution": "Set a limit value under 'containers[].resources.limits.memory'.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv018", "References": ["https://kubesec.io/basics/containers-resources-limits-memory/", "https://avd.aquasec.com/misconfig/ksv018"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 49, "EndLine": 83, "Code": {"Lines": [{"Number": 49, "Content": "        - image: nginx@sha256:aed492c4dc93d2d1f6fe9a49f00bc7e1863d950334a93facd8ca1317292bf6aa", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 50, "Content": "          imagePullPolicy: Always", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 51, "Content": "          livenessProbe:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 52, "Content": "            httpGet:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 53, "Content": "              path: /live", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 54, "Content": "              port: 8080", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 55, "Content": "          name: app", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 56, "Content": "          ports:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 57, "Content": "            - containerPort: 8080", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 58, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "deployment res-002-2-no-memory-limits in kalm-benchmark-unrestricted-ns namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 10, "EndLine": 10, "Code": {"Lines": [{"Number": 10, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "serviceaccount res-002-2-no-memory-limits-dedicated-sa in kalm-benchmark-unrestricted-ns namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "res-003-1-default-cpu-requests-from-namespace.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 3, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV015", "AVDID": "AVD-KSV-0015", "Title": "CPU requests not specified", "Description": "When containers have resource requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.", "Message": "Container 'app' of Deployment 'res-003-1-default-cpu-requests-from-namespace' should set 'resources.requests.cpu'", "Namespace": "builtin.kubernetes.KSV015", "Query": "data.builtin.kubernetes.KSV015.deny", "Resolution": "Set 'containers[].resources.requests.cpu'.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv015", "References": ["https://cloud.google.com/blog/products/containers-kubernetes/kubernetes-best-practices-resource-requests-and-limits", "https://avd.aquasec.com/misconfig/ksv015"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 49, "EndLine": 83, "Code": {"Lines": [{"Number": 49, "Content": "        - image: nginx@sha256:aed492c4dc93d2d1f6fe9a49f00bc7e1863d950334a93facd8ca1317292bf6aa", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 50, "Content": "          imagePullPolicy: Always", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 51, "Content": "          livenessProbe:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 52, "Content": "            httpGet:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 53, "Content": "              path: /live", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 54, "Content": "              port: 8080", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 55, "Content": "          name: app", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 56, "Content": "          ports:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 57, "Content": "            - containerPort: 8080", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 58, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "deployment res-003-1-default-cpu-requests-from-namespace in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 10, "EndLine": 10, "Code": {"Lines": [{"Number": 10, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "serviceaccount res-003-1-default-cpu-requests-from-namespace-dedicated-sa in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "res-003-2-no-cpu-requests.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 3, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV015", "AVDID": "AVD-KSV-0015", "Title": "CPU requests not specified", "Description": "When containers have resource requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.", "Message": "Container 'app' of Deployment 'res-003-2-no-cpu-requests' should set 'resources.requests.cpu'", "Namespace": "builtin.kubernetes.KSV015", "Query": "data.builtin.kubernetes.KSV015.deny", "Resolution": "Set 'containers[].resources.requests.cpu'.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv015", "References": ["https://cloud.google.com/blog/products/containers-kubernetes/kubernetes-best-practices-resource-requests-and-limits", "https://avd.aquasec.com/misconfig/ksv015"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 49, "EndLine": 83, "Code": {"Lines": [{"Number": 49, "Content": "        - image: nginx@sha256:aed492c4dc93d2d1f6fe9a49f00bc7e1863d950334a93facd8ca1317292bf6aa", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 50, "Content": "          imagePullPolicy: Always", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 51, "Content": "          livenessProbe:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 52, "Content": "            httpGet:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 53, "Content": "              path: /live", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 54, "Content": "              port: 8080", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 55, "Content": "          name: app", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 56, "Content": "          ports:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 57, "Content": "            - containerPort: 8080", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 58, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "deployment res-003-2-no-cpu-requests in kalm-benchmark-unrestricted-ns namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 10, "EndLine": 10, "Code": {"Lines": [{"Number": 10, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "serviceaccount res-003-2-no-cpu-requests-dedicated-sa in kalm-benchmark-unrestricted-ns namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "res-004-1-default-cpu-limits-from-namespace.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 3, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV011", "AVDID": "AVD-KSV-0011", "Title": "CPU not limited", "Description": "Enforcing CPU limits prevents DoS via resource exhaustion.", "Message": "Container 'app' of Deployment 'res-004-1-default-cpu-limits-from-namespace' should set 'resources.limits.cpu'", "Namespace": "builtin.kubernetes.KSV011", "Query": "data.builtin.kubernetes.KSV011.deny", "Resolution": "Set a limit value under 'containers[].resources.limits.cpu'.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv011", "References": ["https://cloud.google.com/blog/products/containers-kubernetes/kubernetes-best-practices-resource-requests-and-limits", "https://avd.aquasec.com/misconfig/ksv011"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 49, "EndLine": 83, "Code": {"Lines": [{"Number": 49, "Content": "        - image: nginx@sha256:aed492c4dc93d2d1f6fe9a49f00bc7e1863d950334a93facd8ca1317292bf6aa", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 50, "Content": "          imagePullPolicy: Always", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 51, "Content": "          livenessProbe:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 52, "Content": "            httpGet:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 53, "Content": "              path: /live", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 54, "Content": "              port: 8080", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 55, "Content": "          name: app", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 56, "Content": "          ports:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 57, "Content": "            - containerPort: 8080", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 58, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "deployment res-004-1-default-cpu-limits-from-namespace in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 10, "EndLine": 10, "Code": {"Lines": [{"Number": 10, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "serviceaccount res-004-1-default-cpu-limits-from-namespace-dedicated-sa in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "res-004-2-no-cpu-limits.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 3, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV011", "AVDID": "AVD-KSV-0011", "Title": "CPU not limited", "Description": "Enforcing CPU limits prevents DoS via resource exhaustion.", "Message": "Container 'app' of Deployment 'res-004-2-no-cpu-limits' should set 'resources.limits.cpu'", "Namespace": "builtin.kubernetes.KSV011", "Query": "data.builtin.kubernetes.KSV011.deny", "Resolution": "Set a limit value under 'containers[].resources.limits.cpu'.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv011", "References": ["https://cloud.google.com/blog/products/containers-kubernetes/kubernetes-best-practices-resource-requests-and-limits", "https://avd.aquasec.com/misconfig/ksv011"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 49, "EndLine": 83, "Code": {"Lines": [{"Number": 49, "Content": "        - image: nginx@sha256:aed492c4dc93d2d1f6fe9a49f00bc7e1863d950334a93facd8ca1317292bf6aa", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 50, "Content": "          imagePullPolicy: Always", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 51, "Content": "          livenessProbe:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 52, "Content": "            httpGet:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 53, "Content": "              path: /live", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 54, "Content": "              port: 8080", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 55, "Content": "          name: app", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 56, "Content": "          ports:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 57, "Content": "            - containerPort: 8080", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 58, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "deployment res-004-2-no-cpu-limits in kalm-benchmark-unrestricted-ns namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 10, "EndLine": 10, "Code": {"Lines": [{"Number": 10, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "serviceaccount res-004-2-no-cpu-limits-dedicated-sa in kalm-benchmark-unrestricted-ns namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "res-005-1-default-ephemeral-storage-requests-from-namespace.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 2, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "deployment res-005-1-default-ephemeral-storage-requests-from-namespace in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 10, "EndLine": 10, "Code": {"Lines": [{"Number": 10, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "serviceaccount res-005-1-default-ephemeral-storage-requests-from-namespace-dedicated-sa in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "res-005-2-no-ephemeral-storage-requests.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 2, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "deployment res-005-2-no-ephemeral-storage-requests in kalm-benchmark-unrestricted-ns namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 10, "EndLine": 10, "Code": {"Lines": [{"Number": 10, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "serviceaccount res-005-2-no-ephemeral-storage-requests-dedicated-sa in kalm-benchmark-unrestricted-ns namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "res-006-1-default-ephemeral-storage-limits-from-namespace.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 2, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "deployment res-006-1-default-ephemeral-storage-limits-from-namespace in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 10, "EndLine": 10, "Code": {"Lines": [{"Number": 10, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "serviceaccount res-006-1-default-ephemeral-storage-limits-from-namespace-dedicated-sa in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "res-006-2-no-ephemeral-storage-limits.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 2, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "deployment res-006-2-no-ephemeral-storage-limits in kalm-benchmark-unrestricted-ns namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 10, "EndLine": 10, "Code": {"Lines": [{"Number": 10, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "serviceaccount res-006-2-no-ephemeral-storage-limits-dedicated-sa in kalm-benchmark-unrestricted-ns namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "res-007-0-no-limitrange-object-for-namespace.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 5, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "deployment res-007-0-no-limitrange-object-for-namespace in res-007-0-no-limitrange-object-for-namespace namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 57, "EndLine": 57, "Code": {"Lines": [{"Number": 57, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "namespace res-007-0-no-limitrange-object-for-namespace in res-007-0-no-limitrange-object-for-namespace namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "networkpolicy res-007-0-no-limitrange-object-for-namespace in res-007-0-no-limitrange-object-for-namespace namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 30, "EndLine": 30, "Code": {"Lines": [{"Number": 30, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "resourcequota res-007-0-no-limitrange-object-for-namespace in res-007-0-no-limitrange-object-for-namespace namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 13, "EndLine": 13, "Code": {"Lines": [{"Number": 13, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "serviceaccount res-007-0-no-limitrange-object-for-namespace-filler-dedicated-sa in res-007-0-no-limitrange-object-for-namespace namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 47, "EndLine": 47, "Code": {"Lines": [{"Number": 47, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}]}, {"Target": "res-007-1-no-default-cpu-request-for-namespace.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 6, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "deployment res-007-1-no-default-cpu-request-for-namespace in res-007-1-no-default-cpu-request-for-namespace namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 84, "EndLine": 84, "Code": {"Lines": [{"Number": 84, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "limitrange res-007-1-no-default-cpu-request-for-namespace in res-007-1-no-default-cpu-request-for-namespace namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 30, "EndLine": 30, "Code": {"Lines": [{"Number": 30, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "namespace res-007-1-no-default-cpu-request-for-namespace in res-007-1-no-default-cpu-request-for-namespace namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "networkpolicy res-007-1-no-default-cpu-request-for-namespace in res-007-1-no-default-cpu-request-for-namespace namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 57, "EndLine": 57, "Code": {"Lines": [{"Number": 57, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "resourcequota res-007-1-no-default-cpu-request-for-namespace in res-007-1-no-default-cpu-request-for-namespace namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 13, "EndLine": 13, "Code": {"Lines": [{"Number": 13, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "serviceaccount res-007-1-no-default-cpu-request-for-namespace-filler-dedicated-sa in res-007-1-no-default-cpu-request-for-namespace namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 74, "EndLine": 74, "Code": {"Lines": [{"Number": 74, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}]}, {"Target": "res-007-2-no-default-cpu-limits-for-namespace.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 6, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "deployment res-007-2-no-default-cpu-limits-for-namespace in res-007-2-no-default-cpu-limits-for-namespace namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 84, "EndLine": 84, "Code": {"Lines": [{"Number": 84, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "limitrange res-007-2-no-default-cpu-limits-for-namespace in res-007-2-no-default-cpu-limits-for-namespace namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 30, "EndLine": 30, "Code": {"Lines": [{"Number": 30, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "namespace res-007-2-no-default-cpu-limits-for-namespace in res-007-2-no-default-cpu-limits-for-namespace namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "networkpolicy res-007-2-no-default-cpu-limits-for-namespace in res-007-2-no-default-cpu-limits-for-namespace namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 57, "EndLine": 57, "Code": {"Lines": [{"Number": 57, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "resourcequota res-007-2-no-default-cpu-limits-for-namespace in res-007-2-no-default-cpu-limits-for-namespace namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 13, "EndLine": 13, "Code": {"Lines": [{"Number": 13, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "serviceaccount res-007-2-no-default-cpu-limits-for-namespace-filler-dedicated-sa in res-007-2-no-default-cpu-limits-for-namespace namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 74, "EndLine": 74, "Code": {"Lines": [{"Number": 74, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}]}, {"Target": "res-007-3-no-cpu-limits-for-namespace.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 6, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "deployment res-007-3-no-cpu-limits-for-namespace in res-007-3-no-cpu-limits-for-namespace namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 84, "EndLine": 84, "Code": {"Lines": [{"Number": 84, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "limitrange res-007-3-no-cpu-limits-for-namespace in res-007-3-no-cpu-limits-for-namespace namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 30, "EndLine": 30, "Code": {"Lines": [{"Number": 30, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "namespace res-007-3-no-cpu-limits-for-namespace in res-007-3-no-cpu-limits-for-namespace namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "networkpolicy res-007-3-no-cpu-limits-for-namespace in res-007-3-no-cpu-limits-for-namespace namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 57, "EndLine": 57, "Code": {"Lines": [{"Number": 57, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "resourcequota res-007-3-no-cpu-limits-for-namespace in res-007-3-no-cpu-limits-for-namespace namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 13, "EndLine": 13, "Code": {"Lines": [{"Number": 13, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "serviceaccount res-007-3-no-cpu-limits-for-namespace-filler-dedicated-sa in res-007-3-no-cpu-limits-for-namespace namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 74, "EndLine": 74, "Code": {"Lines": [{"Number": 74, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}]}, {"Target": "res-008-1-no-default-memory-request-for-namespace.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 6, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "deployment res-008-1-no-default-memory-request-for-namespace in res-008-1-no-default-memory-request-for-namespace namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 84, "EndLine": 84, "Code": {"Lines": [{"Number": 84, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "limitrange res-008-1-no-default-memory-request-for-namespace in res-008-1-no-default-memory-request-for-namespace namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 30, "EndLine": 30, "Code": {"Lines": [{"Number": 30, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "namespace res-008-1-no-default-memory-request-for-namespace in res-008-1-no-default-memory-request-for-namespace namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "networkpolicy res-008-1-no-default-memory-request-for-namespace in res-008-1-no-default-memory-request-for-namespace namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 57, "EndLine": 57, "Code": {"Lines": [{"Number": 57, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "resourcequota res-008-1-no-default-memory-request-for-namespace in res-008-1-no-default-memory-request-for-namespace namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 13, "EndLine": 13, "Code": {"Lines": [{"Number": 13, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "serviceaccount res-008-1-no-default-memory-request-for-namespace-filler-dedicated-sa in res-008-1-no-default-memory-request-for-namespace namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 74, "EndLine": 74, "Code": {"Lines": [{"Number": 74, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}]}, {"Target": "res-008-2-no-default-memory-limits-for-namespace.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 6, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "deployment res-008-2-no-default-memory-limits-for-namespace in res-008-2-no-default-memory-limits-for-namespace namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 84, "EndLine": 84, "Code": {"Lines": [{"Number": 84, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "limitrange res-008-2-no-default-memory-limits-for-namespace in res-008-2-no-default-memory-limits-for-namespace namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 30, "EndLine": 30, "Code": {"Lines": [{"Number": 30, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "namespace res-008-2-no-default-memory-limits-for-namespace in res-008-2-no-default-memory-limits-for-namespace namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "networkpolicy res-008-2-no-default-memory-limits-for-namespace in res-008-2-no-default-memory-limits-for-namespace namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 57, "EndLine": 57, "Code": {"Lines": [{"Number": 57, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "resourcequota res-008-2-no-default-memory-limits-for-namespace in res-008-2-no-default-memory-limits-for-namespace namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 13, "EndLine": 13, "Code": {"Lines": [{"Number": 13, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "serviceaccount res-008-2-no-default-memory-limits-for-namespace-filler-dedicated-sa in res-008-2-no-default-memory-limits-for-namespace namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 74, "EndLine": 74, "Code": {"Lines": [{"Number": 74, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}]}, {"Target": "res-008-3-no-default-memory-limits-for-namespace.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 6, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "deployment res-008-3-no-default-memory-limits-for-namespace in res-008-3-no-default-memory-limits-for-namespace namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 84, "EndLine": 84, "Code": {"Lines": [{"Number": 84, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "limitrange res-008-3-no-default-memory-limits-for-namespace in res-008-3-no-default-memory-limits-for-namespace namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 30, "EndLine": 30, "Code": {"Lines": [{"Number": 30, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "namespace res-008-3-no-default-memory-limits-for-namespace in res-008-3-no-default-memory-limits-for-namespace namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "networkpolicy res-008-3-no-default-memory-limits-for-namespace in res-008-3-no-default-memory-limits-for-namespace namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 57, "EndLine": 57, "Code": {"Lines": [{"Number": 57, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "resourcequota res-008-3-no-default-memory-limits-for-namespace in res-008-3-no-default-memory-limits-for-namespace namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 13, "EndLine": 13, "Code": {"Lines": [{"Number": 13, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "serviceaccount res-008-3-no-default-memory-limits-for-namespace-filler-dedicated-sa in res-008-3-no-default-memory-limits-for-namespace namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 74, "EndLine": 74, "Code": {"Lines": [{"Number": 74, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}]}, {"Target": "res-009-1-no-resource-quota-applied-to-namespace.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 5, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "deployment res-009-1-no-resource-quota-applied-to-namespace in res-009-1-no-resource-quota-applied-to-namespace namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 67, "EndLine": 67, "Code": {"Lines": [{"Number": 67, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "limitrange res-009-1-no-resource-quota-applied-to-namespace in res-009-1-no-resource-quota-applied-to-namespace namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 13, "EndLine": 13, "Code": {"Lines": [{"Number": 13, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "namespace res-009-1-no-resource-quota-applied-to-namespace in res-009-1-no-resource-quota-applied-to-namespace namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "networkpolicy res-009-1-no-resource-quota-applied-to-namespace in res-009-1-no-resource-quota-applied-to-namespace namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 40, "EndLine": 40, "Code": {"Lines": [{"Number": 40, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "serviceaccount res-009-1-no-resource-quota-applied-to-namespace-filler-dedicated-sa in res-009-1-no-resource-quota-applied-to-namespace namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 57, "EndLine": 57, "Code": {"Lines": [{"Number": 57, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}]}, {"Target": "res-009-2-no-hard-quotas-defined-in-resourcequota-for-namespace.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 6, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "deployment res-009-2-no-hard-quotas-defined-in-resourcequota-for-namespace in res-009-2-no-hard-quotas-defined-in-resourcequota-for-namespace namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 84, "EndLine": 84, "Code": {"Lines": [{"Number": 84, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "limitrange res-009-2-no-hard-quotas-defined-in-resourcequota-for-namespace in res-009-2-no-hard-quotas-defined-in-resourcequota-for-namespace namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 30, "EndLine": 30, "Code": {"Lines": [{"Number": 30, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "namespace res-009-2-no-hard-quotas-defined-in-resourcequota-for-namespace in res-009-2-no-hard-quotas-defined-in-resourcequota-for-namespace namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "networkpolicy res-009-2-no-hard-quotas-defined-in-resourcequota-for-namespace in res-009-2-no-hard-quotas-defined-in-resourcequota-for-namespace namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 57, "EndLine": 57, "Code": {"Lines": [{"Number": 57, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "resourcequota res-009-2-no-hard-quotas-defined-in-resourcequota-for-namespace in res-009-2-no-hard-quotas-defined-in-resourcequota-for-namespace namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 13, "EndLine": 13, "Code": {"Lines": [{"Number": 13, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "serviceaccount res-009-2-no-hard-quotas-defined-in-resourcequota-for-namespace-filler-dedicated-sa in res-009-2-no-hard-quotas-defined-in-resourcequota-for-namespace namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 74, "EndLine": 74, "Code": {"Lines": [{"Number": 74, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}]}, {"Target": "sc-001-1-imagepullpolicy-defaults-to-always.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 2, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "deployment sc-001-1-imagepullpolicy-defaults-to-always in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 10, "EndLine": 10, "Code": {"Lines": [{"Number": 10, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "serviceaccount sc-001-1-imagepullpolicy-defaults-to-always-dedicated-sa in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "sc-001-2-no-proper-imagepullpolicy-set.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 2, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "deployment sc-001-2-no-proper-imagepullpolicy-set in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 10, "EndLine": 10, "Code": {"Lines": [{"Number": 10, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "serviceaccount sc-001-2-no-proper-imagepullpolicy-set-dedicated-sa in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "sc-001-3-no-proper-imagepullpolicy-set.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 2, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "deployment sc-001-3-no-proper-imagepullpolicy-set in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 10, "EndLine": 10, "Code": {"Lines": [{"Number": 10, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "serviceaccount sc-001-3-no-proper-imagepullpolicy-set-dedicated-sa in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "sc-002-1-tag-instead-of-digest-is-fine.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 2, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "deployment sc-002-1-tag-instead-of-digest-is-fine in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 10, "EndLine": 10, "Code": {"Lines": [{"Number": 10, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "serviceaccount sc-002-1-tag-instead-of-digest-is-fine-dedicated-sa in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "sc-002-2-using-latest-image-tag.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 3, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV013", "AVDID": "AVD-KSV-0013", "Title": "Image tag \":latest\" used", "Description": "It is best to avoid using the ':latest' image tag when deploying containers in production. Doing so makes it hard to track which version of the image is running, and hard to roll back the version.", "Message": "Container 'app' of Deployment 'sc-002-2-using-latest-image-tag' should specify an image tag", "Namespace": "builtin.kubernetes.KSV013", "Query": "data.builtin.kubernetes.KSV013.deny", "Resolution": "Use a specific container image tag that is not 'latest'.", "Severity": "MEDIUM", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv013", "References": ["https://kubernetes.io/docs/concepts/configuration/overview/#container-images", "https://avd.aquasec.com/misconfig/ksv013"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 49, "EndLine": 84, "Code": {"Lines": [{"Number": 49, "Content": "        - image: nginx:latest", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 50, "Content": "          imagePullPolicy: Always", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 51, "Content": "          livenessProbe:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 52, "Content": "            httpGet:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 53, "Content": "              path: /live", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 54, "Content": "              port: 8080", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 55, "Content": "          name: app", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 56, "Content": "          ports:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 57, "Content": "            - containerPort: 8080", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 58, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "deployment sc-002-2-using-latest-image-tag in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 10, "EndLine": 10, "Code": {"Lines": [{"Number": 10, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "serviceaccount sc-002-2-using-latest-image-tag-dedicated-sa in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "sc-002-3-no-explicit-tag.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 3, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV013", "AVDID": "AVD-KSV-0013", "Title": "Image tag \":latest\" used", "Description": "It is best to avoid using the ':latest' image tag when deploying containers in production. Doing so makes it hard to track which version of the image is running, and hard to roll back the version.", "Message": "Container 'app' of Deployment 'sc-002-3-no-explicit-tag' should specify an image tag", "Namespace": "builtin.kubernetes.KSV013", "Query": "data.builtin.kubernetes.KSV013.deny", "Resolution": "Use a specific container image tag that is not 'latest'.", "Severity": "MEDIUM", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv013", "References": ["https://kubernetes.io/docs/concepts/configuration/overview/#container-images", "https://avd.aquasec.com/misconfig/ksv013"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 49, "EndLine": 84, "Code": {"Lines": [{"Number": 49, "Content": "        - image: nginx", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 50, "Content": "          imagePullPolicy: Always", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 51, "Content": "          livenessProbe:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 52, "Content": "            httpGet:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 53, "Content": "              path: /live", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 54, "Content": "              port: 8080", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 55, "Content": "          name: app", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 56, "Content": "          ports:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 57, "Content": "            - containerPort: 8080", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 58, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "deployment sc-002-3-no-explicit-tag in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 10, "EndLine": 10, "Code": {"Lines": [{"Number": 10, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "serviceaccount sc-002-3-no-explicit-tag-dedicated-sa in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}, {"Target": "wl-001-naked-pod.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 151, "Failures": 2, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "pod wl-001-naked-pod in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 9, "EndLine": 9, "Code": {"Lines": [{"Number": 9, "Content": "---", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": true}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV116", "AVDID": "AVD-KSV-0116", "Title": "Runs with a root primary or supplementary GID", "Description": "According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.", "Message": "serviceaccount wl-001-naked-pod-dedicated-sa in kalm-benchmark namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0", "Namespace": "builtin.kubernetes.KSV116", "Query": "data.builtin.kubernetes.KSV116.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv116", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv116"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "Code": {"Lines": null}}}]}]}